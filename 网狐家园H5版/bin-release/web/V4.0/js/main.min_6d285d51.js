var __reflect=this&&this.__reflect||function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n},__extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);n.prototype=t.prototype,e.prototype=new n},__awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(r,o){function s(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i["throw"](e))}catch(t){o(t)}}function c(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(s,a)}c((i=i.apply(e,t||[])).next())})},__generator=this&&this.__generator||function(e,t){function n(e){return function(t){return i([e,t])}}function i(n){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,o&&(s=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(s=s.call(o,n[1])).done)return s;switch(o=0,s&&(n=[0,s.value]),n[0]){case 0:case 1:s=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,o=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(s=c.trys,!(s=s.length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){c.label=n[1];break}if(6===n[0]&&c.label<s[1]){c.label=s[1],s=n;break}if(s&&c.label<s[2]){c.label=s[2],c.ops.push(n);break}s[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(i){n=[6,i],o=0}finally{r=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,o,s,a,c={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},models;!function(e){e.MY_VIEW=0;var t=function(e){function t(){var t=e.call(this)||this;return t._bChangeDesk=!1,t._bMatchDesk=!1,t.once(egret.Event.REMOVED_FROM_STAGE,t.onExit,t),t.onInitEngine(),managers.TimerCtrl.getInstance().createTimer(t,1e3,0,t.onClockEvent,"clock"),t._gameFrame.queryUserInfo(t._gameFrame.getTableID(),df.INVALID_CHAIR),t}return __extends(t,e),t.prototype.onInitEngine=function(){this._gameFrame=managers.TcpServiceCtrl.getInstance().getDelegate(),this._bChangeDesk=!1,this._bMatchDesk=!1},t.prototype.onResetEngine=function(){this._bChangeDesk=!1,this._bMatchDesk=!1},t.prototype.onClockEvent=function(){},t.prototype.gamePlayerCount=function(){return 0},t.prototype.getMeUserItem=function(){return null!=this._gameFrame?this._gameFrame.getMeUserItem():null},t.prototype.switchViewChairID=function(e){if(!(0>e||e>=this.gamePlayerCount())){var t=(this._gameFrame.getChairID(),-1),n=this.gamePlayerCount();return t=(n-this._gameFrame.getChairID()+e)%n}},t.prototype.onEnterTable=function(){this._bChangeDesk&&(this._bChangeDesk=!1,this._bMatchDesk=!1,managers.TcpServiceCtrl.getInstance()._isAllowDispatch=!0,this._gameFrame.queryUserInfo(this._gameFrame.getTableID(),df.INVALID_CHAIR),null!=this._gameviewLayer&&this._gameviewLayer.onRestGameView&&(this._gameviewLayer.stopAllAction(),this._gameviewLayer.onRestGameView()))},t.prototype.onExitTable=function(){return null!=this._gameFrame&&this._gameFrame.isMatchMode()?!0:this._bChangeDesk&&(this.onResetEngine(),null!=this._gameviewLayer&&this._gameviewLayer.onRestGameView)?(this._gameviewLayer.stopAllAction(),this._gameviewLayer.onRestGameView(),!0):!1},t.prototype.onExitGame=function(e){var t=this._gameFrame.getMeUserItem();this._gameFrame.onStandUp(t.cbUserStatus>=df.US_PLAYING?!0:!1),null!=e&&e.length>0&&managers.FrameManager.getInstance().showToast(e)},t.prototype.onExit=function(){null!=this._gameFrame&&(this._gameFrame.setDelegate(null),this._gameFrame=null),managers.TimerCtrl.getInstance().killTimer(this,"clock"),managers.TcpServiceCtrl.getInstance().closeService()},t}(eui.UILayer);e.GameModel=t,__reflect(t.prototype,"models.GameModel")}(models||(models={}));var utils;!function(e){function t(e){return new e}function n(t,n){for(var i=new Array,r=0;t>r;r++)i[r]=e.createInstance(n);return i}function i(t,n,i){for(var r=new Array,o=0;t>o;o++){r[o]=[];for(var s=0;n>s;s++)r[o][s]=e.createInstance(i)}return r}function r(t,n,i,r){for(var o=[],s=0;t>s;s++){o[s]=[];for(var a=0;n>a;a++){o[s][a]=[];for(var c=0;i>c;c++)o[s][a][c]=e.createInstance(r)}}return o}function o(e,t,n,i){egret.assert(e>0);var r=0;return t=v.getUnsignedByte(t),n=v.getUnsignedByte(n),i=v.getUnsignedByte(i),r=e<<24,r+=t<<16,r+=n<<8,r+=i,r=v.getUnsignedDWORD(r)}function s(e){egret.assert(null!=e.parent),null!=e.parent&&e.parent.removeChild(e)}function a(e,t){var n=e.getBounds(),i=t.getBounds();return n.x=e.x,n.y=e.y,i.x=t.x,i.y=t.y,n.intersects(i)}function c(e,t){var n=new egret.Bitmap,i=RES.getRes(e);return t&&(i.$bitmapX=t.x,i.$bitmapY=t.y,i.$bitmapWidth=t.width,i.$bitmapHeight=t.height),n.texture=i,n}function _(e,t){var n=RES.getRes(e);return null==n?null:(t&&(n.$bitmapX=t.x,n.$bitmapY=t.y,n.$bitmapWidth=t.width,n.$bitmapHeight=t.height),n)}function l(e,t,n){return null!=e&&t>=0&&n>=0?(e.anchorOffsetX=t,e.anchorOffsetY=n,e):e}function h(e){return null!=e?this.setAnchorPoint(e,e.width/2,e.height/2):null}function u(e){return null!=e?this.setAnchorPoint(e,0,0):null}function d(e){return null!=e?this.setAnchorPoint(e,e.width/2,0):null}function p(e){return null!=e?this.setAnchorPoint(e,0,e.height/2):null}function m(e){return null!=e?this.setAnchorPoint(e,e.width,e.height/2):null}function g(e){return null!=e?this.setAnchorPoint(e,e.width/2,e.height):null}function f(e){return null!=e?this.setAnchorPoint(e,0,e.height):null}function E(e){return null!=e?this.setAnchorPoint(e,e.width,0):null}function C(e){return null!=e?this.setAnchorPoint(e,e.width,e.height):null}var v=function(){function e(){}return e.getUnsignedByte=function(e){return e>255&&(e%=256),0>e&&(e=e%256+256),e},e.getUnsignedWORD=function(e){return e>65535&&(e%=65536),0>e&&(e=e%65536+65536),e},e.getUnsignedDWORD=function(e){return e>4294967295&&(e%=4294967296),0>e&&(e=e%4294967296+4294967296),e},e}();e.MathUtils=v,__reflect(v.prototype,"utils.MathUtils");var S=function(){function e(){}return e.reverse=function(e){for(var t="",n=e.length-1;n>=0;n--)t+=e[n];return t},e.formatNumberThousands=function(t){for(var n=""+t,i="",r=0,o=n.length-1;o>=0;o--)r>0&&r%3==0&&(i+=","),i+=n[o],r++;return i=e.reverse(i)},e.getGUID=function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)})},e.array2string=function(e){return String.fromCharCode.apply(null,new Uint16Array(e))},e.string2array=function(e){for(var t=new ArrayBuffer(2*e.length),n=new Uint16Array(t),i=0,r=e.length;r>i;i++)n[i]=e.charCodeAt(i);return t},e.getSystemConfig=function(e){var t={upperEnSize:0,cnSize:0,lowerEnSize:0,numSize:0},n=new eui.Label("A");n.size=e;var i=new eui.Label("网");i.size=e;var r=new eui.Label("a");r.size=e;var o=new eui.Label("2");return o.size=e,t.upperEnSize=n.width,t.cnSize=i.width,t.lowerEnSize=r.width,t.numSize=o.width,t},e.getConfig=function(e,t){var n={upperEnSize:0,cnSize:0,lowerEnSize:0,numSize:0},i=new eui.Label("A");i.size=t,i.fontFamily=e;var r=new eui.Label("网");r.size=t,r.fontFamily=e;var o=new eui.Label("a");o.size=t,o.fontFamily=e;var s=new eui.Label("2");return s.size=t,s.fontFamily=e,n.upperEnSize=i.width,n.cnSize=r.width,n.lowerEnSize=o.width,n.numSize=s.width,n},e.clipByConfig=function(e,t,n){if(null==n||0==e.length||0==t)return e;for(var i=0,r="...",o=!1,s=0,a=3*n.numSize;;){var c=e.charCodeAt(s);if(null==c||isNaN(c))break;if(c>128){if(!(t-a>=i)){o=!0;break}i+=n.cnSize,s+=3}else if(32!=c){if(!(t-a>=i)){o=!0;break}i+=Number("A")<=c&&c<=Number("Z")?n.upperEnSize:Number("a")<=c&&c<=Number("z")?n.lowerEnSize:n.numSize,s+=1}else s++}if(0!=s)if(o){var _=e.substr(0,s);r=_+r}else r=e;return r},e}();e.StringUtils=S,__reflect(S.prototype,"utils.StringUtils"),e.createInstance=t,e.allocArray=n,e.alloc2Array=i,e.alloc3Array=r,e.PROCESS_VERSION=o,e.removeFromParent=s,e.hitTest=a,e.createBitmapByName=c,e.createTextureByName=_,e.setAnchorPoint=l,e.setAnchorCenter=h,e.setAnchorLeftTop=u,e.setAnchorMidTop=d,e.setAnchorLeftMid=p,e.setAnchorRightMid=m,e.setAnchorMidBottom=g,e.setAnchorLeftBottom=f,e.setAnchorRightTop=E,e.setAnchorRightBottom=C}(utils||(utils={}));var game;!function(e){var t;!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.name="GameClient",this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this)},t.prototype.onInitLayer=function(){var e=this;egret.BitmapData;var t=new eui.Component;this.addChild(t),t.skinName="resource/eui_skins/landlord.exml";var n=t.getChildByName("bt_back");n.addEventListener(egret.TouchEvent.TOUCH_END,function(e){managers.FrameManager.getInstance().replaceScene(new controller.ClientController,!0)},this);var i=utils.createBitmapByName("game_logo_share_png");utils.setAnchorCenter(i),this.addChild(i),i.x=667,i.y=275;var r=0,o=[],s=function(){var t=new egret.Sprite;e.addChild(t),t.width=151,t.height=201,t.anchorOffsetX=75.5,t.anchorOffsetY=100.5,t.x=667,t.y=100,o.push(t);var n=utils.createBitmapByName("game_card_handcard_png",new egret.Rectangle(302,804,151,201));t.addChild(n),n.name="back",n.anchorOffsetX=75.5,n.anchorOffsetY=100.5,n.x=75.5,n.y=100.5;egret.Tween.get(t).to({x:667,y:650},50).call(function(){r++,50>=r?s():o.forEach(function(e,t){egret.Tween.get(e).to({x:80+53.1*t},500).call(function(){var t=e.getChildByName("back");e.removeChild(t);var n=utils.createBitmapByName("game_card_handcard_png",new egret.Rectangle(0,0,151,201));e.addChild(n),n.name="card",n.anchorOffsetX=75.5,n.anchorOffsetY=100.5,n.x=75.5,n.y=100.5})})})};s()},t.prototype.onUserEnter=function(e){},t.prototype.onUserStatus=function(e){},t.prototype.onUserChat=function(e){},t.prototype.onUserScore=function(e){},t.prototype.onGameScene=function(e){},t.prototype.onGameMessage=function(e){},t.prototype.onGameSystemMessage=function(e){},t}(eui.UILayer);e.GameClient=t,__reflect(t.prototype,"game.landlord.GameClient",["df.IGameMessage","df.IUserService"])}(t=e.landlord||(e.landlord={}))}(game||(game={}));var game;!function(e){var t;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n._actionList=[],n.AK_GAME_BEGIN=0,n.AK_OUT_CARD=1,n.AK_SEND_CARD=2,n.AK_DISPATCH_CARD=3,n.AK_SICE=4,n._bBaoHuFlag=!1,n._cbGameStatus=0,n._bMoved=!1,n}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.name="GameClientEngine",this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this),this._gameFrame.setDelegate(this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.addEventListener(customEvent.CustomEvent.EVENT_USER_ENTER,this.onUserEnter,this),this.addEventListener(customEvent.CustomEvent.EVENT_USER_STATUS,this.onUserStatus,this)},n.prototype.onInitLayer=function(){this._gameviewLayer=new e.GameViewLayer(this),this.addChild(this._gameviewLayer)},n.prototype.onInitEngine=function(){t.prototype.onInitEngine.call(this)},n.prototype.onResetEngine=function(){},n.prototype.gamePlayerCount=function(){return cmd.sparrowsclm.PLAYER_COUNT},n.prototype.onClockEvent=function(){this._gameviewLayer&&this._gameviewLayer.updateClockView&&this._gameviewLayer.updateClockView()},n.prototype.getGameStatus=function(){return this._cbGameStatus},n.prototype.onUserEnter=function(e){var t=e.data,n=t.user;null!=this._gameviewLayer&&this._gameviewLayer.onUpdataUser(n)},n.prototype.onUserStatus=function(e){var t=e.data,n=t.user,i=t.newstatus,r=t.oldstatus;null!=this._gameviewLayer&&this._gameviewLayer.onUpdataUser(n,i,r)},n.prototype.onUserChat=function(e){},n.prototype.onUserScore=function(e){},n.prototype.onGameScene=function(e,t){switch(console.log("GameClientEngine: 游戏场景"),this._cbGameStatus=e,managers.FrameManager.getInstance().dismissPopWait(),this._cbGameStatus){case cmd.sparrowsclm.GAME_SCENE_FREE:this.onSceneFree(t);break;case cmd.sparrowsclm.GS_PLAYING:this.onScenePlaying(t)}},n.prototype.onGameMessage=function(e){var t=e;switch(t.wSubCmd){case cmd.sparrowsclm.SUB_S_GAME_START:this.onSubGameStart(t.cbBuffer);break;case cmd.sparrowsclm.SUB_S_OUT_CARD:break;case cmd.sparrowsclm.SUB_S_SEND_CARD:break;case cmd.sparrowsclm.SUB_S_NOGANG_INFO:break;case cmd.sparrowsclm.SUB_S_OPERATE_NOTIFY:break;case cmd.sparrowsclm.SUB_S_OPERATE_RESULT:break;case cmd.sparrowsclm.SUB_S_CHIHU_RESULT:break;case cmd.sparrowsclm.SUB_S_GAME_END:break;case cmd.sparrowsclm.SUB_S_TRUSTEE:break;case cmd.sparrowsclm.SUB_S_VOICEPHRASE:break;case cmd.sparrowsclm.SUB_S_GAME_ACTION_NOTIFY:break;case cmd.sparrowsclm.SUB_S_GAME_RULE_SETTING:var n=new cmd.sparrowsclm.CMD_S_GAME_RULE_SETTING;n.readBuffer(t.cbBuffer);var i=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);i.Append_SCORE(n.lCellScore),this._gameFrame.sendData(df.MDM_GF_FRAME,cmd.sparrowsclm.SUB_C_GAME_RULE_SETTING,i);break;case cmd.sparrowsclm.SUB_S_GAME_RULE_NOTIFY:var r=new cmd.sparrowsclm.CMD_S_GAME_RULE_NOTIFY;r.readBuffer(t.cbBuffer),1==r.bForceExit&&this.onExitGame("对不起,您携带的分数不够,不能参与游戏!"),4==r.cbGamePlayer&&this.onExitGame("暂不支持4人桌游戏!");break;case cmd.sparrowsclm.SUB_S_BAO_HU_NOTIFY:break;case cmd.sparrowsclm.SUB_S_TRANSFER_NOTIFY:}console.log("GameClientEngine: 游戏协议:",t.wSubCmd,cmd.sparrowsclm.MS_NAME[t.wSubCmd])},n.prototype.onSubGameStart=function(e){var t=new cmd.sparrowsclm.CMD_S_GameStart;t.readBuffer(e),this._gameviewLayer&&this._gameviewLayer.showGameStart&&this._gameviewLayer.showGameStart(t),this._bBaoHuFlag=!1;var n={};n.bLock=!1,n.nKind=this.AK_GAME_BEGIN,n.actions=utils.allocArray(3,Number),n.actions[0]=this.AK_SICE,n.actions[1]=this.AK_DISPATCH_CARD,n.actions[2]=this.AK_SEND_CARD,n.lSiceCount=t.lSiceCount,n.wBankerUser=t.wBankerUser,n.wCurrentUser=t.wCurrentUser,n.wCurrBaoUser=t.wCurrBaoUser,n.cbCardData=t.cbCardData,n.cbUserAction=t.cbUserAction,this._actionList.push(n),this.beginGameAction(),this._cbGameStatus=cmd.sparrowsclm.GS_PLAYING,console.log("start:",t)},n.prototype.onGameSystemMessage=function(e){},n.prototype.onSceneFree=function(e){if(this._gameviewLayer&&this._gameviewLayer.showSceneFree){this._gameviewLayer.showSceneFree(e),this._gameviewLayer.gamePlayingHeadAnim();var t={};t.bLock=!1,t.nKind=this.AK_GAME_BEGIN,t.actions=utils.allocArray(3,Number),t.actions[0]=this.AK_SICE,t.actions[1]=this.AK_DISPATCH_CARD,t.actions[2]=this.AK_SEND_CARD,t.lSiceCount=0,t.wBankerUser=2,t.wCurrentUser=2,t.wCurrBaoUser=65535,t.cbCardData=[17,18,19,20,21,22,23,24,25,33,34],this._actionList.push(t),this.startGameAction(t,this.AK_DISPATCH_CARD)}},n.prototype.onScenePlaying=function(e){},n.prototype.beginGameAction=function(){var e=this._actionList[0];null==e||e.bLock||(e.bLock=!0,e.nKind==this.AK_GAME_BEGIN&&this.startGameAction(e,this.AK_SICE))},n.prototype.startGameAction=function(e,t){var n=this;if(e.actions.length>0)if(t==this.AK_SICE){if(0==e.lSiceCount)return void this.startGameAction(this._actionList[0],this.AK_DISPATCH_CARD);this.startSice(65535&e.lSiceCount)}else if(t==this.AK_DISPATCH_CARD){for(var i=[],r=e.wBankerUser,o=-1,s=0;s<cmd.sparrowsclm.PLAYER_COUNT;s++)for(var a=0;a<(cmd.sparrowsclm.MAX_COUNT-1)/2;a++){var c={},_=this.switchViewChairID(r);_==cmd.sparrowsclm.MY_VIEW&&o++,r=(r+1)%cmd.sparrowsclm.PLAYER_COUNT,c.viewId=_,c.cout=2,c.cardData=utils.allocArray(2,Number),c.cardData[0]=_==cmd.sparrowsclm.MY_VIEW?e.cbCardData[2*o+0]:255,c.cardData[1]=_==cmd.sparrowsclm.MY_VIEW?e.cbCardData[2*o+1]:255,i.push(c)}var l=function(){n.startGameAction(n._actionList[0],n.AK_SEND_CARD)};this.startDispatchCard(i,l)}else if(t==this.AK_SEND_CARD){console.log("庄家起牌");var i=[],c={},_=this.switchViewChairID(e.wBankerUser);c.viewId=_,c.cout=1,c.cardData=utils.allocArray(1,Number),c.cardData[0]=_==cmd.sparrowsclm.MY_VIEW?e.cbCardData[cmd.sparrowsclm.MAX_COUNT-1]:255,i.push(c);var l=function(){n.onFanAnalysis(!0),n.removeGameAction()};this.startDispatchCard(i)}},n.prototype.removeGameAction=function(e){var t=this._actionList[0];if(null!=t&&t.bLock){var n=t.nKind;n==this.AK_GAME_BEGIN&&this.finishStartAction(t),this._actionList.splice(0,1),1==e&&this._actionList.length>0&&this.beginGameAction()}},n.prototype.startSice=function(e){var t=this;if(e>0){var n=255&e,i=e>>8&255;if(this._gameviewLayer){var r=function(){t.startGameAction(t._actionList[0],t.AK_DISPATCH_CARD)};this._gameviewLayer.drawSice(i,n,r)}}},n.prototype.startDispatchCard=function(e,t){this._gameviewLayer&&this._gameviewLayer.dispatchCard(e,t)},n.prototype.finishStartAction=function(e){var t=e.wCurrBaoUser,n=e.wCurrentUser,i=e.cbActionMask;if(this.onUpdateFanTips(),t==df.INVALID_CHAIR){if(this._gameviewLayer._handCard.setAllowOutCardStats(!1),n==this._gameFrame.getMeUserItem().wChairID&&(0!=i?this._gameviewLayer.setOperateNotify(i):this._gameviewLayer._handCard.setAllowOutCardStats(!this._bBaoHuFlag),n!=df.INVALID_CHAIR)){var r=this.switchViewChairID(n);this._gameviewLayer.setGameClock(cmd.sparrowsclm.TIME_OPERATE_CARD,cmd.sparrowsclm.IDI_OPERATE_CARD,r)}}else{this._gameviewLayer._handCard.setAllowOutCardStats(!1),t==this._gameFrame.getMeUserItem().wChairID&&this._gameviewLayer.setOperateNotify(cmd.sparrowsclm.WIK_BAO_HU);var r=this.switchViewChairID(t);this._gameviewLayer.setGameClock(cmd.sparrowsclm.TIME_BAO_JIAO,cmd.sparrowsclm.IDI_BAO_JIAO,r)}},n.prototype.onUpdateFanTips=function(){},n.prototype.onFanAnalysis=function(e){},n.prototype.onTouchBegan=function(e){this._bMoved=!1},n.prototype.onTouchMove=function(e){this._bMoved=!0},n.prototype.onTouchEnd=function(e){},n.prototype.onQueryExitGame=function(){var e=this,t=this.getGameStatus()==cmd.sparrowsclm.GAME_SCENE_FREE?"是否确定退出游戏？":"游戏已经开始，退出将由憨憨机器人代打哦！\n 是否确定退出游戏？";managers.FrameManager.getInstance().showDailog(1,t,function(){managers.FrameManager.getInstance().showPopWait("",3e3),e.onExitGame()})},n.prototype.onExit=function(){t.prototype.onExit.call(this),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.removeEventListener(customEvent.CustomEvent.EVENT_USER_ENTER,this.onUserEnter,this),this.removeEventListener(customEvent.CustomEvent.EVENT_USER_STATUS,this.onUserStatus,this)},n}(models.GameModel);e.GameClientEngine=t,__reflect(t.prototype,"game.sparrowsclm.GameClientEngine",["df.IGameMessage","df.IUserService"])}(t=e.sparrowsclm||(e.sparrowsclm={}))}(game||(game={}));var models;!function(e){var t=function(){function e(){this._viewStack=[]}return e.prototype.push=function(e,t,n,i,r){if(void 0===t&&(t=0),egret.assert(e!=this._rootNode),egret.assert(e!=this._curNode),e!=this._rootNode&&e!=this._curNode){if(this._curNode&&this._curNode!=this._rootNode){var o=this._viewStack[this._viewStack.length-1],s=o.begPos;this._curNode.x=s.x,this._curNode.y=s.y,0==t?this._curNode.visible=!1:egret.Tween.get(this._curNode).to({x:-this._curNode.width,y:0},200),this._curNode.viewWillDisappear&&this._curNode.viewWillDisappear()}var a={node:e,begPos:{x:e.x,y:e.y},endPos:{x:i?i:0,y:r?r:0}};this._rootNode.addChild(e),this._curNode=e,n?egret.Tween.get(e).call(function(){e.transAnibegin&&e.transAnibegin()}).to({x:i?i:0,y:r?r:0},200).call(function(){e.transFinish&&e.transFinish()}):(this._curNode.x=0,this._curNode.y=0),this._viewStack.push(a)}},e.prototype.pop=function(e){var t=this;if(void 0===e&&(e=0),!(this._viewStack.length<2)){var n=this._viewStack.pop(),i=n.node;0==e?this._rootNode.removeChild(i):egret.Tween.get(i).to({x:-i.width,y:0},200).call(function(){t._rootNode.removeChild(i)}),n=this._viewStack[this._viewStack.length-1];var r=n.endPos,i=n.node;i.visible=!0,this._curNode=i,egret.Tween.get(i).call(function(){i.transAnibegin&&i.transAnibegin()}).to({x:r.x,y:r.y},200).call(function(){i.transFinish&&i.transFinish()})}},e.prototype.reSet=function(){this._viewStack=[]},e.prototype.setRoot=function(e){this._rootNode=e},e.prototype.setCurNode=function(e){this._curNode=e},e}();__reflect(t.prototype,"ViewWalker");var n=function(e){function n(){var t=e.call(this)||this;return t._viewFrame=null,t.createTreeWalker(),t}return __extends(n,e),n.prototype.createTreeWalker=function(){return this._viewWalker=new t},n.prototype.setRoot=function(e){this._viewWalker.setRoot(e),this._rootLayer=e},n.prototype.setCurNode=function(e){this._viewWalker.setCurNode(e)},n.prototype.getViewByName=function(e){return this._rootLayer.getChildByName(e)},n.prototype.getRootLayer=function(){return this._rootLayer},n.prototype.showView=function(e,t,n,i,r){void 0===t&&(t=0),this._viewWalker.push(e,t,n,i,r)},n.prototype.popView=function(e){void 0===e&&(e=0),this._viewWalker.pop(e)},n.prototype.addWindow=function(e){egret.assert(null!=this._rootLayer),null!=this._rootLayer&&this._rootLayer.addChild(e)},n}(egret.DisplayObjectContainer);e.Controller=n,__reflect(n.prototype,"models.Controller")}(models||(models={}));var exp;!function(e){var t=function(t){function n(){var n=t.call(this)||this;return n.domNode=new e.DOMNode,n.domNode.mapDisplayObject(n),n.addEventListener(egret.Event.ADDED_TO_STAGE,n.addToStage,n),n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.removeFromStage,n),n.$renderNode=new egret.sys.RenderNode,n}return __extends(n,t),n.prototype.bind=function(e){this.domNode.bind(e)},n.prototype.unbind=function(){this.domNode.unbind()},n.prototype.addToStage=function(){egret.Capabilities.runtimeType==egret.RuntimeType.WEB&&(this.domNode.show(),this.domNode.updatePosition(),this.tempStage=this.stage,this.addEventListener(egret.Event.ENTER_FRAME,this.onResize,this))},n.prototype.removeFromStage=function(){this.removeEventListener(egret.Event.ENTER_FRAME,this.onResize,this),this.domNode.hide(),this.tempStage=null},n.prototype.onResize=function(){this.domNode&&this.domNode.updatePosition()},n}(egret.DisplayObject);e.WebNode=t,__reflect(t.prototype,"exp.WebNode")}(exp||(exp={}));var df;!function(e){function t(t){for(var n="务农",i=e.LV_DESC.length-1;i>=0;i--)if(t>=e.LV_SCORE[i])return e.LV_DESC[i];return n}function n(e){return null==e?1:null==e||0==e?1:e>0&&e>9?2:e>8&&12>e?3:e>11&&15>e?4:5}function i(t){return e.MEMBER_DESC[n(t)-1]}function r(e){if(0>=e)return 0;for(var t=0,n=0,i=0,r=1;60>r&&(i=r,t+=30*r,n+=t,!(n>e));r++);return i}function o(t,n){for(var i=e.getExperienceLevel(t),r=[1,5,10],o=r.length,s=1,a=0;n>a&&0!=i;a++);for(var c=0;o>c;c++)if(i>=r[o-1-c]){i-=r[o-1-c],s=o-c+1;break}return s=3>=s?s:1}function s(e){var t={wYear:e.Pop_WORD(),wMonth:e.Pop_WORD(),wDayOfWeek:e.Pop_WORD(),wDay:e.Pop_WORD(),wHour:e.Pop_WORD(),wMinute:e.Pop_WORD(),wSecond:e.Pop_WORD(),wMilliseconds:e.Pop_WORD()};return t}function a(t){var n={wAccessID:t.Pop_WORD(),wServicePort:t.Pop_WORD(),szServiceAddr:t.Pop_UTF16(e.LEN_SERVER)};return n}e.INVALID_BYTE=255,e.INVALID_WORD=65535,e.INVALID_DWORD=4294967295,e.Len_Tcp_Head=8,e.Len_Tcp_Info=4,e.SOCKET_TCP_BUFFER=16384,e.MAX_UNIT=100,e.Default_Time_Out=2e4,e.MDM_KN_COMMAND=0,e.SUB_KN_DETECT_SOCKET=1,e.SUB_KN_SHUT_DOWN_SOCKET=2,e.LEN_MD5=33,e.LEN_AREA=16,e.LEN_CITY=16,e.LEN_PROVINCE=16,e.LEN_ACCOUNTS=32,e.LEN_PASSWORD=33,e.LEN_GROUP_NAME=32,e.LEN_UNDER_WRITE=64,e.LEN_PROTECT_QUESTION=32,e.LEN_PASSPORT_ID=32,e.LEN_QQ=16,e.LEN_EMAIL=33,e.LEN_USER_UIN=33,e.LEN_USER_NOTE=256,e.LEN_SEAT_PHONE=33,e.LEN_MOBILE_PHONE=16,e.LEN_COMPELLATION=16,e.LEN_DWELLING_PLACE=128,e.LEN_DOMAIN=63,e.LEN_ADDRESS=16,e.LEN_VALIDATE=33,e.LEN_ACCREDIT_ID=33,e.LEN_COMPUTER_ID=33,e.LEN_MACHINE_SERIAL=33,e.LEN_NETWORK_ID=13,e.LEN_GROUP_INTRODUCE=128,e.LEN_VIDEO_KEY=33,e.LEN_VIDEO_CHANNEL=22,e.LEN_TYPE=32,e.LEN_KIND=32,e.LEN_NODE=32,e.LEN_SERVER=32,e.LEN_CUSTOM=32,e.LEN_PROCESS=32,e.STATION_ID=2e3,e.SPECIAL_ID=0,e.GAMELIST_LV_SCORE={1:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],7:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],8:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],15:[0,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],20:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],28:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],40:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],46:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],52:[0,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],55:[10,100,500,1e3,5e3,1e4,5e4,1e5,2e5],57:[10,100,500,1e3,5e3,1e4,5e4,1e5,2e5],60:[10,100,500,1e3,5e3,1e4,5e4,1e5,2e5],65:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],67:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],68:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],71:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],72:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],73:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],74:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],75:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],76:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],78:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],79:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],81:[10,100,500,1e3,5e3,1e4,5e4,1e5,2e5],82:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],86:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],87:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],88:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],89:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],90:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],91:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],92:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],93:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5],94:[10,100,500,1e3,5e3,1e4,5e4,1e5,2e5],95:[10,100,500,1e3,5e3,1e4,5e4,1e5,2e5],96:[10,100,500,1e3,5e3,1e4,5e4,1e5,2e5],99:[10,100,500,1e3,2e3,5e3,1e4,2e4,5e4,1e5]},e.LV_SCORE=[2e3,4e3,8e3,2e4,4e4,8e4,15e4,3e5,5e5,1e6,2e6,5e6,1e7,5e7,1e8,5e8,1e9],e.LV_DESC=["务农","佃户","雇工","作坊主","农场主","地主","大地主","财主","富翁","大富翁","小财神","大财神","赌棍","赌侠","赌王","赌圣","赌神","职业赌神"],e.MEMBER_FLAG=["","info_level_2.png","info_level_3.png","info_level_4.png","info_level_5.png"],e.MEMBER_DESC=["普通玩家","蓝钻会员","黄钻会员","铂钻会员","红钻会员"],e.getLevelDescribe=t,e.getMemberLv=n,e.getMemberDescribe=i,e.getExperienceLevel=r,e.getExpImgLevel=o,e.STATION_INFO={PLATFORM_NAME:{1e3:"网狐",1008:"西楚",1029:"恩施",2e3:"四川",2004:"广安",2008:"浙江",2009:"梅州",2010:"湖北",2011:"湖南"},BaseEnsureSupport:{1e3:!0,1008:!0,1029:!0,2e3:!0,2004:!0,2008:!0,2009:!0,2010:!0,2011:!0},RedeemCodeSupport:{1e3:!0,1008:!0,1029:!0,2e3:!0,2004:!0,2008:!0,2010:!0,2011:!0},LuckyRollSupport:{1e3:!0,2008:!0,2009:!0},WechatSupport:{1e3:!0,1008:!0,1029:!0,2e3:!0,2004:!0,2008:!0,2009:!0,2010:!0,2011:!0},RegistSupport:{1e3:!0,1008:!0,2e3:!0,2009:!0,2010:!0,2011:!0},AccountSupport:{1e3:!0,1008:!0,1029:!0,2e3:!0,2004:!0,2008:!0,2009:!0,2010:!0,2011:!0},ItemSupport:{1e3:!0,1008:!0,2e3:!0,2004:!0,2008:!0,2009:!0,2010:!0,2011:!0},AliPaySupport:{1e3:!0,1008:!0,1029:!0,2e3:!0,2004:!0,2008:!0,2009:!0,2010:!0,2011:!0},WechatPaySupport:{1e3:!0,1008:!0,1029:!0,2e3:!0,2004:!0,2008:!0,2009:!0,2010:!0,2011:!0},RankSupport:{1e3:!0,1008:!0,2009:!0},OtherVedioSupport:{1e3:!0,2009:!0},ActiveSupport:{1e3:!0,2e3:!0},MatchSupport:{1e3:!0,1008:!1,1029:!1,2e3:!1,2004:!1,2008:!1,2009:!1,2010:!1,2011:!1},RoomCardSupport:{1e3:!0,1008:!0,1029:!0,2e3:!0,2004:!0,2008:!0,2009:!0,2010:!0,2011:!0},StationSupport:{1e3:!0}},e.GAMELISTINFO=[{id:"1",cn:"五张牌",name:"showhand",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"7",cn:"庄十三张",name:"thirteen",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"8",cn:"比十三张",name:"thirteenbi",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"15",cn:"掼蛋",name:"guandan",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"20",cn:"小包子麻将",name:"sparrowsy",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"28",cn:"拼十",name:"ox",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"40",cn:"德州扑克",name:"dzshowhand",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,disableNormal:!0,disableBattle:!1,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"46",cn:"五张牌",name:"showhandex",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"52",cn:"转蛋",name:"zhuandan",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"57",cn:"断勾卡血战麻将",name:"Sparrowsclm",path:"chess",module:game.sparrowsclm.GameClientEngine,group:"Sparrowsclm",logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,video:!0,videoname:"GameClientEngineVideo",version:utils.PROCESS_VERSION(1,1,0,1)},{id:"60",cn:"丁二红",name:"chexuan",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"65",cn:"广安麻将",name:"sparrowga",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"67",cn:"衡阳麻将",name:"sparrowhy",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"68",cn:"衡阳鬼麻将",name:"sparrowhyg",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"82",cn:"血战麻将",name:"sparrowxz",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"86",cn:"癞子斗地主",name:"landlord",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"87",cn:"绍兴麻将",name:"sparrowsx",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"88",cn:"红中宝",name:"sparrowhzb",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"89",cn:"血流麻将",name:"sparrowxl",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"91",cn:"梅州红中宝",name:"sparrowhzb_mz",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"90",cn:"晃晃麻将",name:"sparrowhh",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"92",cn:"一痞二癞麻将",name:"sparroweslz",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"94",cn:"四人断勾卡",name:"sparrowdgk",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!1,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"55",cn:"四川斗地主",name:"landsc",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!1,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"71",cn:"泗阳麻将",name:"sparrowsiyang",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!1,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"95",cn:"斗十四",name:"platedss",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!1,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"75",cn:"兰州麻将",name:"sparrowlz",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"93",cn:"划水麻将",name:"sparrowhs",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"96",cn:"捉鸟麻将",name:"sparrowzn",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"72",cn:"挖坑",name:"wakeng",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!1,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"73",cn:"宿迁麻将",name:"sparrowsq",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"76",cn:"跑得快",name:"runfast",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!1,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"78",cn:"双扣",name:"shuangkou",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!1,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"81",cn:"昏地主",name:"landsch",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"98",cn:"打旋",name:"daxuan",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,disableNormal:!0,disableBattle:!1,sort:0,model:!0,video:!1,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"79",cn:"牌九",name:"paigow",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!1,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"99",cn:"广东麻将",name:"sparrowgd",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"74",cn:"泗洪麻将",name:"sparrowsihong",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!1,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"97",cn:"泸州鬼麻将",name:"sparrowlzg",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"77",cn:"泸州大贰",name:"platedr",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!1,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"100",cn:"二人麻将",name:"sparrower",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,disableNormal:!0,disableBattle:!1,model:!0,video:!1,version:utils.PROCESS_VERSION(1,1,0,1)}],e.STATION_GAME={1e3:{57:!0},1008:{20:!0,28:!0,15:!0,52:!0,71:!0},1029:{86:!0,28:!0,92:!0},2e3:{57:!0,86:!0,94:!0,82:!0,28:!0,60:!0,40:!0,55:!0,95:!0,76:!0},2004:{65:!0,82:!0,28:!0,0:!0,86:!0},2008:{87:!0,28:!0,40:!0,8:!0},2009:{88:!0,86:!0,91:!0,28:!0},2010:{90:!0},2011:{90:!0},2013:{99:!0}},e.PLATFORM_NAME=e.STATION_INFO.PLATFORM_NAME[e.STATION_ID],e.BaseEnsureSupport=e.STATION_INFO.BaseEnsureSupport[e.STATION_ID],e.RedeemCodeSupport=e.STATION_INFO.RedeemCodeSupport[e.STATION_ID],e.LuckyRollSupport=e.STATION_INFO.LuckyRollSupport[e.STATION_ID],e.RankSupport=e.STATION_INFO.RankSupport[e.STATION_ID],e.OtherVedioSupport=e.STATION_INFO.OtherVedioSupport[e.STATION_ID],e.WechatSupport=!0,e.RegistSupport=e.STATION_INFO.RegistSupport[e.STATION_ID],e.AccountSupport=e.STATION_INFO.AccountSupport[e.STATION_ID],e.ItemSupport=e.STATION_INFO.ItemSupport[e.STATION_ID],e.ActiveSupport=e.STATION_INFO.ActiveSupport[e.STATION_ID],e.MatchSupport=e.STATION_INFO.MatchSupport[e.STATION_ID],e.RoomCardSupport=e.STATION_INFO.RoomCardSupport[e.STATION_ID],e.StationSupport=e.STATION_INFO.StationSupport[e.STATION_ID],e.AliPaySupport=!0,e.WechatPaySupport=!0,e.IAPurchaseSupport=!1,e.AABattleSupport=!0,e.MoreGameSupport=!0,e.MODE_TH_SET=1,e.MODE_TH_MODIFY=2,e.MODE_TH_CREATE=3,e.DomainGetLogon="androidwh.foxuc.com",e.PortGetLogon=8100,e.WebAddress="phone.foxuc.com",e.GameListSpecial=2009,e.APP_VERSION="1.14",e.TEST_SERVER=!1,e.MatchVersion="",e.PLAZA_VERSION=utils.PROCESS_VERSION(1,1,0,0),e.SPECIAL_LOG=!1,e.SINGLE_GAME_MODE=!1,e.MARKET_ID=1,e.DEVICE_TYPE=64,e.APP_SOURCE=268501992,e.LUA_VERSION=1.5,e.ACCOUNT_TYPE_SELF=1,e.ACCOUNT_TYPE_WECHAT=7,e.US_NULL=0,e.US_FREE=1,e.US_SIT=2,e.US_READY=3,e.US_LOOKON=4,e.US_PLAYING=5,e.US_OFFLINE=6,e.FACE_X=48,e.FACE_Y=48,e.INVALID_TABLE=65535,e.INVALID_CHAIR=65535,e.INVALID_ITEM=65535,e.GENDER_FEMALE=1,e.GENDER_MANKIND=2,e.GENDER_SECRET=0,e.GAME_GENRE_GOLD=1,e.GAME_GENRE_SCORE=2,e.GAME_GENRE_MATCH=4,e.GAME_GENRE_EDUCATE=8,e.TABLE_GENRE_NORMAL=0,e.TABLE_GENRE_CREATE=4096,e.TABLE_GENRE_DISTRIBUTE=8192,e.LEN_GAME_LIST_ITEM=142,e.LEN_GAME_SERVER_ITEM=236,e.LEN_CREATE_OPTION_ITEM=151,e.LEN_ACCESS_ITEM=68,e.RFC_NULL=0,e.RFC_PASSWORD_INCORRECT=1,e.RFC_SCORE_UNENOUGH=3,e.RFC_CREATE_TABLE_FAILURE=4,e.RFC_ENTER_TABLE_FAILURE=5,e.QUERY_KIND_NUMBER=0,e.QUERY_KIND_USERID=1,e.QUERY_KIND_GROUP=2,e.SETTLE_KIND_TIME=0,e.SETTLE_KIND_COUNT=1,e.SETTLE_KIND_NONE=2,e.WEALTH_MASK_INGOT=1,e.WEALTH_MASK_MEDAL=2,e.WEALTH_MASK_SCORE=4,e.WEALTH_MASK_ROOMCARD=8,e.CURRENCY_KIND_INGOT=0,e.CURRENCY_KIND_ROOMCARD=1,e.PAY_TYPE_OWNER=1,e.PAY_TYPE_USER=2,e.OPTION_MASK_TIME=1,e.OPTION_MASK_COUNT=2,e.OPTION_MASK_INGOT=4,e.OPTION_MASK_ROOMCARD=8,e.OPTION_TYPE_NONE=0,e.OPTION_TYPE_SINGLE=1,e.OPTION_TYPE_MULTIPLE=2,e.OPTION_TYPE_INPUT=4,e.FO_FORBID_RECHARGE=1,e.DISMISS_STATE_START=1,e.DISMISS_STATE_OTHER=2,e.DISMISS_STATE_WAIT=3,e.DISMISS_STATE_OVER=4,e.USER_DISMISS_WAIT=1,e.USER_DISMISS_REJECT=2,e.USER_DISMISS_AGREE=3,e.SYSTEMTIME=s,e.tagAccessItem=a,e.TOP_ZORDER=1e3,e.MODE_CHOOSE=1,e.MODE_ACCOUNT=2,e.MODE_REGISTER=3,e.MODE_SERVICE=4,e.MODE_OPTION=5,e.MODE_WECHAT=6,e.MODE_STATION=7,e.MODE_NOTICE=8,e.MODE_AGREE=9,e.MODE_PLAZA_OPTION=10,e.MODE_USER_INFO=11,e.MODE_SHOP=12,e.MODE_RANK=13,e.MODE_BATTLE_FIND=14,e.MODE_BATTLE_LIST=15,e.MODE_BATTLE_RECORD=16,e.MODE_BENEFIT=17,e.MODE_BATTLE_CREATE=18,e.MODE_GAME_HELP=19,e.MODE_ROOM_LIST=20,e.MODE_TAE_HOUSE=21
}(df||(df={}));var client;!function(e){var t=function(e){function t(t,n,i){var r=e.call(this)||this;return r._items=[],r._seletedValues=[],r._scene=t,r._showData=n,r.skinName=skins.RadioGroup,r._seletedValues=n.selectedValue,r.onInitGroup(),r}return __extends(t,e),t.prototype.onInitGroup=function(){this._title.text=this._showData.title;for(var e=0;e<this._showData.itemCount;e++){var t=this.getChildByName("checkbox_"+(e+1));t.visible=!0,1==this._seletedValues[e]?t.selected=!0:t.selected=!1,this._items.push(t),t.addEventListener(egret.Event.CHANGE,this.onEventChange,this);var n=this.getChildByName("title"+(e+1));n.visible=!0,n.text=this._showData.option[e]}},t.prototype.onEventChange=function(e){var t=e.target,n=Number(t.name.substr(9,t.name.length))-1;this._seletedValues[n]=1==t.selected?1:0,null!=this._changeListener&&this._changeListener(n)},t.prototype.onResetView=function(){for(var e=0,t=this._items;e<t.length;e++){var n=t[e];n.selected=!1}for(var i=0;i<this._seletedValues.length;i++)this._seletedValues[i]=-1},t.prototype.setSelectedIndex=function(e,t){var n=this._items[e];n&&(n.selected=!0,this._seletedValues[e]=1)},t.prototype.getSelectValue=function(){return this._seletedValues},t}(eui.Component);e.CheckBoxGroup=t,__reflect(t.prototype,"client.CheckBoxGroup")}(client||(client={}));var client;!function(e){var t=function(e){function t(t,n,i){var r=e.call(this)||this;return r._orignalData=1,r._inputValue=1,r._scene=t,r._showData=n,r.skinName=skins.BattleNumInput,r.touchEnabled=!1,r._changeListener=i,r.onInitInput(),r}return __extends(t,e),t.prototype.onInitInput=function(){var e=this.getChildByName("bt_min");e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),e=this.getChildByName("bt_plus"),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var t=this.getChildByName("numInput");t.addEventListener(egret.Event.CHANGE,this.onChange,this),t.text=""+this._showData.lMinBaseScore,t.inputType=egret.TextFieldInputType.TEL,this._inputText=t},t.prototype.onChange=function(e){var t=e.target;""!=t.text&&(isNaN(Number(t.text))?t.text=""+this._showData.lMinBaseScore:Number(t.text)<this._showData.lMinBaseScore?t.text=""+this._showData.lMinBaseScore:Number(t.text)<=this._showData.lMaxBaseScore||(t.text=""+this._showData.lMaxBaseScore),null!=this._changeListener&&this._changeListener(Number(t.text)))},t.prototype.onButtonClick=function(e){var t=e.target,n=t.name;switch(egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},100).to({scaleX:1,scaleY:1},100),n){case"bt_plus":Number(this._inputText.text)+1<=this._showData.lMaxBaseScore&&(this._inputText.text=""+(Number(this._inputText.text)+1));break;case"bt_min":Number(this._inputText.text)-1>=this._showData.lMinBaseScore&&(this._inputText.text=""+(Number(this._inputText.text)-1))}null!=this._changeListener&&this._changeListener(this.getInputValue())},t.prototype.setOrignalCell=function(e){var t=this.getChildByName("numInput");t.text=""+e},t.prototype.getInputValue=function(){return this._inputText.text},t}(eui.Component);e.NumInput=t,__reflect(t.prototype,"client.NumInput")}(client||(client={}));var client;!function(e){var t=function(e){function t(t,n,i){var r=e.call(this)||this;return r._items=[],r._curSeletedIdx=-1,r._scene=t,r._showData=n,r.skinName=skins.RadioGroup,r._changeListener=i,r.touchEnabled=!1,r._title=r.getChildByName("title"),r.onInitGroup(),r}return __extends(t,e),t.prototype.onInitGroup=function(){this._title.text=this._showData.title;for(var e=0;e<this._showData.itemCount;e++){var t=this.getChildByName("checkbox_"+(e+1));t.visible=!0,e==this._showData.seletedIdx&&(t.selected=!0,this._curSeletedIdx=e,null!=this._changeListener&&this._changeListener(this._curSeletedIdx)),t.addEventListener(egret.Event.CHANGE,this.onEventChange,this);var n=this.getChildByName("title"+(e+1));n.visible=!0,n.text=this._showData.option[e];var i={checkbox:t,option:n,idx:e};this._items.push(i)}},t.prototype.onEventChange=function(e){for(var t=e.target,n=0,i=this._items;n<i.length;n++){var r=i[n];r.checkbox==t?(t.selected=!0,this._curSeletedIdx=r.idx,null!=this._changeListener&&this._changeListener(this._curSeletedIdx)):r.checkbox.selected=!1}},t.prototype.onResetView=function(){for(var e=0,t=this._items;e<t.length;e++){var n=t[e];n.checkbox.selected=!1}this._curSeletedIdx=-1},t.prototype.setSelectedIndex=function(e,t){void 0===t&&(t=!0),this.onResetView();var n=this._items[e].checkbox;n&&(n.selected=t,1==t&&(this._curSeletedIdx=e,null!=this._changeListener&&this._changeListener(this._curSeletedIdx)))},t.prototype.getSelectedIndex=function(){return this._curSeletedIdx},t}(eui.Component);e.RadioGroup=t,__reflect(t.prototype,"client.RadioGroup")}(client||(client={}));var managers;!function(e){var t=function(){function t(){this._MsgQueue=[],this._isAllowDispatch=!0,this._curServerIdx=0,this.m_ReConnectMax=5,this.m_ReConnectTimeOut=10,this.m_bReConnect=!1,this.m_bPlaza=!0,this.m_DefaultServerInfo={domain:"s88.foxuc.com",port:8100,webAddr:"testwww.foxuc.com"},this.URL_RECHARGE_CARD="",this.ZFB_CALLBACK_URL="",this._host="",this._port=0}return t.getInstance=function(){return null==this.m_sInstance&&(this.m_sInstance=new t,this.m_sInstance.init()),this.m_sInstance},t.prototype.init=function(){this.m_ServerInfo=new models.ServerInfo,this.m_GamelistInfo=new client.GameListInfo},t.prototype.setServerIdx=function(e){this._curServerIdx=e},t.prototype.setCurServerList=function(e){this._curServerList=e},t.prototype.getServerInfo=function(){return this.m_ServerInfo},t.prototype.getGameListInfo=function(){return this.m_GamelistInfo},t.prototype.onConnectPlaza=function(){var e=this.loadAgentPlazaRecord(),t=e?e.host:this.m_DefaultServerInfo.domain,n=e?e.port:this.m_DefaultServerInfo.port;this.createSocketService(t,n)},t.prototype.onConnectRoom=function(){var e=new frame.GameFrame;this.setDelegate(e),e.onLogonRoom()},t.prototype.loadAgentPlazaRecord=function(){var e=JSON.parse(localStorage.getItem("lastLogin"));return e},t.prototype.saveAgentPlazaRecord=function(){var e={host:"",port:0};e.host=this._host,e.port=this._port,localStorage.setItem("lastLogin",JSON.stringify(e))},t.prototype.socketConnectSuccess=function(){this.m_ReConnectCount=0,this.m_bPlaza&&(this.saveAgentPlazaRecord(),this.m_DefaultServerInfo.domain=this._host,this.m_DefaultServerInfo.port=this._port)},t.prototype.onReconnect=function(){e.FrameManager.getInstance().showPopWait("网络重连中")},t.prototype.onReconnectTimeOut=function(){},t.prototype.onReconnectFailure=function(){null!=this._delegate&&this._delegate.getDispatcher().dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_CONNECT_FAIlURE))},t.prototype.setDelegate=function(e){this._delegate=null,null!=e&&(this._delegate=e)},t.prototype.getDelegate=function(){return this._delegate?this._delegate:null},t.prototype.getTcpService=function(){return this.m_pTcpService},t.prototype.createSocketService=function(e,t,n){void 0===n&&(n=1);var i=new service.TcpSocketService(this,n);i.createConnect(e,t),this.m_pTcpService=null,this.m_pTcpService=i,this.m_bPlaza=1==n?!0:!1,1==this.m_bPlaza&&(this._host=e,this._port=t)},t.prototype.createGateWayService=function(){return this.m_pGateWayCtrl=null,this.m_pGateWayCtrl=new e.GateWayCtrl},t.prototype.getGateWayService=function(){return this.m_pGateWayCtrl},t.prototype.closeService=function(){this.m_pTcpService&&(this.m_pTcpService.closeService(),this.m_pTcpService=null,this._curServerIdx=0,this.m_ReConnectCount=0,this._curServerList=null,this._delegate=null)},t.prototype.onUpdate=function(){if(this.m_pTcpService&&this.m_pTcpService.onUpdate&&this.m_pTcpService.onUpdate(),this.m_pGateWayCtrl&&this.m_pGateWayCtrl.onUpdate&&this.m_pGateWayCtrl.onUpdate(),0!=this._MsgQueue.length){if(null==this._delegate)return void console.log("delegate is null");if(0==this._isAllowDispatch)return void console.log("the curren dispatch is paused");if(null!=this._delegate.onMessage){var e=[],t=this._MsgQueue.length;for(t=t<df.MAX_UNIT?t:df.MAX_UNIT,e=this._MsgQueue.slice(0,t),this._MsgQueue.splice(0,t);e.length;){var n=e[0];this._delegate.getDispatcher().dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_MESSAGE_DISPATCH,!1,!1,n)),e.shift()}}}},t}();e.TcpServiceCtrl=t,__reflect(t.prototype,"managers.TcpServiceCtrl",["df.IConnectSocket","df.ISocketService"])}(managers||(managers={}));var models;!function(e){var t=function(e){function t(t,n,i){var r=e.call(this)||this;return r._removeHandler=null,r._removeHandler=i,r._scene=t,r._alpha=n,r}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},t.prototype.onInitLayer=function(){var e=this,t=new egret.Shape;t.graphics.beginFill(0,1),t.graphics.drawRect(0,0,this.width,this.height),t.graphics.endFill(),t.alpha=.5,utils.setAnchorCenter(t),this.addChild(t),t.x=this.width/2,t.y=this.height/2,t.touchEnabled=!0,t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(t){null!=e._removeHandler&&e._removeHandler(),e._scene.removeChild(e)},this)},t.prototype.onExit=function(){this._removeHandler=null},t}(eui.UILayer);e.MaskExLayer=t,__reflect(t.prototype,"models.MaskExLayer")}(models||(models={}));var utils;!function(e){var t=function(){function e(){this.hexcase=0,this.b64pad=""}return e.MD5_HEX=function(t){var n=new e;return n.hex_md5(t)},e.prototype.hex_md5=function(e){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.b64_md5=function(e){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(e)))},e.prototype.any_md5=function(e,t){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(e)),t)},e.prototype.hex_hmac_md5=function(e,t){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.b64_hmac_md5=function(e,t){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)))},e.prototype.any_hmac_md5=function(e,t,n){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(e),this.str2rstr_utf8(t)),n)},e.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},e.prototype.rstr_md5=function(e){return this.binl2rstr(this.binl_md5(this.rstr2binl(e),8*e.length))},e.prototype.rstr_hmac_md5=function(e,t){var n=this.rstr2binl(e);n.length>16&&(n=this.binl_md5(n,8*e.length));for(var i=Array(16),r=Array(16),o=0;16>o;o++)i[o]=909522486^n[o],r[o]=1549556828^n[o];var s=this.binl_md5(i.concat(this.rstr2binl(t)),512+8*t.length);return this.binl2rstr(this.binl_md5(r.concat(s),640))},e.prototype.rstr2hex=function(e){try{this.hexcase}catch(t){this.hexcase=0}for(var n,i=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",r="",o=0;o<e.length;o++)n=e.charCodeAt(o),r+=i.charAt(n>>>4&15)+i.charAt(15&n);return r},e.prototype.rstr2b64=function(e){try{this.b64pad}catch(t){this.b64pad=""}for(var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i="",r=e.length,o=0;r>o;o+=3)for(var s=e.charCodeAt(o)<<16|(r>o+1?e.charCodeAt(o+1)<<8:0)|(r>o+2?e.charCodeAt(o+2):0),a=0;4>a;a++)i+=8*o+6*a>8*e.length?this.b64pad:n.charAt(s>>>6*(3-a)&63);return i},e.prototype.rstr2any=function(e,t){var n,i,r,o,s,a=t.length,c=Array(Math.ceil(e.length/2));for(n=0;n<c.length;n++)c[n]=e.charCodeAt(2*n)<<8|e.charCodeAt(2*n+1);var _=Math.ceil(8*e.length/(Math.log(t.length)/Math.log(2))),l=Array(_);for(i=0;_>i;i++){for(s=Array(),o=0,n=0;n<c.length;n++)o=(o<<16)+c[n],r=Math.floor(o/a),o-=r*a,(s.length>0||r>0)&&(s[s.length]=r);l[i]=o,c=s}var h="";for(n=l.length-1;n>=0;n--)h+=t.charAt(l[n]);return h},e.prototype.str2rstr_utf8=function(e){for(var t,n,i="",r=-1;++r<e.length;)t=e.charCodeAt(r),n=r+1<e.length?e.charCodeAt(r+1):0,t>=55296&&56319>=t&&n>=56320&&57343>=n&&(t=65536+((1023&t)<<10)+(1023&n),r++),127>=t?i+=String.fromCharCode(t):2047>=t?i+=String.fromCharCode(192|t>>>6&31,128|63&t):65535>=t?i+=String.fromCharCode(224|t>>>12&15,128|t>>>6&63,128|63&t):2097151>=t&&(i+=String.fromCharCode(240|t>>>18&7,128|t>>>12&63,128|t>>>6&63,128|63&t));return i},e.prototype.str2rstr_utf16le=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(255&e.charCodeAt(n),e.charCodeAt(n)>>>8&255);return t},e.prototype.str2rstr_utf16be=function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e.charCodeAt(n)>>>8&255,255&e.charCodeAt(n));return t},e.prototype.rstr2binl=function(e){for(var t=Array(e.length>>2),n=0;n<t.length;n++)t[n]=0;for(var n=0;n<8*e.length;n+=8)t[n>>5]|=(255&e.charCodeAt(n/8))<<n%32;return t},e.prototype.binl2rstr=function(e){for(var t="",n=0;n<32*e.length;n+=8)t+=String.fromCharCode(e[n>>5]>>>n%32&255);return t},e.prototype.binl_md5=function(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;for(var n=1732584193,i=-271733879,r=-1732584194,o=271733878,s=0;s<e.length;s+=16){var a=n,c=i,_=r,l=o;n=this.md5_ff(n,i,r,o,e[s+0],7,-680876936),o=this.md5_ff(o,n,i,r,e[s+1],12,-389564586),r=this.md5_ff(r,o,n,i,e[s+2],17,606105819),i=this.md5_ff(i,r,o,n,e[s+3],22,-1044525330),n=this.md5_ff(n,i,r,o,e[s+4],7,-176418897),o=this.md5_ff(o,n,i,r,e[s+5],12,1200080426),r=this.md5_ff(r,o,n,i,e[s+6],17,-1473231341),i=this.md5_ff(i,r,o,n,e[s+7],22,-45705983),n=this.md5_ff(n,i,r,o,e[s+8],7,1770035416),o=this.md5_ff(o,n,i,r,e[s+9],12,-1958414417),r=this.md5_ff(r,o,n,i,e[s+10],17,-42063),i=this.md5_ff(i,r,o,n,e[s+11],22,-1990404162),n=this.md5_ff(n,i,r,o,e[s+12],7,1804603682),o=this.md5_ff(o,n,i,r,e[s+13],12,-40341101),r=this.md5_ff(r,o,n,i,e[s+14],17,-1502002290),i=this.md5_ff(i,r,o,n,e[s+15],22,1236535329),n=this.md5_gg(n,i,r,o,e[s+1],5,-165796510),o=this.md5_gg(o,n,i,r,e[s+6],9,-1069501632),r=this.md5_gg(r,o,n,i,e[s+11],14,643717713),i=this.md5_gg(i,r,o,n,e[s+0],20,-373897302),n=this.md5_gg(n,i,r,o,e[s+5],5,-701558691),o=this.md5_gg(o,n,i,r,e[s+10],9,38016083),r=this.md5_gg(r,o,n,i,e[s+15],14,-660478335),i=this.md5_gg(i,r,o,n,e[s+4],20,-405537848),n=this.md5_gg(n,i,r,o,e[s+9],5,568446438),o=this.md5_gg(o,n,i,r,e[s+14],9,-1019803690),r=this.md5_gg(r,o,n,i,e[s+3],14,-187363961),i=this.md5_gg(i,r,o,n,e[s+8],20,1163531501),n=this.md5_gg(n,i,r,o,e[s+13],5,-1444681467),o=this.md5_gg(o,n,i,r,e[s+2],9,-51403784),r=this.md5_gg(r,o,n,i,e[s+7],14,1735328473),i=this.md5_gg(i,r,o,n,e[s+12],20,-1926607734),n=this.md5_hh(n,i,r,o,e[s+5],4,-378558),o=this.md5_hh(o,n,i,r,e[s+8],11,-2022574463),r=this.md5_hh(r,o,n,i,e[s+11],16,1839030562),i=this.md5_hh(i,r,o,n,e[s+14],23,-35309556),n=this.md5_hh(n,i,r,o,e[s+1],4,-1530992060),o=this.md5_hh(o,n,i,r,e[s+4],11,1272893353),r=this.md5_hh(r,o,n,i,e[s+7],16,-155497632),i=this.md5_hh(i,r,o,n,e[s+10],23,-1094730640),n=this.md5_hh(n,i,r,o,e[s+13],4,681279174),o=this.md5_hh(o,n,i,r,e[s+0],11,-358537222),r=this.md5_hh(r,o,n,i,e[s+3],16,-722521979),i=this.md5_hh(i,r,o,n,e[s+6],23,76029189),n=this.md5_hh(n,i,r,o,e[s+9],4,-640364487),o=this.md5_hh(o,n,i,r,e[s+12],11,-421815835),r=this.md5_hh(r,o,n,i,e[s+15],16,530742520),i=this.md5_hh(i,r,o,n,e[s+2],23,-995338651),n=this.md5_ii(n,i,r,o,e[s+0],6,-198630844),o=this.md5_ii(o,n,i,r,e[s+7],10,1126891415),r=this.md5_ii(r,o,n,i,e[s+14],15,-1416354905),i=this.md5_ii(i,r,o,n,e[s+5],21,-57434055),n=this.md5_ii(n,i,r,o,e[s+12],6,1700485571),o=this.md5_ii(o,n,i,r,e[s+3],10,-1894986606),r=this.md5_ii(r,o,n,i,e[s+10],15,-1051523),i=this.md5_ii(i,r,o,n,e[s+1],21,-2054922799),n=this.md5_ii(n,i,r,o,e[s+8],6,1873313359),o=this.md5_ii(o,n,i,r,e[s+15],10,-30611744),r=this.md5_ii(r,o,n,i,e[s+6],15,-1560198380),i=this.md5_ii(i,r,o,n,e[s+13],21,1309151649),n=this.md5_ii(n,i,r,o,e[s+4],6,-145523070),o=this.md5_ii(o,n,i,r,e[s+11],10,-1120210379),r=this.md5_ii(r,o,n,i,e[s+2],15,718787259),i=this.md5_ii(i,r,o,n,e[s+9],21,-343485551),n=this.safe_add(n,a),i=this.safe_add(i,c),r=this.safe_add(r,_),o=this.safe_add(o,l)}return[n,i,r,o]},e.prototype.md5_cmn=function(e,t,n,i,r,o){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(t,e),this.safe_add(i,o)),r),n)},e.prototype.md5_ff=function(e,t,n,i,r,o,s){return this.md5_cmn(t&n|~t&i,e,t,r,o,s)},e.prototype.md5_gg=function(e,t,n,i,r,o,s){return this.md5_cmn(t&i|n&~i,e,t,r,o,s)},e.prototype.md5_hh=function(e,t,n,i,r,o,s){return this.md5_cmn(t^n^i,e,t,r,o,s)},e.prototype.md5_ii=function(e,t,n,i,r,o,s){return this.md5_cmn(n^(t|~i),e,t,r,o,s)},e.prototype.safe_add=function(e,t){var n=(65535&e)+(65535&t),i=(e>>16)+(t>>16)+(n>>16);return i<<16|65535&n},e.prototype.bit_rol=function(e,t){return e<<t|e>>>32-t},e}();e.MD5=t,__reflect(t.prototype,"utils.MD5")}(utils||(utils={}));var AssetAdapter=function(){function e(){}return e.prototype.getAsset=function(e,t,n){function i(i){t.call(n,i,e)}if(RES.hasRes(e)){var r=RES.getRes(e);r?i(r):RES.getResAsync(e,i,this)}else RES.getResByUrl(e,i,this,RES.ResourceItem.TYPE_IMAGE)},e}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var df;!function(e){var t=function(){function e(){}return e}();e.tagUserScore=t,__reflect(t.prototype,"df.tagUserScore");var n=function(){function e(){}return e}();e.tagMobileUserScore=n,__reflect(n.prototype,"df.tagMobileUserScore");var i=function(){function e(){}return e}();e.tagUserStatus=i,__reflect(i.prototype,"df.tagUserStatus");var r=function(){function e(){}return e}();e.tagUserSegment=r,__reflect(r.prototype,"df.tagUserSegment");var o=function(){function e(){}return e}();e.tagTableStatus=o,__reflect(o.prototype,"df.tagTableStatus");var s=function(){function e(){}return e}();e.tagMatchRoundItem=s,__reflect(s.prototype,"df.tagMatchRoundItem")}(df||(df={}));var customEvent;!function(e){var t=function(e){function t(t,n,i,r){return e.call(this,t,n,i,r)||this}return __extends(t,e),t.EVENT_ENTER_BACKGROUND="enterBackGround",t.EVENT_BECOME_ACTIVE="becomeActive",t.EVENT_VALIDATE_SUCCESS="validateSuccess",t.EVENT_CONNECT_COMPLETE="connectComplete",t.EVENT_MESSAGE_DISPATCH="messageDispatch",t.EVENT_CONNECT_FAIlURE="connectFailure",t.EVENT_PLAZA_REFRESH="plazaFresh",t.EVENT_ROOM_REFRESH="roomRefresh",t.EVENT_SHOP_REFRESH="shopRefresh",t.EVENT_BATTLE_INFO_REFRESH="battleInfoRefresh",t.EVENT_BATTLE_REFRESH="battleFresh",t.EVENT_USER_ENTER="userEnter",t.EVENT_USER_STATUS="userStatus",t}(egret.Event);e.CustomEvent=t,__reflect(t.prototype,"customEvent.CustomEvent")}(customEvent||(customEvent={}));var managers;!function(e){var t=function(){function t(){this.m_IsAuto=!0}return t.getInstance=function(){return null==this.m_sInstance&&(this.m_sInstance=new t,this.m_sInstance.onInit()),this.m_sInstance},t.prototype.onInit=function(){e.TcpServiceCtrl.getInstance().init(),e.TimerCtrl.getInstance().init(),this.m_Localization=new cache.localization},t.prototype.onUpdate=function(){e.TcpServiceCtrl.getInstance().onUpdate()},t.prototype.setRunningController=function(e){this.m_RunningController=null,this.m_RunningController=e},t.prototype.getRunningController=function(){return this.m_RunningController?this.m_RunningController:null},t.prototype.isGameController=function(){return"GameController"==this.m_RunningController.name?!0:!1},t.prototype.replaceScene=function(e,t){var n=this,i=this.m_RunningController;if(egret.assert(null!=i),i.name!=e.name)if(this.m_RunningController=null,this.m_RunningController=e,t){e.alpha=0,this.m_MainStage.addChild(e);var r=egret.Tween.get(e),o=egret.Tween.get(i);o.call(function(){i.viewWillDisappear(t)},this),o.to({alpha:0},1e3,egret.Ease.backOut),r.call(function(){e.viewWillAppear(t)},this),r.to({alpha:1},1e3,egret.Ease.backIn),r.call(function(){e.viewDidAppear(t)},this),o.call(function(){i.viewDidDisappear(t)},this),o.call(function(){i.dealloc(),n.m_MainStage.removeChild(i),i=null},this)}else e.viewWillAppear(t),this.m_MainStage.addChild(e),e.viewDidAppear(t),i.viewWillDisappear(t),i.viewDidDisappear(t),i.dealloc(),this.m_MainStage.removeChild(i)},t.prototype.showDailog=function(e,t,n,i){if(null!=this.m_MainStage.getChildByName("Dialog")){var r=this.m_MainStage.getChildByName("Dialog");this.m_MainStage.removeChild(r)}var o=new models.Dialog(e,t,n,i);this.m_MainStage.addChildAt(o,df.TOP_ZORDER)},t.prototype.showToast=function(e,t){var n=new models.Toast;this.m_MainStage.addChildAt(n,df.TOP_ZORDER),n.show(e,t)},t.prototype.showPopWait=function(e,t,n,i,r){if(void 0===t&&(t=df.Default_Time_Out),void 0===n&&(n=!1),null==this.m_MainStage.getChildByName("PopWait")){var o=new models.PopWait(e,t,n,i,r);this.m_MainStage.addChildAt(o,df.TOP_ZORDER)}},t.prototype.dismissPopWait=function(){var e=this.m_MainStage.getChildByName("PopWait");null!=e&&this.m_MainStage.removeChild(e)},t}();e.FrameManager=t,__reflect(t.prototype,"managers.FrameManager")}(managers||(managers={}));var managers;!function(e){var t=function(){function t(){this._MsgQueue=[],this._curServerIdx=0,this.onInit(),this.setCurServerList(e.TcpServiceCtrl.getInstance().getServerInfo().getAccessServer())}return t.prototype.connectGateWay=function(){return null==this._curServerList||0==this._curServerList.length?void console.log("网关服务器列表为空"):(this.m_pTcpService=new service.TcpSocketService(this,2),void this.m_pTcpService.createConnect(this._curServerList[this._curServerIdx].szServiceAddr,this._curServerList[this._curServerIdx].wServicePort))},t.prototype.setServerIdx=function(e){this._curServerIdx=e},t.prototype.setCurServerList=function(e){this._curServerList=e},t.prototype.onUpdate=function(){if(this.m_pTcpService&&this.m_pTcpService.onUpdate&&this.m_pTcpService.onUpdate(),0!=this._MsgQueue.length){if(null==this._delegate)return void console.log("delegate is null");if(null!=this._delegate.onMessage){var e=[],t=this._MsgQueue.length;for(t=t<df.MAX_UNIT?t:df.MAX_UNIT,e=this._MsgQueue.slice(0,t),this._MsgQueue.splice(0,t);e.length;){var n=e[0];this._delegate.getDispatcher().dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_MESSAGE_DISPATCH,!1,!1,n)),e.shift()}}}},t.prototype.onInit=function(){this.m_ReConnectCount=0,this.m_ReConnectMax=5,this.m_ReConnectTimeOut=1e4,this._curServerList=null},t.prototype.socketConnectSuccess=function(){this.m_ReConnectCount=0},t.prototype.closeService=function(){this.m_pTcpService&&(this.m_pTcpService.closeService(),this.m_pTcpService=null,this._curServerIdx=0,this.m_ReConnectCount=0,this._curServerList=null,this._delegate=null)},t.prototype.onReconnect=function(){this._curServerIdx++},t.prototype.onReconnectTimeOut=function(){},t.prototype.onReconnectFailure=function(){},t.prototype.setDelegate=function(e){this._delegate=null,null!=e&&(this._delegate=e)},t.prototype.getDelegate=function(){return this._delegate?this._delegate:null},t.prototype.getTcpService=function(){return this.m_pTcpService},t}();e.GateWayCtrl=t,__reflect(t.prototype,"managers.GateWayCtrl",["df.IConnectSocket","df.ISocketService"])}(managers||(managers={}));var Main=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(e){e.onUpdate=function(){var e=managers.FrameManager.getInstance();null!=e&&e.onUpdate&&e.onUpdate()}}),egret.lifecycle.onPause=function(){egret.ticker.pause();var e=managers.FrameManager.getInstance();null!=e.getRunningController()&&e.getRunningController().dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_ENTER_BACKGROUND))},egret.lifecycle.onResume=function(){egret.ticker.resume();var e=managers.FrameManager.getInstance();null!=e.getRunningController()&&e.getRunningController().dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_BECOME_ACTIVE))};var t=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",t),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return this.loadResource(),[2]})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,4,,5]),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,this.loadTheme()];case 2:return n.sent(),[4,RES.loadGroup("welcome",0)];case 3:return n.sent(),e=new controller.WelComeController,this.stage.addChild(e),this.stage.name="mainStage",managers.FrameManager.getInstance().m_MainStage=this.stage,[3,5];case 4:return t=n.sent(),console.error(t),[3,5];case 5:return[2]}})})},t.prototype.loadTheme=function(){var e=this;return new Promise(function(t,n){var i=new eui.Theme("resource/default.thm.json",e.stage);i.addEventListener(eui.UIEvent.COMPLETE,function(){t()},e)})},t}(eui.UILayer);__reflect(Main.prototype,"Main");var managers;!function(e){var t=function(){function e(){this._timerQueue=[]}return e.getInstance=function(){return null==this.m_sInstance&&(this.m_sInstance=new e,this.m_sInstance.init()),this.m_sInstance},e.prototype.init=function(){this.clean()},e.prototype.createTimer=function(e,t,n,i,r){void 0===t&&(t=1e3/60);for(var o=0;o<this._timerQueue.length;o++){var s=this._timerQueue[o];if(s.key==r)return console.log("队列中存在相同KEY的定时器"),!1}var a=new egret.Timer(t,n);a.addEventListener(egret.TimerEvent.TIMER,i,e),a.start();var c={target:e,key:r,func:i,timer:a};return this._timerQueue.push(c),!0},e.prototype.killTimer=function(e,t){for(var n=0;n<this._timerQueue.length;n++){var i=this._timerQueue[n];if(i.key==t){if(egret.assert(e==i.target),e!=i.target)return console.log("对象不匹配"),!1;var r=i.func,o=i.timer;o.removeEventListener(egret.TimerEvent.TIMER,r,e),o.stop(),o=null,this._timerQueue.splice(n,1);break}}return!0},e.prototype.clean=function(){this._timerQueue.forEach(function(e){var t=e.target,n=e.func,e=e.timer;e.removeEventListener(egret.TimerEvent.TIMER,n,t),e.stop(),e=null}),this._timerQueue=[]},e}();e.TimerCtrl=t,__reflect(t.prototype,"managers.TimerCtrl")}(managers||(managers={}));var models;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.once(egret.Event.REMOVED_FROM_STAGE,t.onExit,t),t}return __extends(t,e),t.prototype.onExit=function(){this.removeEventListener(egret.TouchEvent.TOUCH_END,this._touchHandler,this),this._touchHandler=null},t.createHead=function(e,n,i,r,o,s,a){return 0==e.dwCustomID?t.createSysHeadWithCorner(e,n,i,r,o,s,a):t.createThirdHeadWithCorner(e,n,i,r,o,s,a)},t.createSysHeadWithCorner=function(e,n,i,r,o,s,a){var c=new t;utils.setAnchorLeftTop(c),c.width=n,c.touchEnabled=!0,c.height=i,c.x=0,c.y=0;var _;0!=r&&0!=o&&(_=new egret.Shape,_.graphics.beginFill(0,1),_.graphics.drawRoundRect(0,0,c.width-r/2,c.height-o/2,r,o),_.graphics.endFill(),utils.setAnchorCenter(_),c.addChild(_),_.x=n/2,_.y=i/2);var l=e.cbGender,h=0;l==df.GENDER_MANKIND?h=e.wFaceID%10:l==df.GENDER_FEMALE&&(h=10+e.wFaceID%10);var u=10>h?"face_x_0"+h+"_png":"face_x_"+h+"_png",d=utils.createBitmapByName(u);return c.addChild(d),d.width=n,d.height=i,utils.setAnchorCenter(d),d.x=n/2,d.y=i/2,0!=r&&0!=o&&(d.mask=_),s&&a&&(c._touchHandler=a,c.addEventListener(egret.TouchEvent.TOUCH_END,a,c)),c},t.createSysHeadWithNormal=function(e,n,i,r,o,s){var a=new t;utils.setAnchorLeftTop(a),a.width=i,a.height=r,a.x=0,a.y=0;var c=utils.createBitmapByName("face_x_00_png");return a.addChild(c),c.touchEnabled=!0,c.width=i,c.height=r,utils.setAnchorCenter(c),c.x=i/2,c.y=r/2,o&&s&&c.addEventListener(egret.TouchEvent.ENDED,s,e),a},t.createThirdHeadWithCorner=function(e,n,i,r,o,s,a){return new t},t}(egret.Sprite);e.HeadSprite=t,__reflect(t.prototype,"models.HeadSprite")}(models||(models={}));var models;!function(e){var t=function(){function e(e,t){this.target=e,this.datas=t}return e}();e.CellData=t,__reflect(t.prototype,"models.CellData");var n=function(e){function t(){var t=e.call(this)||this;return t.skinName=skins.CommonListView,t.viewport=t.dataList,t}return __extends(t,e),t.prototype.initItemSkin=function(e){this.dataList.itemRendererSkinName=e},t.prototype.initItemRenderer=function(e){this.dataList.itemRenderer=e},t.prototype.bindData=function(e){var t=new eui.ArrayCollection(e);this.dataList.dataProvider=t},t}(eui.Scroller);e.ListView=n,__reflect(n.prototype,"models.ListView",["eui.UIComponent","egret.DisplayObject"])}(models||(models={}));var DebugPlatform=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var models;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t._noticeQueue=[],t._noticeIndex=0,t._isLoop=!1,t.m_OnePerformTime=8e3,t.once(egret.Event.REMOVED_FROM_STAGE,t.onExit,t),t}return __extends(t,e),t.createNotice=function(e,n,i,r,o,s,a){var c=new t;return c&&c.initNotice(e,n,i,r,o,s,a)?c:null},t.prototype.initNotice=function(e,t,n,i,r,o,s){if(0==t&&0==n)return!1;this.width=t,this.height=n,this._noticeQueue=i,this._isLoop=r;var a=utils.createBitmapByName(e);utils.setAnchorCenter(a),this.addChild(a),a.x=this.width/2,a.y=this.height/2,a.touchEnabled=!0;var c=new eui.Group;utils.setAnchorLeftTop(c),this.addChild(c),c.width=this.width-50,c.height=this.height,c.x=50,c.y=0;var _=new eui.Scroller;return _.enabled=!1,_.width=this.width-50,_.height=this.height,this.addChild(_),_.viewport=c,utils.setAnchorLeftMid(_),_.x=50,_.y=this.height/2,this._label=new eui.Label,this._label.text="欢迎您进入游戏家园,祝您游戏愉快!",this._label.textColor=16764269,this._label.size=18,this._label.lineSpacing=24,this._label.textAlign=egret.HorizontalAlign.JUSTIFY,c.addChild(this._label),utils.setAnchorLeftMid(this._label),0==o?(this._label.x=this.width,this._label.y=this.height/2):(this._label.x=0,this._label.y=-this.height),null!=s&&this.setNoticeIcon(s),this._noticeIndex=0,this.performNotice(o),!0},t.prototype.setNoticeIcon=function(e){var t=utils.createBitmapByName(e);utils.setAnchorRightMid(t),this.addChild(t),t.x=50,t.y=this.height/2},t.prototype.setPerformTime=function(e){this.m_OnePerformTime=e},t.prototype.setTouchHandler=function(e){this.touchEnabled=!0,null!=e&&this.addEventListener(egret.TouchEvent.TOUCH_END,e,this)},t.prototype.performNotice=function(e){var t=this;if(null!=this._label){var n=this._noticeQueue[this._noticeIndex];this._label.text=n;var i=0==e?this.width:0,r=0==e?this.height/2:-this.height;this._label.x=i,this._label.y=r;var o=0==e?-this._label.width:0,s=0==e?this.height/2:this.height,a=0==e?this.m_OnePerformTime:3e3;egret.Tween.get(this._label).to({x:o,y:s},a).call(function(){if(t._noticeIndex++,t._noticeIndex==t._noticeQueue.length){if(!t._isLoop)return;t._noticeIndex=0}t.performNotice(e)})}},t.prototype.insertNotice=function(e){this._noticeQueue.push(e)},t.prototype.setNoitceIndex=function(e){this._noticeIndex=e<this._noticeQueue.length?e:this._noticeIndex},t.prototype.onExit=function(){egret.Tween.removeTweens(this._label),this._noticeQueue.forEach(function(e){e=null}),this._noticeQueue=null,this._label=null},t}(egret.Sprite);e.RollNotice=t,__reflect(t.prototype,"models.RollNotice")}(models||(models={}));var models;!function(e){var t=function(){function e(e,t,n){this.wAgentLevel=0,this.dwServiceAddr=0,this.szServiceDomain="",this.wAgentLevel=e,this.dwServiceAddr=t,this.szServiceDomain=n}return e}();e.Agent=t,__reflect(t.prototype,"models.Agent");var n=function(){function e(e,t){this.wAgentID=0,this.wServicePort=0,this.wAgentID=e,this.wServicePort=t}return e}();e.AgentServer=n,__reflect(n.prototype,"models.AgentServer");var i=function(){function e(e){this.type=0,this.describe="",this.price=0,this.min=0,this.max=0,this.card=0,this.value=0,null!=e.type&&(this.type=e.type),null!=e.describe&&(this.describe=e.describe),null!=e.price&&(this.price=e.price),null!=e.min&&(this.min=e.min),null!=e.max&&(this.max=e.max),null!=e.roomCard&&(this.card=e.roomCard),null!=e.value&&(this.value=e.value)}return e}();__reflect(i.prototype,"ItemsSpcial");var r=function(){function e(){this.wPlayerCount=0,this.wOptionMask=0,this.wSuportPayType=0,this.cbOptionCount=0,this.lVideoIngot_User=0,this.lVideoRoomCard_User=0,this.lVideoIngot_Owner=0,this.lVideoRoomCard_Owner=0,this.lMinBaseScore=0,this.lMaxBaseScore=0,this.wPlayCount=[],this.dwPlayTime=[],this.lConsumeIngot=[],this.lRoomCard=[],this.lConsumeIngot_Owner=[],this.lRoomCard_Owner=[]
}return e}();e.Option=r,__reflect(r.prototype,"models.Option");var o=function(){function e(){this.wCount=0,this.name="",this.count=0,this.type=0,this.min=0,this.max=0,this.items=[]}return e.prototype.setItem=function(e){var t=new i(e);this.items.push(t)},e}();e.OptionSpecial=o,__reflect(o.prototype,"models.OptionSpecial");var s=function(){function e(){this.m_LogonList=[],this.m_AgentList={},this.m_ServerAgentList={},this.m_RoomList={},this.m_AccessList=[],this.m_MatchList={},this.m_Optionlist={},this.m_OptionSpecialList={},this.m_BattleList=[],this.m_BattleParamList=[],this._lUpdateTime=0,this.m_CurKindID=df.INVALID_WORD,this.m_LockedServerID=df.INVALID_WORD,this.m_CurServerID=df.INVALID_WORD,this.m_CurBattle=null}return e.prototype.UpdataRoomInfo=function(e){this.m_RoomList=e},e.prototype.UpdataMatchInfo=function(e){this.m_MatchList=e},e.prototype.GetGameRoomCount=function(e){if(e!=df.INVALID_WORD){var t=e?e:this.m_CurKindID;return t!=df.INVALID_WORD?this.m_RoomList[e].length:0}},e.prototype.GetRoomList=function(e){if(e!=df.INVALID_WORD){e?e:this.m_CurKindID;return null!=this.m_RoomList[e]?this.m_RoomList[e]:null}},e.prototype.GetRoomInfo=function(e,t){var n=0;n=0==e||null==e?this.m_CurServerID:e;var i=0;if(i=0==t||null==t?this.m_CurKindID:t,0!=n&&0!=i&&null!=this.GetRoomList(i))for(var r=this.GetRoomList(i),o=0;o<r.length;o++)if(r[o].wServerID==n)return r[o];return null},e.prototype.onFlushAgent=function(e){var t="";t=df.TEST_SERVER?"http://testservice.foxuc.com/GetAppService.ashx?action=GetLogonAgent":"http://service.foxuc.com/GetAppService.ashx?action=GetLogonAgent";var n="&StationID="+df.STATION_ID,i=[],r=function(t){console.log("请求成功");var n=JSON.parse(t.target.response);if(null==n||!n.Result)return null;if(n=n.Data,n&&n.list&&n.list.length>0)for(var r=0;r<n.list.length;r++){var o={id:"",addr:"",domain:"",port:0},s=n.list[r];o.id=s.AgentID,o.addr=s.ServiceAddr,o.domain=s.ServiceDomain.trim(),o.port=Number(s.ServicePort),i.push(o)}null!=e&&e(i)},o=function(e){return console.log("代理列表请求失败"),null};utils.HttpRequest.createHttpRequest(this,t,n,egret.HttpMethod.POST,r,o)},e.prototype.upDateAgentInfo=function(e,t){this.m_AgentList[e]=t},e.prototype.upDateRoomAgentInfo=function(e,t){this.m_ServerAgentList[e]=t},e.prototype.getAgent=function(e){return this.m_AgentList[e]},e.prototype.getServerAgent=function(e){var t=[];if(this.m_ServerAgentList[e].length>0)for(var n=0;n<this.m_ServerAgentList[e].length;n++){var i=this.getAgent(this.m_ServerAgentList[e][n].wAgentID);if(i){var r={dwServiceAddr:i.dwServiceAddr,szServiceDomain:i.szServiceDomain,wServicePort:this.m_ServerAgentList[e][n].wServicePort};t.push(r)}}return t},e.prototype.setAccessServerInfo=function(e){this.m_AccessList=e},e.prototype.getAccessServer=function(){return this.m_AccessList},e.prototype.setOptionList=function(e,t){null==this.m_Optionlist[e]&&(this.m_Optionlist[e]=[]),this.m_Optionlist[e].push(t)},e.prototype.getOptionList=function(){return this.m_Optionlist},e.prototype.setOptionSpecialList=function(e,t){null==this.m_OptionSpecialList[e]&&(this.m_OptionSpecialList[e]=[]),this.m_OptionSpecialList[e].push(t)},e.prototype.getOptionSpecialList=function(){return this.m_OptionSpecialList},e.prototype.resetServer=function(){this.m_LogonList=[],this.m_AgentList={},this.m_RoomList={},this.m_AccessList=[]},e}();e.ServerInfo=s,__reflect(s.prototype,"models.ServerInfo")}(models||(models={}));var battle;!function(e){var t=function(){function t(e){this.tableUserList=[],this.onInit(e)}return t.prototype.onInit=function(t){this.dwMappedNum=t.Pop_DWORD(),this.wFinishCount=t.Pop_WORD(),this.dwElapsedTime=t.Pop_DWORD(),this.wUserCount=t.Pop_WORD();for(var n=0;n<this.wUserCount;n++){var i=new e.BattleUserItem;i.onInit(t)}},t}();e.BattleParam=t,__reflect(t.prototype,"battle.BattleParam")}(battle||(battle={}));var battle;!function(e){var t=function(){function e(e){this.onInit(e)}return e.prototype.onInit=function(e){this.wTableID=e.Pop_WORD(),this.wServerID=e.Pop_WORD(),this.dwOwnerID=e.Pop_DWORD(),this.dwMappedNum=e.Pop_DWORD(),this.szPassword=e.Pop_UTF16(df.LEN_PASSWORD),this.dwGroupID=e.Pop_DWORD(),this.dwGroupCreaterID=e.Pop_DWORD(),this.wKindID=e.Pop_WORD(),this.wServerPort=e.Pop_WORD(),this.dwServerAddrDX=e.Pop_DWORD(),this.szServerDomain=e.Pop_UTF16(df.LEN_DOMAIN),this.dwCreateTime=e.Pop_DWORD(),this.wKindID1=e.Pop_WORD(),this.wPlayerCount=e.Pop_WORD(),this.cbSettleKind=e.Pop_Byte(),this.cbVideoMode=e.Pop_Byte(),this.cbForbidSameIP=e.Pop_Byte(),this.wPlayCount=e.Pop_WORD(),this.dwPlayTime=e.Pop_DWORD(),this.lBaseScore=e.Pop_SCORE(),this.lConsumeCount=e.Pop_SCORE(),this.wPayType=e.Pop_WORD(),this.cbCurrencyKind=e.Pop_Byte()},e}();e.BattleTableItem=t,__reflect(t.prototype,"battle.BattleTableItem")}(battle||(battle={}));var battle;!function(e){var t=function(){function e(){this.wFaceID=0,this.wChairID=0,this.dwUserID=0,this.dwGameID=0,this.dwCustomID=0,this.szNickName=""}return e.prototype.onInit=function(e){this.wFaceID=e.Pop_WORD(),this.wChairID=e.Pop_WORD(),this.dwUserID=e.Pop_DWORD(),this.dwGameID=e.Pop_DWORD(),this.dwCustomID=e.Pop_DWORD(),this.szNickName=e.Pop_UTF16(df.LEN_ACCOUNTS)},e.prototype.onInitWithData=function(e){this.wFaceID=e.wFaceID?e.wFaceID:0,this.wChairID=e.wChairID?e.wChairID:0,this.dwUserID=e.dwUserID?e.dwUserID:0,this.dwGameID=e.dwGameID?e.dwGameID:0,this.dwCustomID=e.dwCustomID?e.dwCustomID:0,this.szNickName=e.szNickName?e.szNickName:""},e}();e.BattleUserItem=t,__reflect(t.prototype,"battle.BattleUserItem")}(battle||(battle={}));var ThemeAdapter=function(){function e(){}return e.prototype.getTheme=function(e,t,n,i){function r(e){t.call(i,e)}function o(t){t.resItem.url==e&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),n.call(i))}var s=this;"undefined"!=typeof generateEUI?egret.callLater(function(){t.call(i,generateEUI)},this):"undefined"!=typeof generateEUI2?RES.getResByUrl("resource/gameEui.json",function(e,n){window.JSONParseClass.setData(e),egret.callLater(function(){t.call(i,generateEUI2)},s)},this,RES.ResourceItem.TYPE_JSON):(RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,o,null),RES.getResByUrl(e,r,this,RES.ResourceItem.TYPE_TEXT))},e}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var frame;!function(e){var t=function(){function e(e){this.BANK_TYPE_STORAGE=0,this.BANK_TYPE_DRAWOUTE=1,this._delegate=e,this._dispatcher=new egret.EventDispatcher,this.addEventListener()}return e.prototype.getDispatcher=function(){return this._dispatcher},e.prototype.addEventListener=function(){this._dispatcher.addEventListener(customEvent.CustomEvent.EVENT_CONNECT_COMPLETE,this.connectComplete,this),this._dispatcher.addEventListener(customEvent.CustomEvent.EVENT_MESSAGE_DISPATCH,this.onMessage,this)},e.prototype.removeEventListener=function(){this._dispatcher.removeEventListener(customEvent.CustomEvent.EVENT_CONNECT_COMPLETE,this.connectComplete,this),this._dispatcher.removeEventListener(customEvent.CustomEvent.EVENT_MESSAGE_DISPATCH,this.onMessage,this)},e.prototype.connectComplete=function(){this._delegate&&this._delegate.connectComplete&&this._delegate.connectComplete()},e.prototype.onMessage=function(e){var t=e.data,n=t.wMainCmd,i=t.wSubCmd;switch(n){case df.MDM_GP_BANK_OPERATE:(i==df.SUB_GP_DRAWOUT||i==df.SUB_GP_UPDATE||i==df.SUB_GP_STORAGE)&&this.onUserBankAccessResult(t);break;case df.MDM_GP_USER_SERVICE:i==df.SUB_GP_USER_WEALTH&&this.onUserWealth(t)}},e.prototype.onUserBankAccessResult=function(e){var t=e.cbBuffer.Pop_INT(),n=e.cbBuffer.Pop_SCORE(),i=e.cbBuffer.Pop_SCORE();0==t&&(managers.FrameManager.getInstance().m_GlobalUserItem.lUserScore=n,managers.FrameManager.getInstance().m_GlobalUserItem.lUserInsure=i,this._delegate&&this._delegate._viewFrame&&this._delegate._viewFrame.dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_SHOP_REFRESH)));var r=e.cbBuffer.Pop_UTF16(e.cbBuffer.getByteArray().bytesAvailable/2);0!=r.length&&managers.FrameManager.getInstance().showToast(r)},e.prototype.onUserWealth=function(e){var t=e.cbBuffer.Pop_Byte(),n=e.cbBuffer.Pop_SCORE(),i=e.cbBuffer.Pop_SCORE(),r=e.cbBuffer.Pop_SCORE(),o=e.cbBuffer.Pop_SCORE();n&&0!=(t&df.WEALTH_MASK_INGOT)&&(managers.FrameManager.getInstance().m_GlobalUserItem.lUserIngot=n),i&&0!=(t&df.WEALTH_MASK_MEDAL)&&(managers.FrameManager.getInstance().m_GlobalUserItem.lUserMedal=i),r&&0!=(t&df.WEALTH_MASK_SCORE)&&(managers.FrameManager.getInstance().m_GlobalUserItem.lUserScore=r),o&&0!=(t&df.WEALTH_MASK_ROOMCARD)&&(managers.FrameManager.getInstance().m_GlobalUserItem.lUserRoomCard=o),this._delegate&&this._delegate._viewFrame&&this._delegate._viewFrame.dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_SHOP_REFRESH))},e.prototype.sendSaveScore=function(e,t){var n=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);n.Append_DWORD(managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID),n.Append_SCORE(t),n.Append_Byte(this.BANK_TYPE_STORAGE),n.Append_DWORD(df.STATION_ID),n.Append_UTF16(managers.FrameManager.getInstance().m_GlobalUserItem.szInsurePass,df.LEN_PASSWORD),e.SendSocketData(df.MDM_GP_BANK_OPERATE,df.SUB_GP_STORAGE,n,n.getLength())},e.prototype.sendTakeScore=function(e,t){var n=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);n.Append_DWORD(managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID),n.Append_SCORE(t),n.Append_Byte(this.BANK_TYPE_DRAWOUTE),n.Append_DWORD(df.STATION_ID),n.Append_UTF16(managers.FrameManager.getInstance().m_GlobalUserItem.szInsurePass,df.LEN_PASSWORD),e.SendSocketData(df.MDM_GP_BANK_OPERATE,df.SUB_GP_DRAWOUT,n,n.getLength())},e}();e.BankFrame=t,__reflect(t.prototype,"frame.BankFrame")}(frame||(frame={}));var frame;!function(e){var t=100,n=101,i=102,r=105,o=106,s=function(){function e(e){this._delegate=e,this._dispatcher=new egret.EventDispatcher,this.addEventListener()}return e.prototype.getDispatcher=function(){return this._dispatcher},e.prototype.addEventListener=function(){this._dispatcher.addEventListener(customEvent.CustomEvent.EVENT_CONNECT_COMPLETE,this.connectComplete,this),this._dispatcher.addEventListener(customEvent.CustomEvent.EVENT_MESSAGE_DISPATCH,this.onMessage,this)},e.prototype.removeEventListener=function(){this._dispatcher.removeEventListener(customEvent.CustomEvent.EVENT_CONNECT_COMPLETE,this.connectComplete,this),this._dispatcher.removeEventListener(customEvent.CustomEvent.EVENT_MESSAGE_DISPATCH,this.onMessage,this)},e.prototype.onFlushWealth=function(){this._opreateCode=n,managers.TcpServiceCtrl.getInstance().onConnectPlaza()},e.prototype.onQueryTable=function(e,t,n){this._gameID=n,this._queryKind=e,this._queryid=t,this._opreateCode=i,this.onConnectBattle()},e.prototype.onNCreateTable=function(e,n,i,r,o){this._opreateCode=t,this._cbCurrencyKind=n,this._lCellScore=i,this._gameID=e,this._battleConfig=r,this._wPayType=o,this.onConnectBattle()},e.prototype.onDismissTable=function(e,t){this._opreateCode=r,this._gameID=e,this._dwMappedNum=t,this.onConnectBattle()},e.prototype.onQueryTableUserList=function(e,t){this._gameID=e,this._dwMappedNum=t,this._opreateCode=o,this.onConnectBattle()},e.prototype.connectComplete=function(){this._delegate&&this._delegate.connectComplete&&this._delegate.connectComplete(),this._opreateCode==i?this.sendQueryTable():this._opreateCode==t?this.sendCreateTable():this._opreateCode==n?this.sendFlushWealth():this._opreateCode==r?this.sendDismissTable():this._opreateCode==o&&this.sendQueryTableUser()},e.prototype.sendQueryTable=function(){var e=df.CMD_GA_QueryTable();e.wKindID=this._gameID?this._gameID:0,e.dwUserID=managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID,e.cbQueryKind=this._queryKind,e.dwQueryArgKey=this._queryid;var t=managers.TcpServiceCtrl.getInstance().getGateWayService().getTcpService(),n=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);n.Append_WORD(e.wKindID),n.Append_DWORD(e.dwUserID),n.Append_Byte(e.cbQueryKind),n.Append_DWORD(e.dwQueryArgKey),t.SendSocketData(df.MDM_GA_BATTLE_SERVICE,df.SUB_GA_QUERY_TABLE,n,n.getLength())},e.prototype.sendCreateTable=function(){var e=managers.TcpServiceCtrl.getInstance().getGateWayService().getTcpService(),t=df.CMD_GA_CreateTable();t.dwUserID=managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID,t.dwStationID=df.STATION_ID,t.szPassword=managers.FrameManager.getInstance().m_GlobalUserItem.szPassword,t.dwGroupID=0,t.dwGroupCreaterID=0,t.wKindID=this._gameID,t.wPayType=this._wPayType,t.wPlayerCount=this._battleConfig.wPlayerCount?this._battleConfig.wPlayerCount:0,t.cbSettleKind=this._battleConfig.cbSettleKind?this._battleConfig.cbSettleKind:0,t.cbVideoMode=this._battleConfig.cbVideoMode?this._battleConfig.cbVideoMode:0,t.cbCurrencyKind=this._cbCurrencyKind,t.cbForbidSameIP=this._battleConfig.cbForbidSameIP?this._battleConfig.cbForbidSameIP:0,t.wPlayCount=this._battleConfig.wPlayCount?this._battleConfig.wPlayCount:0,t.dwPlayTime=this._battleConfig.dwPlayTime?this._battleConfig.dwPlayTime:0,t.lBaseScore=this._lCellScore,t.szMachineID=managers.FrameManager.getInstance().m_GlobalUserItem.szMachine;var n=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);n.Append_DWORD(t.dwUserID),n.Append_DWORD(t.dwStationID),n.Append_UTF16(t.szPassword,df.LEN_PASSWORD),n.Append_DWORD(t.dwGroupID),n.Append_DWORD(t.dwGroupCreaterID),n.Append_WORD(t.wKindID),n.Append_WORD(t.wPayType),n.Append_WORD(t.wPlayerCount),n.Append_Byte(t.cbSettleKind),n.Append_Byte(t.cbVideoMode),n.Append_Byte(t.cbCurrencyKind),n.Append_Byte(t.cbForbidSameIP),n.Append_WORD(t.wPlayCount),n.Append_DWORD(t.dwPlayTime),n.Append_SCORE(t.lBaseScore),n.Append_UTF16(t.szMachineID,df.LEN_COMPUTER_ID),e.SendSocketData(df.MDM_GA_BATTLE_SERVICE,df.SUB_GA_CREATE_TABLE,n,n.getLength())},e.prototype.sendFlushWealth=function(){var e={dwUserID:0};e.dwUserID=managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID;var t=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);t.Append_DWORD(e.dwUserID);var n=managers.TcpServiceCtrl.getInstance().getTcpService();n.SendSocketData(df.MDM_GP_USER_SERVICE,df.SUB_GP_QUERY_WEALTH_LUA,t,t.getLength())},e.prototype.sendDismissTable=function(){var e=df.CMD_GA_DismissTable();e.wKindID=this._gameID,e.dwUserID=managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID,e.dwMappedNum=this._dwMappedNum,e.szPassword=managers.FrameManager.getInstance().m_GlobalUserItem.szPassword;var t=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);t.Append_WORD(e.wKindID),t.Append_DWORD(e.dwMappedNum),t.Append_DWORD(e.dwUserID),t.Append_UTF16(e.szPassword,df.LEN_PASSWORD);var n=managers.TcpServiceCtrl.getInstance().getGateWayService().getTcpService();n.SendSocketData(df.MDM_GA_BATTLE_SERVICE,df.SUB_GA_DISMISS_TABLE,t,t.getLength())},e.prototype.sendQueryTableUser=function(){var e=df.CMD_GA_GetTableUserList();e.wKindID=this._gameID,e.dwMappedNum=this._dwMappedNum;var t=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);t.Append_WORD(e.wKindID),t.Append_DWORD(e.dwMappedNum);var n=managers.TcpServiceCtrl.getInstance().getGateWayService().getTcpService();n.SendSocketData(df.MDM_GA_BATTLE_SERVICE,df.SUB_GA_GET_TABLE_USERLIST,t,t.getLength())},e.prototype.onMessage=function(e){var t=e.data,i=t.wMainCmd,r=t.wSubCmd;switch(i){case df.MDM_GP_USER_SERVICE:this._opreateCode==n&&r==df.SUB_GP_USER_WEALTH&&this.onUserWealth(t);break;case df.MDM_GA_BATTLE_SERVICE:this.onSubBattleService(t);break;case df.MDM_GA_LOGIC_SERVICE:this.onSubLogicService(t);break;case df.MDM_GA_GROUP_SERVICE:}},e.prototype.onUserWealth=function(e){var t=e.cbBuffer.Pop_Byte(),n=e.cbBuffer.Pop_SCORE(),i=e.cbBuffer.Pop_SCORE(),r=e.cbBuffer.Pop_SCORE(),o=e.cbBuffer.Pop_SCORE();n&&0!=(t&df.WEALTH_MASK_INGOT)&&(managers.FrameManager.getInstance().m_GlobalUserItem.lUserIngot=n),i&&0!=(t&df.WEALTH_MASK_MEDAL)&&(managers.FrameManager.getInstance().m_GlobalUserItem.lUserMedal=i),r&&0!=(t&df.WEALTH_MASK_SCORE)&&(managers.FrameManager.getInstance().m_GlobalUserItem.lUserScore=r),o&&0!=(t&df.WEALTH_MASK_ROOMCARD)&&(managers.FrameManager.getInstance().m_GlobalUserItem.lUserRoomCard=o),this._delegate&&this._delegate.dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_BATTLE_INFO_REFRESH))},e.prototype.onSubBattleService=function(e){var t=e.wSubCmd;switch(t){case df.SUB_GA_TABLE_ITEM:this.onSocketTableItem(e);break;case df.SUB_GA_TABLE_LIST:this.onSocketTableList(e);break;case df.SUB_GA_OPERATE_FAILED:this.onSocketOperateFailed(e);break;case df.SUB_GA_TABLE_PARAMLIST:this.onSocketTableParamList(e);break;case df.SUB_GA_TABLE_USERLIST:this.onSocketTableUserList(e);break;case df.SUB_GA_DISMISS_RESULT:this.onSocketDissMissResult(e)}},e.prototype.onSubLogicService=function(e){var t=e.wSubCmd;switch(t){case df.SUB_GA_WEALTH_UPDATE:this.onSocketWealthUpdate(e)}},e.prototype.onSocketOperateFailed=function(e){var t=(e.cbBuffer.Pop_WORD(),e.cbBuffer.Pop_UTF16((e.wLength-2)/2));console.log(t),managers.FrameManager.getInstance().dismissPopWait(),managers.FrameManager.getInstance().showToast(t),null!=this._delegate&&this._delegate.onCloseBattleService&&this._delegate.onCloseBattleService()},e.prototype.onSocketTableItem=function(e){var t=new battle.BattleTableItem(e.cbBuffer);managers.TcpServiceCtrl.getInstance().getServerInfo().m_CurBattle=t,null!=this._delegate&&this._delegate.onCloseBattleService&&this._delegate.onCloseBattleService(),managers.FrameManager.getInstance().dismissPopWait(),managers.FrameManager.getInstance().showPopWait("加载游戏中,请稍等",1e3,!1,this._delegate.onStartBattleGame)},e.prototype.onSocketTableParamList=function(e){for(managers.TcpServiceCtrl.getInstance().getServerInfo().m_BattleParamList=[];e.cbBuffer.getByteArray().bytesAvailable>=12;){var t=new battle.BattleParam(e.cbBuffer);managers.TcpServiceCtrl.getInstance().getServerInfo().m_BattleParamList.push(t)}this._delegate.onUpdateList(),null!=this._delegate&&this._delegate.onCloseBattleService&&this._delegate.onCloseBattleService()},e.prototype.onSocketTableList=function(e){var t=e.cbBuffer.Pop_WORD();managers.TcpServiceCtrl.getInstance().getServerInfo().m_BattleList=[];for(var n=0;t>n;n++){var i=new battle.BattleTableItem(e.cbBuffer);managers.TcpServiceCtrl.getInstance().getServerInfo().m_BattleList.push(i)}return 0==t?void(null!=this._delegate&&this._delegate.onCloseBattleService&&this._delegate.onCloseBattleService()):void this._delegate.onUpdateList()},e.prototype.onSocketTableUserList=function(e){var t=df.CMD_GA_TableUserList();t.dwMappedNum=e.cbBuffer.Pop_DWORD(),t.wUserCount=e.cbBuffer.Pop_WORD();for(var n=[],i=0;i<t.wUserCount;i++){var r=df.tagTableUserItem();r.wFaceID=e.cbBuffer.Pop_WORD(),r.wChairID=e.cbBuffer.Pop_WORD(),r.dwUserID=e.cbBuffer.Pop_DWORD(),r.dwGameID=e.cbBuffer.Pop_DWORD(),r.dwCustomID=e.cbBuffer.Pop_DWORD(),r.szNickName=e.cbBuffer.Pop_UTF16(df.LEN_ACCOUNTS),n.push(r)}var o=managers.TcpServiceCtrl.getInstance().getServerInfo().m_BattleParamList;if(null!=o&&o.length>0)for(var i=0;i<o.length;i++){var s=o[i];s.dwMappedNum==t.dwMappedNum&&(s.wUserCount=t.wUserCount,null==s.tableUserList[i]&&(s.tableUserList[i]=new battle.BattleUserItem),s.tableUserList[i].onInitWithData(n[i]))}null!=this._delegate&&this._delegate.onCloseBattleService&&this._delegate.onCloseBattleService()},e.prototype.onSocketDissMissResult=function(e){var t=df.CMD_GA_DismissResult();t.cbResultCode=e.cbBuffer.Pop_Byte(),t.szDescribeString=e.cbBuffer.Pop_UTF16(e.cbBuffer.getByteArray().bytesAvailable/2),this._delegate&&this._delegate.onDismissResult&&this._delegate.onDismissResult(t)},e.prototype.onSocketWealthUpdate=function(e){var t=e.cbBuffer.Pop_SCORE(),n=e.cbBuffer.Pop_SCORE();managers.FrameManager.getInstance().m_GlobalUserItem.lUserIngot=t,managers.FrameManager.getInstance().m_GlobalUserItem.lUserRoomCard=n,this._delegate&&this._delegate.dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_BATTLE_REFRESH))},e.prototype.onConnectBattle=function(){managers.TcpServiceCtrl.getInstance().createGateWayService().connectGateWay()},e.prototype.onHttpGetBattleInfo=function(e){},e.prototype.sendPing=function(){var e=new utils.ByteArray;if(e.position(df.Len_Tcp_Head),null!=managers.TcpServiceCtrl.getInstance().getGateWayService()){var t=managers.TcpServiceCtrl.getInstance().getGateWayService().getTcpService();t.SendSocketData(df.MDM_KN_COMMAND,df.SUB_KN_DETECT_SOCKET,e,e.getLength())}},e}();e.BattleFrame=s,__reflect(s.prototype,"frame.BattleFrame")}(frame||(frame={}));var frame;!function(e){var t=0,n=2,i=4,r=5,o=6,s=function(){function e(e){this._dismissState={},this._wKindID=df.INVALID_WORD,this._dwKindVersion=utils.PROCESS_VERSION(1,1,0,0),this._wTableCount=0,this._wChairCount=0,this._wServerType=0,this._dwServerRule=0,this._cbSegmentGame=0,this._dwGameBuglePrice=0,this._dwRoomBuglePrice=0,this._UserList={},this._TableUserList={},this._TableStatus={},this._BattleUserInfo={},this._wTableID=df.INVALID_TABLE,this._wChairID=df.INVALID_CHAIR,this._wVideoChair=df.INVALID_CHAIR,this._cbTableLock=0,this._cbGameStatus=0,this._cbAllowLookon=0,this._PlayCountEx=0,this._LogonType=t,this._delegate=e,this._dispatcher=new egret.EventDispatcher,this.addEventListener()}return e.prototype.setDelegate=function(e){this._delegate=e},e.prototype.setKindInfo=function(e,t,n){this._wKindID=e,this._dwKindVersion=t,this._gameModule=n},e.prototype.getDispatcher=function(){return this._dispatcher},e.prototype.isLookonMode=function(){},e.prototype.getServerType=function(){return this._wServerType},e.prototype.isGoldMode=function(){return this._wServerType&&0!=(this._wServerType&df.GAME_GENRE_GOLD)},e.prototype.isScoreMode=function(){return this._wServerType&&0!=(this._wServerType&df.GAME_GENRE_SCORE)},e.prototype.isMatchMode=function(){return this._wServerType&&0!=(this._wServerType&df.GAME_GENRE_MATCH)},e.prototype.isBattleMode=function(){return this.isVedioMode()?this._wServerType&&0!=(this._wServerType&df.TABLE_GENRE_CREATE):this._LogonType==n},e.prototype.isVedioMode=function(){return this._LogonType==o},e.prototype.getGameStatus=function(){return this._cbGameStatus},e.prototype.setGameStatus=function(e){this._cbGameStatus=e},e.prototype.getChairCount=function(){return this._wChairCount},e.prototype.getTableCount=function(){return this._wTableCount},e.prototype.getTableID=function(){return this._wTableID},e.prototype.getChairID=function(){return this._LogonType==o?this._wVideoChair-1:this._wChairID},e.prototype.addEventListener=function(){this._dispatcher.addEventListener(customEvent.CustomEvent.EVENT_CONNECT_COMPLETE,this.connectComplete,this),this._dispatcher.addEventListener(customEvent.CustomEvent.EVENT_MESSAGE_DISPATCH,this.onMessage,this)},e.prototype.removeEventListener=function(){this._dispatcher.removeEventListener(customEvent.CustomEvent.EVENT_CONNECT_COMPLETE,this.connectComplete,this),this._dispatcher.removeEventListener(customEvent.CustomEvent.EVENT_MESSAGE_DISPATCH,this.onMessage,this)},e.prototype.connectComplete=function(){if(this._delegate&&this._delegate.connectComplete&&this._delegate.connectComplete(),this._LogonType!=r){var e=new df.CMD_GR_LogonByMobile;e.wGameID=this._wKindID,e.dwPlazaVersion=df.PLAZA_VERSION,e.dwProcessVersion=this._dwKindVersion,e.cbDeviceType=df.DEVICE_TYPE,e.wBehaviorFlags=this._LogonType==t?4354:258,e.wPageTableCount=1,e.dwUserStationID=managers.FrameManager.getInstance().m_GlobalUserItem.dwStationID,e.dwPlazaStationID=df.STATION_ID,e.dwUserID=managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID,e.szPasspublic=managers.FrameManager.getInstance().m_GlobalUserItem.szPassword,e.szServerPasswdf="",e.szMachineID=managers.FrameManager.getInstance().m_GlobalUserItem.szMachine,e.dGlobalPosLng=0,e.dGlobalPosLat=0,e.dwMatchID=0,e.lMatchNo=0,this.sendLogonRoom(e)}},e.prototype.getCurActiveTcp=function(){return managers.TcpServiceCtrl.getInstance().getTcpService()},e.prototype.sendData=function(e,t,n){null!=this.getCurActiveTcp()&&managers.TcpServiceCtrl.getInstance().getTcpService().SendSocketData(e,t,n,n.getLength())},e.prototype.onMessage=function(e){var t=e.data,n=t.wMainCmd;switch(n){case df.MDM_GR_LOGON:this.onSocketLogonEvent(t);break;case df.MDM_GR_CONFIG:this.onSocketConfigEvent(t);break;case df.MDM_GR_USER:this.onSocketUserEvent(t);break;case df.MDM_GR_STATUS:break;case df.MDM_GR_MATCH:break;case df.MDM_GF_FRAME:this.onSocketFrameEvent(t);break;case df.MDM_GF_GAME:null!=this._delegate&&this._delegate.onGameMessage?this._delegate.onGameMessage(t):console.log("游戏协议未实现");break;case df.MDM_CM_SYSTEM:this.onSocketCMSystemMessage(t)}},e.prototype.onSocketLogonEvent=function(e){var t=e.wSubCmd;switch(t){case df.SUB_GR_LOGON_FINISH:this.onSubLogonFinish(e);break;case df.SUB_GR_LOGON_SUCCESS:this.onSubLogonSuccess(e);break;case df.SUB_GR_LOGON_FAILURE:var n=new df.CMD_GR_LogonFailure(e);managers.TcpServiceCtrl.getInstance().getServerInfo().m_LockedServerID=n.wLockServerID,managers.FrameManager.getInstance().showToast(n.szDescribeString);break;case df.SUB_GR_UPDATE_NOTIFY:new df.CMD_GR_UpdateNotify(e);managers.FrameManager.getInstance().showToast("版本不匹配")}},e.prototype.onSubLogonSuccess=function(e){new df.CMD_GR_LogonSuccess(e)},e.prototype.onSubLogonFinish=function(e){managers.TcpServiceCtrl.getInstance().getServerInfo().m_LockedServerID=df.INVALID_WORD,this._wTableID!=df.INVALID_TABLE?this.onEnterTable():this.onEnterRoom()},e.prototype.onSocketConfigEvent=function(e){var t=e.wSubCmd;switch(t){case df.SUB_GR_CONFIG_SERVER:var n=new df.CMD_GR_ConfigServer(e);this._wTableCount=n.wTableCount,this._wChairCount=n.wChairCount,this._wServerType=n.wServerType,this._dwServerRule=n.dwServerRule,this._cbSegmentGame=n.cbSegmentGame,this._dwGameBuglePrice=n.dwGameBuglePrice,this._dwRoomBuglePrice=n.dwRoomBuglePrice;break;case df.SUB_GR_CONFIG_FINISH:}},e.prototype.onSocketUserEvent=function(e){var t=e.wSubCmd;switch(t){case df.SUB_GR_USER_ENTER:this.onSocketUserEnter(e);break;case df.SUB_GR_USER_STATUS:this.onSocketUserStatus(e);break;case df.SUB_GR_REQUEST_FAILURE:this.onSocketReQuestFailure(e)}},e.prototype.onSocketUserEnter=function(e){var t=new models.UserItem;t.dwGameID=e.cbBuffer.Pop_DWORD(),t.dwUserID=e.cbBuffer.Pop_DWORD();var n=t.dwUserID==managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID,i=managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID;if(null==this._UserList[i]);else if(1==n)return;if(t.wFaceID=e.cbBuffer.Pop_WORD(),t.dwCustomID=e.cbBuffer.Pop_DWORD(),t.cbGender=e.cbBuffer.Pop_Byte(),t.cbMemberOrder=e.cbBuffer.Pop_Byte(),t.wTableID=e.cbBuffer.Pop_WORD(),t.wChairID=e.cbBuffer.Pop_WORD(),t.cbUserStatus=e.cbBuffer.Pop_Byte(),t.cbUserStatus==df.US_LOOKON&&n)return void managers.FrameManager.getInstance().showToast("该房间不支持旁观模式");t.lScore=e.cbBuffer.Pop_SCORE(),t.lGrade=e.cbBuffer.Pop_SCORE(),t.dwWinCount=e.cbBuffer.Pop_DWORD(),t.dwLostCount=e.cbBuffer.Pop_DWORD(),t.dwDrawCount=e.cbBuffer.Pop_DWORD(),t.dwFleeCount=e.cbBuffer.Pop_DWORD(),t.dwExperience=e.cbBuffer.Pop_DWORD(),t.dwGlobalPosLng=e.cbBuffer.Pop_SCORE(),t.dwGlobalPosLat=e.cbBuffer.Pop_SCORE();for(var r=0,o=0;e.cbBuffer.getByteArray().bytesAvailable>0;)r=e.cbBuffer.Pop_WORD(),o=e.cbBuffer.Pop_WORD(),o==df.DTP_GR_USER_ACCOUNTS&&(t.szNickName=e.cbBuffer.Pop_UTF16(r/2));var s=this._UserList[t.dwUserID];if(null!=s?(s.dwGameID=t.dwGameID,s.lScore=t.lGrade,s.lGrade=t.lGrade,s.wFaceID=t.wFaceID,s.dwCustomID=t.dwCustomID,s.cbGender=t.cbGender,s.cbMemberOrder=t.cbMemberOrder,s.wTableID=t.wTableID,s.wChairID=t.wChairID,s.cbUserStatus=t.cbUserStatus,s.dwWinCount=t.dwWinCount,s.dwLostCount=t.dwLostCount,s.dwDrawCount=t.dwDrawCount,s.dwFleeCount=t.dwFleeCount,s.dwExperience=t.dwExperience,s.szNickName=t.szNickName):(t.lScore=t.lGrade,this._UserList[t.dwUserID]=t),t.dwUserID==managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID&&(this._wTableID=t.wTableID,this._wChairID=t.wChairID),t.wTableID!=df.INVALID_TABLE&&this.onUpDataTableUser(t.wTableID,t.wChairID,t),this._UserList[managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID]&&this._wTableID!=df.INVALID_TABLE&&t.wTableID==this._wTableID&&null!=this._delegate){var a={table:t.wTableID,chair:t.wChairID,user:t};console.log("GameFrame------【用户进入】------",t.szNickName),this._delegate.dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_USER_ENTER,!1,!1,a))}},e.prototype.onSocketUserStatus=function(e){var t=e.cbBuffer.Pop_DWORD(),n={};n.wTableID=e.cbBuffer.Pop_WORD(),n.wChairID=e.cbBuffer.Pop_WORD(),n.cbUserStatus=e.cbBuffer.Pop_Byte();var i=t==managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID,r=this.getMeUserItem();if(i){if(null==r)return;this._wTableID=n.wTableID,this._wChairID=n.wChairID}var o=this._UserList[t];if(null==o){if(n.cbUserStatus==df.US_LOOKON)return;return void(this._wTableID!=df.INVALID_TABLE&&n.wTableID==this._wTableID&&(o=new models.UserItem,o.szNickName="游戏玩家",o.dwUserID=t,o.cbUserStatus=n.cbUserStatus,o.wTableID=n.wTableID,o.wChairID=n.wChairID,this._UserList[t]=o,this.queryUserInfo(n.wTableID,n.wChairID)))}o.cbUserStatus!=df.US_LOOKON&&n.cbUserStatus==df.US_LOOKON&&(n.cbUserStatus=df.US_FREE,n.wTableID=df.INVALID_TABLE,n.wChairID=df.INVALID_CHAIR);var s={};if(s.wTableID=o.wTableID,s.wChairID=o.wChairID,s.cbUserStatus=o.cbUserStatus,o.cbUserStatus=n.cbUserStatus,o.wTableID=n.wTableID,o.wChairID=n.wChairID,n.cbUserStatus==df.US_FREE&&s.cbUserStatus>df.US_FREE&&this.isMatchMode())return void(i&&(this._wTableID=s.wTableID,this._wChairID=s.wChairID));if(s.wTableID!=df.INVALID_TABLE&&(s.wTableID!=n.wTableID||s.wChairID!=n.wChairID)&&this.onUpDataTableUser(s.wTableID,s.wChairID,null),n.wTableID!=df.INVALID_TABLE&&this.onUpDataTableUser(n.wTableID,n.wChairID,o),1==i){if(n.cbUserStatus==df.US_NULL)console.log("用户状态: 离开"),this.onExitRoom();else if(n.cbUserStatus==df.US_FREE&&s.cbUserStatus>df.US_FREE)console.log("用户状态: 起立"),this.onExitTable();else if(n.cbUserStatus>df.US_FREE&&s.cbUserStatus<df.US_SIT)console.log("用户状态: 坐下"),this.onEnterTable();else if(console.log("用户状态"),null!=this._delegate){var a={user:o,newstatus:n,oldstatus:s};console.log("GameFrame------【用户状态】------",o.szNickName),this._delegate.dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_USER_STATUS,!1,!1,a))}}else{if(null!=this._delegate){var a={user:o,newstatus:n,oldstatus:s};console.log("GameFrame------【用户状态】------",o.szNickName),this._delegate.dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_USER_STATUS,!1,!1,a))}(o.cbUserStatus==df.US_NULL||o.cbUserStatus==df.US_LOOKON)&&this.onRemoveUser(t)}},e.prototype.onSocketFrameEvent=function(e){var t=e.wSubCmd;switch(t){case df.SUB_GF_GAME_STATUS:this._cbGameStatus=e.cbBuffer.Pop_Byte(),this._cbAllowLookon=e.cbBuffer.Pop_Byte();break;case df.SUB_GF_GAME_SCENE:null!=this._delegate&&this._delegate.onGameScene?(managers.TcpServiceCtrl.getInstance().m_bReConnect&&this._delegate.onResetEngine(),this._delegate.onGameScene(this._cbGameStatus,e)):console.log("游戏场景未实现")}},e.prototype.onSocketCMSystemMessage=function(e){var t="",n=0;if(e.wSubCmd==df.SUB_CM_SYSTEM_MESSAGE){n=e.cbBuffer.Pop_WORD();e.cbBuffer.Pop_WORD(),e.cbBuffer.Pop_WORD();t=e.cbBuffer.Pop_UTF16(e.cbBuffer.getByteArray().bytesAvailable/2)}else if(e.wSubCmd==df.SUB_CM_ACTION_MESSAGE){n=e.cbBuffer.Pop_WORD();e.cbBuffer.Pop_WORD(),e.cbBuffer.Pop_INT();t=e.cbBuffer.Pop_UTF16(e.cbBuffer.getByteArray().bytesAvailable/2)}var i=n&df.SMT_CLOSE_ROOM,r=n&df.SMT_CLOSE_GAME,o=n&df.SMT_CLOSE_LINK,s=0!=i||0!=r||0!=o;this.onSystemMessage(s,n,t)},e.prototype.onSystemMessage=function(e,t,n){var i=this;void 0===n&&(n=""),console.log("system msg bClose:",e),console.log("system msg wType:",t),console.log("system msg message:",n);var r=null;n.length>0&&(1==e&&1==managers.FrameManager.getInstance().isGameController()&&(r=function(){i.onExitRoom()}),managers.FrameManager.getInstance().showDailog(e?0:1,n,r))},e.prototype.onSocketReQuestFailure=function(e){var t=new df.CMD_GR_RequestFailure(e);console.log(t.szDescribeString);var n=this.getMeUserItem();(null==n||n.cbUserStatus<df.US_SIT)&&this.onExitRoom(t.szDescribeString)},e.prototype.onLogonMatch=function(e){},e.prototype.onLogonRoom=function(){console.log("普通房连接");var e=managers.TcpServiceCtrl.getInstance().getServerInfo().GetRoomInfo();
if(null==e)return void console.log("未查到当前房间信息");for(var r,o=0,s=managers.TcpServiceCtrl.getInstance().getGameListInfo()._Info,a=0;a<s.length;a++)if(Number(s[a].id)==managers.TcpServiceCtrl.getInstance().getServerInfo().m_CurKindID){o=Number(s[a].version),r=s[a].module;break}0!=o&&null!=r&&""!=r&&(this.setKindInfo(managers.TcpServiceCtrl.getInstance().getServerInfo().m_CurKindID,o,r),0!=(e.wServerType&df.TABLE_GENRE_DISTRIBUTE)?this._LogonType=i:0!=(e.wServerType&df.TABLE_GENRE_CREATE)?this._LogonType=n:this._LogonType=t,managers.TcpServiceCtrl.getInstance().createSocketService(e.szServerDomain,e.wServerPort,4))},e.prototype.onLogonBattleRoom=function(e){},e.prototype.onEnterTable=function(){managers.TcpServiceCtrl.getInstance()._isAllowDispatch=!1,managers.FrameManager.getInstance().replaceScene(new controller.GameController(this._gameModule),!0),this.sendGameOption(),null!=this._delegate&&this._delegate.onEnterTable&&this._delegate.onEnterTable()},e.prototype.onEnterRoom=function(){if(this._LogonType==n){var e=managers.TcpServiceCtrl.getInstance().getServerInfo().m_CurBattle;this.sitDown(e.wTableID,255,e.szPassword)}else this._LogonType==i?this.queryDistributeMode():this._LogonType==r},e.prototype.onFlushAgent=function(){},e.prototype.sitDown=function(e,t,n){void 0===n&&(n="");var i=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);i.Append_WORD(e),i.Append_WORD(t),i.Append_UTF16(n,df.LEN_PASSWORD),this.sendData(df.MDM_GR_USER,df.SUB_GR_USER_SITDOWN,i)},e.prototype.queryDistributeMode=function(){this.sitDown(df.INVALID_TABLE,df.INVALID_CHAIR)},e.prototype.queryUserInfoID=function(e,t){var n=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);n.Append_DWORD(e),n.Append_WORD(t),this.sendData(df.MDM_GR_USER,df.SUB_GR_USER_INFO_REQ,n)},e.prototype.queryUserInfo=function(e,t){var n=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);n.Append_WORD(e),n.Append_WORD(t),this.sendData(df.MDM_GR_USER,df.SUB_GR_USER_CHAIR_INFO_REQ,n)},e.prototype.onChangeDesk=function(){var e=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);this.sendData(df.MDM_GR_USER,df.SUB_GR_USER_CHAIR_REQ,e)},e.prototype.onStandUp=function(e){var t=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);t.Append_WORD(this.getTableID()),t.Append_WORD(this.getChairID()),t.Append_Byte(e?1:0),this.sendData(df.MDM_GR_USER,df.SUB_GR_USER_STANDUP,t)},e.prototype.onUserReady=function(){var e=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);this.sendData(df.MDM_GF_FRAME,df.SUB_GF_USER_READY,e)},e.prototype.sendLogonRoom=function(e){var t=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);t.Append_WORD(e.wGameID),t.Append_DWORD(e.dwPlazaVersion),t.Append_DWORD(e.dwProcessVersion),t.Append_Byte(e.cbDeviceType),t.Append_WORD(e.wBehaviorFlags),t.Append_WORD(e.wPageTableCount),t.Append_DWORD(e.dwUserStationID),t.Append_DWORD(e.dwPlazaStationID),t.Append_DWORD(e.dwUserID),t.Append_UTF16(e.szPasspublic,df.LEN_PASSWORD),t.Append_UTF16(e.szServerPasswdf,df.LEN_PASSWORD),t.Append_UTF16(e.szMachineID,df.LEN_MACHINE_SERIAL),t.Append_DOUBLE(e.dGlobalPosLng),t.Append_DOUBLE(e.dGlobalPosLat),t.Append_DWORD(e.dwMatchID),t.Append_SCORE(e.lMatchNo),this.sendData(df.MDM_GR_LOGON,df.SUB_GR_LOGON_MOBILE,t)},e.prototype.sendGameOption=function(){var e=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);e.Append_Byte(0),e.Append_DWORD(df.PLAZA_VERSION),e.Append_DWORD(this._dwKindVersion),this.sendData(df.MDM_GF_FRAME,df.SUB_GF_GAME_OPTION,e)},e.prototype.sendTableDismiss=function(e){},e.prototype.sendVoteDissmiss=function(){},e.prototype.sendBallotDismiss=function(e){},e.prototype.sendGameChat=function(e,t){},e.prototype.sendPing=function(){var e=new utils.ByteArray;e.position(df.Len_Tcp_Head),this.sendData(df.MDM_KN_COMMAND,df.SUB_KN_DETECT_SOCKET,e)},e.prototype.onExitRoom=function(e){this.isMatchMode()||this.isBattleMode()||this.isVedioMode()||(managers.FrameManager.getInstance().dismissPopWait(),managers.TcpServiceCtrl.getInstance().closeService(),managers.FrameManager.getInstance().replaceScene(new controller.ClientController,!0))},e.prototype.onExitTable=function(){this._delegate&&this._delegate.onExitTable&&1==this._delegate.onExitTable()||this._LogonType!=i&&this.onExitRoom()},e.prototype.onUpDataTableUser=function(e,t,n){if(null==this._TableUserList[e]&&(this._TableUserList[e]=[]),this._TableUserList[e].length>0)for(var i=0;i<this._TableUserList[e].length;i++){var r=this._TableUserList[e][i];if(r==t){this._TableUserList[e].splice(i,1);break}}null!=n&&this._TableUserList[e].push({chair:t,userid:n.dwUserID})},e.prototype.getMeUserItem=function(){return this.isVedioMode()?void 0:this._UserList[managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID]},e.prototype.getTableUserItem=function(e,t){if(this.isVedioMode());else{var n=e==df.INVALID_TABLE?this._wTableID:e,i=0;if(null!=this._TableUserList[n])for(var r=0;r<this._TableUserList[n].length;r++){var o=this._TableUserList[n];if(null==o)return null;egret.assert(null!=o.chair),t==o.chair&&(i=o.userid)}if(0!=i)return this._UserList[i]}return null},e.prototype.onRemoveUser=function(e){this._UserList[e]=null},e}();e.GameFrame=s,__reflect(s.prototype,"frame.GameFrame")}(frame||(frame={}));var frame;!function(e){var t=4,n=5,i=function(){function e(e){this._operateCode=0,this._reLoadKind=0,this._agentID=0,this._viewFrame=e,this._dispatcher=new egret.EventDispatcher,this.addEventListener()}return e.prototype.getDispatcher=function(){return this._dispatcher},e.prototype.addEventListener=function(){this._dispatcher.addEventListener(customEvent.CustomEvent.EVENT_CONNECT_COMPLETE,this.connectComplete,this),this._dispatcher.addEventListener(customEvent.CustomEvent.EVENT_MESSAGE_DISPATCH,this.onMessage,this)},e.prototype.removeEventListener=function(){this._dispatcher.removeEventListener(customEvent.CustomEvent.EVENT_CONNECT_COMPLETE,this.connectComplete,this),this._dispatcher.removeEventListener(customEvent.CustomEvent.EVENT_MESSAGE_DISPATCH,this.onMessage,this)},e.prototype.onReLoadRoomList=function(e){this._reLoadKind=e,this._operateCode=t,this.onConnectPlaza()},e.prototype.onQueryServerAgent=function(e){this._agentID=e,this._operateCode=n,this.onConnectPlaza()},e.prototype.onConnectPlaza=function(){managers.TcpServiceCtrl.getInstance().onConnectPlaza()},e.prototype.connectComplete=function(){this._viewFrame&&this._viewFrame.connectComplete&&this._viewFrame.connectComplete(),this._operateCode==n&&this.sendReLoadAgent()},e.prototype.onMessage=function(e){var t=e.data,n=t.wMainCmd;switch(n){case df.MDM_MB_LOGON:return this.onMessageLogon(t);case df.MDM_MB_SERVER_LIST:return this.onMessageServerList(t);default:egret.assert(!1,"未知消息")}},e.prototype.onMessageLogon=function(e){switch(e.wSubCmd){case df.SUB_MB_LOGON_SUCCESS:return this.onSubLogonSuccess(e);case df.SUB_MB_LOGON_FAILURE:return this.onSubLogonFailure(e)}},e.prototype.onSubLogonSuccess=function(e){var t=df.CMD_MB_LogonSuccess();t.wFaceID=e.cbBuffer.Pop_WORD(),t.cbGender=e.cbBuffer.Pop_Byte(),t.dwCustomID=e.cbBuffer.Pop_DWORD(),t.dwUserID=e.cbBuffer.Pop_DWORD(),t.dwGameID=e.cbBuffer.Pop_DWORD(),t.dwStationID=e.cbBuffer.Pop_DWORD(),t.dwExperience=e.cbBuffer.Pop_DWORD(),t.dwLoveLiness=e.cbBuffer.Pop_DWORD(),t.szNickName=e.cbBuffer.Pop_UTF16(df.LEN_ACCOUNTS),t.szAccounts=e.cbBuffer.Pop_UTF16(df.LEN_ACCOUNTS),t.szLogonPass=e.cbBuffer.Pop_UTF16(df.LEN_PASSWORD),t.szInsurePass=e.cbBuffer.Pop_UTF16(df.LEN_PASSWORD),t.lUserIngot=e.cbBuffer.Pop_LONGLONG(),t.lUserMedal=e.cbBuffer.Pop_LONGLONG(),t.lUserScore=e.cbBuffer.Pop_LONGLONG(),t.lUserInsure=e.cbBuffer.Pop_LONGLONG(),t.cbMemberOrder=e.cbBuffer.Pop_Byte(),t.MemberOverDate=df.SYSTEMTIME(e.cbBuffer),t.wLockServerID=e.cbBuffer.Pop_WORD();var n=new models.UserData(t);n.nPlatform=this._viewFrame.getPloatForm(),managers.FrameManager.getInstance().m_GlobalUserItem=n,managers.FrameManager.getInstance().m_GlobalUserItem.szPassword=utils.MD5.MD5_HEX(this._viewFrame.getPassWord());var i={account:"",password:"",isAuto:0};i.account=t.szAccounts,i.password=egret.Base64Util.encode(utils.StringUtils.string2array(this._viewFrame.getPassWord())),i.isAuto=this._viewFrame.getAutoLogon(),localStorage.setItem("Logon",JSON.stringify(i))},e.prototype.onSubLogonFailure=function(e){var t=df.CMD_MB_LogonFailure();t.lResultCode=e.cbBuffer.Pop_INT(),t.szDescribeString=e.cbBuffer.Pop_UTF16(e.cbBuffer.getByteArray().readAvailable/2),managers.FrameManager.getInstance().showToast(t.szDescribeString),managers.FrameManager.getInstance().dismissPopWait(),managers.TcpServiceCtrl.getInstance().closeService()},e.prototype.onMessageServerList=function(e){switch(e.wSubCmd){case df.SUB_MB_LIST_KIND:return this.onSubMessageListKind(e);case df.MDM_MB_SERVER_LIST:return this.onSubMessgeServerList(e);case df.SUB_MB_LIST_MATCH:return this.onSubMessageMatchList(e);case df.SUB_MB_GAME_OPTION:return this.onSubMessageGameOpion(e);case df.SUB_MB_CREATE_OPTION:return this.onSubMessageCreateOpion(e);case df.SUB_MB_LIST_LOGON:return this.onSubMessageLogonList(e);case df.SUB_MB_LIST_AGENT:return this.onMessageListAgent(e);case df.SUB_MB_SERVER_AGENT:return this.onSubMessageServerAgent(e);case df.SUB_MB_LIST_ACCESS:return this.onSubMessageAccess(e);case df.SUB_MB_LIST_FINISH:var t=new controller.ClientController;return managers.FrameManager.getInstance().replaceScene(t,!0),managers.FrameManager.getInstance().dismissPopWait(),void managers.TcpServiceCtrl.getInstance().closeService();case df.SUB_MB_SERVER_FINISH:var t=new controller.ClientController;return managers.FrameManager.getInstance().replaceScene(t,!0),managers.FrameManager.getInstance().dismissPopWait(),void managers.TcpServiceCtrl.getInstance().closeService();default:egret.assert(!1,"未知消息")}},e.prototype.onSubMessageListKind=function(e){var t=e.wLength;if(t%df.LEN_GAME_LIST_ITEM==0){var n=managers.TcpServiceCtrl.getInstance().getGameListInfo();if(null!=n){n._Info.forEach(function(e){e.show=!1});for(var i=t/df.LEN_GAME_LIST_ITEM,r=0;i>r;r++){var o=e.cbBuffer.Pop_WORD();console.log("wKindID is :"+o);var s=e.cbBuffer.Pop_WORD();s=e.cbBuffer.Pop_WORD();var a=e.cbBuffer.Pop_WORD();s=e.cbBuffer.Pop_WORD(),s=e.cbBuffer.Pop_WORD();var c=e.cbBuffer.Pop_UTF16(32);c=e.cbBuffer.Pop_UTF16(32),e.cbBuffer.Pop_WORD();var _=n.isGameSupport(o,!0);if(_&&"-1"!=_.id&&(_.show=!0,_.sort=a-n.getGameFavourite(o)),df.StationSupport&&df.STATION_GAME){df.STATION_ID;df.STATION_GAME[df.STATION_ID]&&df.STATION_GAME[df.STATION_ID][o]&&(_.sort=_.sort-1e4)}}}}},e.prototype.onSubMessgeServerList=function(e){var t=e.wLength;if(t%df.LEN_GAME_SERVER_ITEM==0){for(var n=t/df.LEN_GAME_SERVER_ITEM,i={},r=[],o=0;n>o;o++){var s=new models.GameServerItem(e.cbBuffer);if(i[s.wKindID]){i[s.wKindID].push(s);var a=function(e,t){return e.wSortID>t.wSortID?1:e.wSortID==t.wSortID?0:-1};i[s.wKindID].sort(a)}else i[s.wKindID]=[],i[s.wKindID].push(s);0!=(s.wServerType&df.GAME_GENRE_MATCH)&&r.push(s)}managers.TcpServiceCtrl.getInstance().getServerInfo()._lUpdateTime=egret.getTimer(),managers.TcpServiceCtrl.getInstance().getServerInfo().UpdataRoomInfo(i),managers.TcpServiceCtrl.getInstance().getServerInfo().UpdataMatchInfo(r)}},e.prototype.onSubMessageMatchList=function(e){},e.prototype.onSubMessageServerAgent=function(e){for(var t=e.wLength;e.cbBuffer.getPosition()<t;){var n=e.cbBuffer.Pop_WORD(),i=e.cbBuffer.Pop_WORD();if(0!=i){for(var r=[],o=0;i>o;o++){var s=e.cbBuffer.Pop_WORD(),a=e.cbBuffer.Pop_WORD();r.push(new models.AgentServer(s,a))}managers.TcpServiceCtrl.getInstance().getServerInfo().upDateRoomAgentInfo(n,r)}}},e.prototype.onMessageListAgent=function(e){var t=e.wLength;if(t%134==0)for(var n=t/134,i=0;n>i;i++){var r=e.cbBuffer.Pop_WORD(),o=e.cbBuffer.Pop_WORD(),s=e.cbBuffer.Pop_DWORD(),a=e.cbBuffer.Pop_UTF16(63),c=managers.TcpServiceCtrl.getInstance().getServerInfo();c.upDateAgentInfo(r,new models.Agent(o,s,a))}},e.prototype.onSubMessageAccess=function(e){var t=managers.TcpServiceCtrl.getInstance().getServerInfo();t.setAccessServerInfo([]);var n=e.wLength;if(n%df.LEN_ACCESS_ITEM==0){for(var i=n/df.LEN_ACCESS_ITEM,r=[],o=0;i>o;o++){var s=df.tagAccessItem(e.cbBuffer);r.push(s)}t.setAccessServerInfo(r)}},e.prototype.onSubMessageGameOpion=function(e){for(var t=e.wLength;e.cbBuffer.getPosition()<t;){var n=e.cbBuffer.Pop_WORD(),i=e.cbBuffer.Pop_WORD(),r=e.cbBuffer.Pop_UTF16(i/2);if(5>i)return;var o=JSON.parse(r);null==o&&console.log("Json error");var s=[],a=o.Count;o=o.Data;for(var c=0;a>c;c++)for(var _="type"+(c+1),l=o[_],h=l.Count?l.Count:l.TypeCount,u=l.Content?l.Content:l.TypeContent,d=new models.OptionSpecial,p=0;h>p;p++){d.wCount=a,d.name=u[p].Name?u[p].Name:u[p].ItemName,d.count=u[p].Count?u[p].Count:u[p].ItemCount,d.type=u[p].Type?u[p].Type:u[p].ItemType,d.min=u[p].Min?u[p].Min:0,d.max=u[p].Max?u[p].Max:0;for(var m=u[p].Items,g=0;g<m.length;g++)if(d.type>=df.OPTION_TYPE_INPUT)if(d.setItem({type:u[p].Type}),d.type==df.OPTION_TYPE_INPUT){var f={describe:"",price:0,min:0,max:0};f.describe=m[g].Describe?m[g].Describe:m[g].Des,f.price=m[g].Price?m[g].Price:0,f.min=m[g].Min?m[g].Min:0,f.max=m[g].Max?m[g].Max:0,d.setItem({type:u[p].Type})}else{var f={describe:"",price:0,roomCard:0,value:0};f.describe=m[g].Describe?m[g].Describe:m[g].Des,f.price=m[g].Price?m[g].Price:0,f.roomCard=m[g].roomCard?m[g].roomCard:0,f.value=m[g].Value,d.setItem(f)}else{var f={describe:"",price:0,roomCard:0,value:0};f.describe=m[g].Describe?m[g].Describe:m[g].Des,f.price=m[g].Price?m[g].Price:0,f.roomCard=m[g].roomCard?m[g].roomCard:0,f.value=m[g].Value,d.setItem(f)}s.push(d)}var E=managers.TcpServiceCtrl.getInstance().getServerInfo();E.setOptionSpecialList(n,s)}},e.prototype.onSubMessageCreateOpion=function(e){var t=e.wLength;if(t%df.LEN_CREATE_OPTION_ITEM==0)for(var n=t/df.LEN_CREATE_OPTION_ITEM,i=0;n>i;i++){var r=new models.Option,o=e.cbBuffer.Pop_WORD();r.wPlayerCount=e.cbBuffer.Pop_WORD(),r.wOptionMask=e.cbBuffer.Pop_WORD(),r.wSuportPayType=e.cbBuffer.Pop_WORD(),r.cbOptionCount=e.cbBuffer.Pop_Byte(),r.lVideoIngot_User=e.cbBuffer.Pop_DWORD(),r.lVideoRoomCard_User=e.cbBuffer.Pop_DWORD(),r.lVideoIngot_Owner=e.cbBuffer.Pop_DWORD(),r.lVideoRoomCard_Owner=e.cbBuffer.Pop_DWORD(),r.lMinBaseScore=e.cbBuffer.Pop_LONGLONG(),r.lMaxBaseScore=e.cbBuffer.Pop_LONGLONG();for(var s,a,c,_,l,h,u=0;5>u;u++)s=e.cbBuffer.Pop_WORD(),a=e.cbBuffer.Pop_DWORD(),c=e.cbBuffer.Pop_DWORD(),l=e.cbBuffer.Pop_DWORD(),_=e.cbBuffer.Pop_DWORD(),h=e.cbBuffer.Pop_DWORD(),r.wPlayCount.push(r.cbOptionCount>u?s:0),r.dwPlayTime.push(r.cbOptionCount>u?a:0),r.lConsumeIngot.push(r.cbOptionCount>u?c:0),r.lRoomCard.push(r.cbOptionCount>u?_:0),r.lConsumeIngot_Owner.push(r.cbOptionCount>u?l:0),r.lRoomCard_Owner.push(r.cbOptionCount>u?h:0);var d=managers.TcpServiceCtrl.getInstance().getServerInfo();d.setOptionList(o,r)}},e.prototype.onSubMessageLogonList=function(e){for(var t=[],n=e.wLength,i=n/132,r=1;i>r;r++){var o=e.cbBuffer.Pop_WORD(),s=e.cbBuffer.Pop_DWORD(),a=e.cbBuffer.Pop_UTF16(63),c={port:o,addr:s,domain:a};t.push(c)}},e.prototype.sendRegister=function(e,t){var n=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);n.Append_WORD(t.wModuleID),n.Append_WORD(t.wMarketID),n.Append_Byte(t.cbDeviceType),n.Append_DWORD(t.dwAppVersion),n.Append_DWORD(t.dwPlazaVersion),n.Append_DWORD(t.dwStationID),n.Append_UTF16(t.szLogonPass,df.LEN_PASSWORD),n.Append_WORD(t.wFaceID),n.Append_Byte(t.cbGender),n.Append_UTF16(t.szAccounts,df.LEN_ACCOUNTS),n.Append_UTF16(t.szNickName,df.LEN_ACCOUNTS),n.Append_UTF16(t.szMachineID,df.LEN_MACHINE_SERIAL),n.Append_UTF16(t.szMobilePhone,df.LEN_MOBILE_PHONE),e.SendSocketData(df.MDM_MB_LOGON,df.SUB_MB_REGISTER_ACCOUNTS_LUA,n,n.getLength())},e.prototype.sendLogon=function(e,t){var n=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);n.Append_WORD(t.wModuleID),n.Append_WORD(t.wMarketID),n.Append_Byte(t.cbDeviceType),n.Append_DWORD(t.dwAppVersion),n.Append_DWORD(t.dwPlazaVersion),n.Append_DWORD(t.dwStationID),n.Append_DWORD(t.dwMappedNum),n.Append_UTF16(t.szPassword,df.LEN_MD5),n.Append_UTF16(t.szAccounts,df.LEN_ACCOUNTS),n.Append_UTF16(t.szMachineID,df.LEN_COMPUTER_ID),n.Append_UTF16(t.szMobilePhone,df.LEN_MOBILE_PHONE),e.SendSocketData(df.MDM_MB_LOGON,df.SUB_MB_LOGON_ACCOUNTS_LUA,n,n.getLength())},e.prototype.sendReLoadAgent=function(){var e=utils.Memory.newLitteEndianByteArray(df.Len_Tcp_Head);e.Append_WORD(this._agentID),managers.TcpServiceCtrl.getInstance().getTcpService().SendSocketData(df.MDM_MB_SERVER_LIST,df.SUB_MB_GET_SERVER_AGENT,e,e.getLength())},e.prototype.sendPing=function(e){var t=new utils.ByteArray;t.position(df.Len_Tcp_Head),e.SendSocketData(df.MDM_KN_COMMAND,df.SUB_KN_DETECT_SOCKET,t,t.getLength())},e}();e.LogonFrame=i,__reflect(i.prototype,"frame.LogonFrame")}(frame||(frame={}));var cache;!function(e){var t=function(){function e(){this._cache={}}return e.prototype.saveCache=function(e,t){this._cache[e]=t},e.prototype.updateCache=function(e,t){},e.prototype.removeCacheByKey=function(e){},e.prototype.getCacheByKey=function(e){return this._cache[e]},e}();e.localization=t,__reflect(t.prototype,"cache.localization")}(cache||(cache={}));var models;!function(e){var t=function(){function e(e){this.wKindID=0,this.wSortID=0,this.wServerID=0,this.wServerPort=0,this.wServerType=0,this.dwMaxPlayer=0,this.dwOnLineCount=0,this.dwServerAddrDX=0,this.szServerName="",this.szServerDomain="",this.lCellScore=0,this.lMinEnterScore=0,this.lMaxEnterScore=0,this.onInit(e)}return e.prototype.isYueZhan=function(){var e=this.wServerType&df.TABLE_GENRE_CREATE;return 0!=e?!0:!1},e.prototype.onInit=function(e){this.wKindID=e.Pop_WORD(),this.wSortID=e.Pop_WORD(),this.wServerID=e.Pop_WORD(),this.wServerPort=e.Pop_WORD(),this.wServerType=e.Pop_WORD(),this.dwMaxPlayer=e.Pop_DWORD(),this.dwOnLineCount=e.Pop_DWORD(),this.dwServerAddrDX=e.Pop_DWORD(),this.szServerName=e.Pop_UTF16(df.LEN_SERVER),this.szServerDomain=e.Pop_UTF16(63),this.lCellScore=e.Pop_SCORE(),this.lMinEnterScore=e.Pop_SCORE(),this.lMaxEnterScore=e.Pop_SCORE(),df.SPECIAL_LOG&&(console.log("wKindID:"+this.wKindID),console.log("wSortID:"+this.wSortID),console.log("wServerID:"+this.wServerID),console.log("wServerPort:"+this.wServerPort),console.log("wServerType:"+this.wServerType),console.log("dwMaxPlayer:"+this.dwMaxPlayer),console.log("dwOnLineCount:"+this.dwOnLineCount),console.log("dwServerAddrDX:"+this.dwServerAddrDX),console.log("szServerName: "+this.szServerName),console.log("szServerDomain: "+this.szServerDomain),console.log("lCellScore:"+this.lCellScore),console.log("lMinEnterScore:"+this.lMinEnterScore),console.log("lMaxEnterScore:"+this.lMaxEnterScore))},e}();e.GameServerItem=t,__reflect(t.prototype,"models.GameServerItem")}(models||(models={}));var models;!function(e){var t=function(e){function t(t,n,i,r){var o=e.call(this)||this;return o.m_eMode=0,o.m_OkFunc=null,o.m_CancellFunc=null,o.m_Content="",o.initDialog(t,n,i,r),o}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.name="Dialog",this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},t.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.Dialog;var t=e.getChildByName("text");t.text=this.m_Content;var n=e.getChildByName("agree");n.addEventListener(egret.TouchEvent.TOUCH_END,this.onButtonClick,this);var i=e.getChildByName("cancell");i.addEventListener(egret.TouchEvent.TOUCH_END,this.onButtonClick,this),0==this.m_eMode&&(utils.setAnchorCenter(n),n.x=this.width/2,i.visible=!1)},t.prototype.initDialog=function(e,t,n,i){this.m_eMode=e,this.m_OkFunc=n,this.m_CancellFunc=i?i:null,this.m_Content=t},t.prototype.onButtonClick=function(e){var t=e.target;switch(t.name){case"agree":this.onSure();break;case"cancell":this.onCancell()}},t.prototype.onSure=function(){null!=this.m_OkFunc&&this.m_OkFunc(),this.parent.removeChild(this)},t.prototype.onCancell=function(){null!=this.m_CancellFunc&&this.m_CancellFunc(),this.parent.removeChild(this)},t.prototype.onExit=function(e){},t}(eui.UILayer);e.Dialog=t,__reflect(t.prototype,"models.Dialog",["df.IDialog"])}(models||(models={}));var models;!function(e){var t=function(e){function t(t,n,i,r,o){void 0===i&&(i=!1);var s=e.call(this)||this;return s._timeOutHandler=null,s._closeHandler=null,s._delayHandler=0,s._isClose=!1,s._dot=[".","..","..."],s._dotIdx=0,s._curTime=egret.getTimer(),s._content=t,s._timeOut=n,s._isClose=i,s._timeOutHandler=r,s._closeHandler=o,s}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.name="PopWait",this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},t.prototype.onInitLayer=function(){var e=this,t=new egret.Shape;t.graphics.beginFill(0,1),t.graphics.drawRect(0,0,this.width,this.height),t.graphics.endFill(),t.alpha=.5,utils.setAnchorCenter(t),this.addChild(t),t.x=this.width/2,t.y=this.height/2;var n=utils.createBitmapByName("wait_ani_frame_png");utils.setAnchorCenter(n),this.addChild(n),n.x=this.width/2,n.y=this.height/2;var i=utils.createBitmapByName("wait_ani_round_png");utils.setAnchorCenter(i),i.name="circle",this.addChild(i),i.x=this.width/2,i.y=this.height/2;var r=new eui.Label;if(r.text=this._content,r.textColor=16777215,r.size=24,r.lineSpacing=10,r.textAlign=egret.HorizontalAlign.JUSTIFY,this.addChild(r),utils.setAnchorCenter(r),r.x=667,r.y=500,this._aniLabel=new eui.Label,this._aniLabel.text=this._dot[this._dotIdx],this._aniLabel.textColor=16777215,this._aniLabel.size=24,this._aniLabel.multiline=!1,this._aniLabel.textAlign=egret.HorizontalAlign.JUSTIFY,this.addChild(this._aniLabel),utils.setAnchorLeftMid(this._aniLabel),this._aniLabel.x=r.x+r.width/2,this._aniLabel.y=r.y,this._isClose){var o=new eui.Button;this.addChild(o),o.x=750,o.y=270,o.skinName=skins.GeneralButton,o.addEventListener(egret.TouchEvent.TOUCH_BEGIN,function(){e.onClose()},this)}managers.TimerCtrl.getInstance().killTimer(this,"PopWait"),managers.TimerCtrl.getInstance().createTimer(this,1e3/60,0,this.popWaitAnimation,"PopWait"),this._delayHandler=setTimeout(function(){e.onTimeOut()},this._timeOut)},t.prototype.onExit=function(){0!=this._delayHandler&&(clearTimeout(this._delayHandler),this._delayHandler=0),managers.TimerCtrl.getInstance().killTimer(this,"PopWait"),this._timeOutHandler=null,this._closeHandler=null},t.prototype.onTimeOut=function(){this._delayHandler=0,null!=this._timeOutHandler&&this._timeOutHandler(),managers.FrameManager.getInstance().dismissPopWait(),managers.TimerCtrl.getInstance().killTimer(this,"PopWait")},t.prototype.onClose=function(){managers.FrameManager.getInstance().dismissPopWait(),managers.TimerCtrl.getInstance().killTimer(this,"PopWait"),0!=this._delayHandler&&clearTimeout(this._delayHandler),this._delayHandler=0,null!=this._closeHandler&&this._closeHandler()},t.prototype.popWaitAnimation=function(e){var t=egret.getTimer();t-this._curTime>=500&&(this._dotIdx=(this._dotIdx+1)%3,this._aniLabel.text=this._dot[this._dotIdx],this._curTime=egret.getTimer());var n=this.getChildByName("circle");n.rotation+=6,n.rotation>360&&(n.rotation-=360)},t}(eui.UILayer);e.PopWait=t,__reflect(t.prototype,"models.PopWait",["df.IPopWait"])}(models||(models={}));var models;!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.name="Toast",this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this)},t.prototype.onInitLayer=function(){this.touchEnabled=!1;var e=utils.createBitmapByName("game_horn_bg_png");utils.setAnchorMidBottom(e),e.name="toast",this.addChild(e),e.x=667,e.y=680},t.prototype.show=function(e,t){var n=this;if(e.length){var i=new eui.Label;i.text=e,i.textColor=16711680,i.size=22,i.lineSpacing=24,i.textAlign=egret.HorizontalAlign.JUSTIFY,this.addChild(i),utils.setAnchorMidBottom(i),i.x=667,i.y=660,egret.Tween.get(this).wait(1e3).to({x:0,y:1400},t?t:500).call(function(){managers.FrameManager.getInstance().m_MainStage.removeChild(n)})}},t}(eui.UILayer);e.Toast=t,__reflect(t.prototype,"models.Toast")}(models||(models={}));var models;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n._finishHandler=t,n}return __extends(t,e),t.prototype.finishLoading=function(e){var t=this;void 0===e&&(e=1),this.value+e<this.maximum?(this.value=this.value+e,egret.Tween.get(this).wait(20).call(function(){t.finishLoading(e)})):this.value+e>=this.maximum&&(this.value=this.maximum,this._finishHandler&&this._finishHandler())},t}(eui.ProgressBar);e.Loading=t,__reflect(t.prototype,"models.Loading")}(models||(models={}));var models;!function(e){var t=function(){function e(e){this.wLockServerID=65535,this.nPlatform=df.ACCOUNT_TYPE_SELF,this.szHeadUrl="",this.szHeadUrlEx="",this.dwGameID=0,this.dwUserID=0,this.dwExperience=0,this.dwLoveLiness=0,this.szPassword="",this.szLogonPass="",this.szMachine="",this.szMobilePhone="",this.szAccounts="",this.szNickName="",this.szInsurePass="",this.szDynamicPass="",this.lUserScore=0,this.lUserInsure=0,this.lUserIngot=0,this.lUserMedal=0,this.lUserRoomCard=0,this.cbGender=0,this.cbMemberOrder=0,this.wFaceID=0,this.dwCustomID=0,this.dwStationID=0,this.dwPayRight=0,this.MemberOverDate={wYea:0,wMonth:0,wDayOfWeek:0,wDay:0,wHour:0,wMinute:0,wSecond:0,wMilliseconds:0},this.bAutoLogon=!1,this.bHasLogon=!1,this.wFaceID=e.wFaceID,this.cbGender=e.cbGender,this.dwCustomID=e.dwCustomID,this.dwUserID=e.dwUserID,this.dwGameID=e.dwGameID,this.dwStationID=e.dwStationID,this.dwExperience=e.dwExperience,this.dwLoveLiness=e.dwLoveLiness,this.szNickName=e.szNickName,this.szAccounts=e.szAccounts,this.szLogonPass=e.szLogonPass,this.szInsurePass=e.szInsurePass,this.lUserIngot=e.lUserIngot,this.lUserMedal=e.lUserMedal,this.lUserScore=e.lUserScore,this.lUserInsure=e.lUserInsure,this.cbMemberOrder=e.cbMemberOrder,this.MemberOverDate=e.MemberOverDate,this.wLockServerID=e.wLockServerID}return e}();e.UserData=t,__reflect(t.prototype,"models.UserData")}(models||(models={}));var models;!function(e){var t=function(){function e(e){this.dwGameID=0,this.dwUserID=0,this.wFaceID=0,this.dwCustomID=0,this.cbGender=df.GENDER_MANKIND,this.cbMemberOrder=0,this.wTableID=df.INVALID_TABLE,this.wChairID=df.INVALID_CHAIR,this.cbUserStatus=0,this.lScore=0,this.lGrade=0,this.dwWinCount=0,this.dwLostCount=0,this.dwDrawCount=0,this.dwFleeCount=0,this.dwExperience=0,this.szNickName="",this.dwGlobalPosLng=0,this.dwGlobalPosLat=0,null!=e&&(this.dwGameID=e.dwGameID,this.dwUserID=e.dwUserID,this.wFaceID=e.wFaceID,this.dwCustomID=e.dwCustomID,this.cbGender=e.cbGender,this.cbMemberOrder=e.cbMemberOrder,this.wTableID=e.wTableID,this.wChairID=e.wChairID,this.cbUserStatus=e.cbUserStatus,this.lScore=e.lScore,this.lGrade=e.lGrade,this.dwWinCount=e.dwWinCount,this.dwLostCount=e.dwLostCount,this.dwDrawCount=e.dwDrawCount,this.dwFleeCount=e.dwFleeCount,this.dwExperience=e.dwExperience,this.szNickName=e.szNickName,this.dwGlobalPosLng=e.dwGlobalPosLng,this.dwGlobalPosLat=e.dwGlobalPosLat)}return e}();e.UserItem=t,__reflect(t.prototype,"models.UserItem")}(models||(models={}));var network;!function(e){e.DK_MAPPED=1,e.DK_ENCRYPT=2,e.VER_SOCKET=1;var t=2774181210,n=[112,47,64,95,68,142,110,69,126,171,44,31,180,172,157,145,13,54,155,11,212,196,57,116,191,35,22,20,6,235,4,62,18,92,139,188,97,99,246,165,225,101,216,245,90,7,240,19,242,32,107,74,36,89,137,100,215,66,106,94,61,10,119,224,128,39,184,197,140,14,250,138,213,41,86,87,108,83,103,65,232,0,26,206,134,131,176,34,40,77,63,38,70,79,111,43,114,58,241,141,151,149,73,132,229,227,121,143,81,16,168,130,198,221,255,252,228,207,179,9,93,234,156,52,249,23,159,218,135,248,21,5,60,211,164,133,46,251,238,71,59,239,55,127,147,175,105,12,113,49,222,33,117,160,170,186,124,56,2,183,129,1,253,231,29,204,205,189,27,122,42,173,102,190,85,51,3,219,136,178,30,78,185,230,194,247,203,125,201,98,195,166,220,167,80,181,75,148,192,146,76,17,91,120,217,177,237,25,233,161,28,182,50,153,163,118,158,123,109,154,48,214,169,37,199,174,150,53,208,187,210,200,162,8,243,209,115,244,72,45,144,202,226,88,193,24,82,254,223,104,152,84,236,96,67,15],i=[81,161,158,176,30,131,28,45,233,119,61,19,147,16,69,255,109,201,32,47,27,130,26,125,245,207,82,168,210,164,180,11,49,151,87,25,52,223,91,65,88,73,170,95,10,239,136,1,220,149,212,175,123,227,17,142,157,22,97,140,132,60,31,90,2,79,57,254,4,7,92,139,238,102,51,196,200,89,181,93,194,108,246,77,251,174,74,75,243,53,44,202,33,120,59,3,253,36,189,37,55,41,172,78,249,146,58,50,76,218,6,94,0,148,96,236,23,152,215,62,203,106,169,217,156,187,8,143,64,160,111,85,103,135,84,128,178,54,71,34,68,99,5,107,240,15,199,144,197,101,226,100,250,213,219,18,122,14,216,126,153,209,232,214,134,39,191,193,110,222,154,9,13,171,225,145,86,205,179,118,12,195,211,159,66,182,155,229,35,167,173,24,198,244,184,190,21,67,112,224,231,188,241,186,165,166,83,117,228,235,230,133,20,72,221,56,42,204,127,177,192,113,150,248,63,40,242,105,116,104,183,163,80,208,121,29,252,206,138,141,46,98,48,234,237,43,38,185,129,124,70,137,115,162,247,114],r=function(){function r(){this.m_dwSendXorKey=305419896,this.m_dwRecvXorKey=305419896,this.m_dwSendPacketCount=0,this.m_dwRecvPacketCount=0,this.m_cbSendRound=0,this.m_cbRecvRound=0,this.m_cbDataFlag=e.DK_MAPPED}return r.prototype.setDataFlag=function(e){this.m_cbDataFlag=e},r.prototype.getDataFlag=function(){return this.m_cbDataFlag},r.prototype.SeedRandMap=function(e){var t=utils.MathUtils.getUnsignedDWORD(e);return utils.MathUtils.getUnsignedWORD((t=241103*t+2533101)>>16)},r.prototype.MapSendByte=function(e,t){var i=utils.MathUtils.getUnsignedByte(e+utils.MathUtils.getUnsignedByte(t)),r=utils.MathUtils.getUnsignedByte(n[i]);return r},r.prototype.MapRecvByte=function(e,t){var n=i[utils.MathUtils.getUnsignedByte(e)]-t;return n=utils.MathUtils.getUnsignedByte(n)},r.prototype.EncryptBuffer=function(n,i){var r=i,o=0;do{n.position(0);var s=r-df.Len_Tcp_Info,a=0;s%4!=0&&(a=4-s%4,utils.Memory.memset(n,0,a,df.Len_Tcp_Info+s));for(var c=df.Len_Tcp_Info;r>c;c++)o+=n.getByteArray().bytes[c],o=utils.MathUtils.getUnsignedByte(o),n.getByteArray().bytes[c]=this.MapSendByte(n.getByteArray().bytes[c],this.m_cbSendRound),this.m_cbSendRound+=3,this.m_cbSendRound=utils.MathUtils.getUnsignedByte(this.m_cbSendRound);o=~o+1,o=utils.MathUtils.getUnsignedByte(o);var _=this.m_dwSendXorKey;if(0==this.m_dwSendPacketCount){_=Math.floor(65535*Math.random()),_=this.SeedRandMap(utils.MathUtils.getUnsignedWORD(_));var l=this.SeedRandMap(utils.MathUtils.getUnsignedWORD(_>>16));_|=utils.MathUtils.getUnsignedDWORD(l)<<16,_=utils.MathUtils.getUnsignedDWORD(_),_^=t,_=utils.MathUtils.getUnsignedDWORD(_),this.m_dwSendXorKey=_,this.m_dwRecvXorKey=_}n.position(df.Len_Tcp_Info);for(var h=df.Len_Tcp_Info,u=0,d=0,p=(s+a)/4,c=0;p>c;c++){n.position(h),u=n.Pop_DWORD(),h+=4,u^=_,u=utils.MathUtils.getUnsignedDWORD(u);var m=new utils.ByteArray;m.Append_INT(u),utils.Memory.CopyMemory(n,m,4,h-4,0),m.position(0),d=m.Pop_WORD(),_=this.SeedRandMap(d),d=m.Pop_WORD(),_|=this.SeedRandMap(d)<<16,_=utils.MathUtils.getUnsignedDWORD(_),_^=t,_=utils.MathUtils.getUnsignedDWORD(_)}if(0==this.m_dwSendPacketCount){var g=new utils.ByteArray;utils.Memory.CopyMemory(g,n,df.Len_Tcp_Head,0,0);var f=new utils.ByteArray;f.Append_DWORD(this.m_dwSendXorKey),utils.Memory.CopyMemory(f,n,i-df.Len_Tcp_Head,4,df.Len_Tcp_Head),n.clear(),utils.Memory.CopyMemory(n,g,df.Len_Tcp_Head,0,0),utils.Memory.CopyMemory(n,f,f.getLength(),df.Len_Tcp_Head,0),g=null,f=null,r+=4}this.m_dwSendPacketCount++,this.m_dwSendXorKey=_}while(!1);return[e.VER_SOCKET,o,r]},r.prototype.CrevasseBuffer=function(e,n,i){void 0===i&&(i=0);var r=n;do{var o=0;r%4!=0&&(o=4-r%4,utils.Memory.memset(e,0,o,r));for(var s=df.Len_Tcp_Info,a=df.Len_Tcp_Info,c=0,_=0,l=this.m_dwRecvXorKey,h=(r+o-4)/4,u=0;h>u;u++){if(u==h-1&&o>0){var d=new utils.ByteArray;d.Append_DWORD(this.m_dwRecvXorKey),d.position(0);var i=4-o;utils.Memory.CopyMemory(e,d,o,r,i)}e.position(a),_=e.Pop_WORD(),a+=2,l=this.SeedRandMap(utils.MathUtils.getUnsignedWORD(_)),_=e.Pop_WORD(),a+=2,l|=this.SeedRandMap(_)<<16,l=utils.MathUtils.getUnsignedDWORD(l),l^=t,l=utils.MathUtils.getUnsignedDWORD(l),e.position(s),c=e.Pop_DWORD(),s+=4,c^=this.m_dwRecvXorKey,c=utils.MathUtils.getUnsignedDWORD(c);
var p=new utils.ByteArray;p.Append_DWORD(c),utils.Memory.CopyMemory(e,p,4,s-4,0),this.m_dwRecvXorKey=l}e.position(1);for(var m=utils.MathUtils.getUnsignedByte(e.Pop_Byte()),u=df.Len_Tcp_Info;r>u;u++)e.getByteArray().bytes[u]=this.MapRecvByte(e.getByteArray().bytes[u],this.m_cbRecvRound),this.m_cbRecvRound+=3,this.m_cbRecvRound=utils.MathUtils.getUnsignedByte(this.m_cbRecvRound),m+=e.getByteArray().bytes[u],m=utils.MathUtils.getUnsignedByte(m);if(egret.assert(0==m),0!=m)return!1}while(!1);return!0},r}();e.Crypt=r,__reflect(r.prototype,"network.Crypt")}(network||(network={}));var network;!function(e){var t=function(){function e(e,t,n,i){this.wMainCmd=e,this.wSubCmd=t,this.wLength=n,this.cbBuffer=new utils.ByteArray,utils.Memory.CopyMemory(this.cbBuffer,i,n,0,df.Len_Tcp_Head)}return e}();e.Message=t,__reflect(t.prototype,"network.Message")}(network||(network={}));var network;!function(e){var t=function(e){function t(t,n){var i=e.call(this)||this;return i.m_eSocketStatus=0,i.type=egret.WebSocket.TYPE_BINARY,i.addEventListener(egret.ProgressEvent.SOCKET_DATA,i.onReceiveMessage,i),i.addEventListener(egret.Event.CONNECT,i.onSocketConnect,i),i.addEventListener(egret.Event.CLOSE,i.onSocketClose,i),i.addEventListener(egret.IOErrorEvent.IO_ERROR,i.onSocketError,i),i}return __extends(t,e),t.prototype.connect=function(t,n){this.setConnectStatus(1),e.prototype.connect.call(this,t,n)},t.prototype.connectByUrl=function(t){var n="ws://"+t;e.prototype.connectByUrl.call(this,n)},t.prototype.close=function(){e.prototype.close.call(this),this.setServiceModule(null)},t.prototype.setServiceModule=function(e){this.m_SocketServiceModule&&(this.m_SocketServiceModule=null),this.m_SocketServiceModule=e},t.prototype.onSocketConnect=function(e){this.m_SocketServiceModule&&this.m_SocketServiceModule.socketConnectSuccess()},t.prototype.onReceiveMessage=function(e){if(this.m_SocketServiceModule){var t=e.target,n=new utils.ByteArray;t.readBytes(n.getByteArray(),0),console.log("接收长度======="+n.getLength()),this.m_SocketServiceModule.pushRecvBuffer(n)}},t.prototype.onSocketClose=function(e){this.m_SocketServiceModule&&this.m_SocketServiceModule.getServiceModule()&&this.m_SocketServiceModule.getServiceModule().closeService(),this.setConnectStatus(0),console.log("socket close")},t.prototype.onSocketError=function(e){this.m_SocketServiceModule&&(this.isConnected()?this.m_SocketServiceModule.onReconnect():this.m_SocketServiceModule.onReconnect()),this.setConnectStatus(3),console.log("socket error")},t.prototype.setConnectStatus=function(e){this.m_eSocketStatus=e},t.prototype.isConnected=function(){return 2==this.m_eSocketStatus},t}(egret.WebSocket);e.TcpSocket=t,__reflect(t.prototype,"network.TcpSocket")}(network||(network={}));var service;!function(e){var t=5e3,n=function(){function e(e,t){this.m_wRecvSize=0,this.m_CurTime=0,this.m_RecvQueue=[],this.m_ServiceModule=e,this.HANDLE=t,this.m_Socket=new network.TcpSocket,this.m_Socket.setServiceModule(this),this.m_EventDispatcher=new egret.EventDispatcher,this.m_Crypt=new network.Crypt,this.m_wRecvSize=0,this.m_RecvQueue=[]}return e.prototype.createConnect=function(e,t){null==this.m_Socket&&(this.m_Socket=new network.TcpSocket,this.m_Socket.setServiceModule(this)),this.m_Socket.connect(e,t)},e.prototype.pushRecvBuffer=function(e){this.m_RecvQueue.push(e)},e.prototype.setSocketBuffer=function(e){var t=this;return this.m_CurTime=egret.getTimer(),new Promise(function(n,i){var r=0;try{for(t.m_wRecvSize=e.getLength();t.m_wRecvSize>=df.Len_Tcp_Head;){e.position(r);var o=(utils.MathUtils.getUnsignedByte(e.Pop_Byte()),utils.MathUtils.getUnsignedByte(e.Pop_Byte()),e.Pop_WORD());if(egret.assert(o>=df.Len_Tcp_Info&&o<=df.SOCKET_TCP_BUFFER),o<df.Len_Tcp_Info||o>df.SOCKET_TCP_BUFFER)throw new Error("消息包错误");if(t.m_wRecvSize<o)throw new Error("消息包接收不完整");if(0==t.m_Crypt.CrevasseBuffer(e,o,r))throw egret.assert(!1),new Error("解密失败");e.position(df.Len_Tcp_Info);var s=e.Pop_WORD(),a=e.Pop_WORD();if(console.log("主命令: "+s+",子命令: "+a),s==df.MDM_KN_COMMAND)a==df.SUB_KN_DETECT_SOCKET?t.getServiceModule().getDelegate().sendPing(t):a==df.SUB_KN_SHUT_DOWN_SOCKET&&t.closeService();else{var c=new network.Message(s,a,o-df.Len_Tcp_Head,e);t.m_ServiceModule._MsgQueue.push(c)}t.m_wRecvSize-=o,egret.assert(t.m_wRecvSize>=0),r+=o,t.m_wRecvSize<df.Len_Tcp_Head&&(n(),e=null),console.log("已处理长度: "+o+",剩余长度: "+t.m_wRecvSize)}}catch(_){t.m_wRecvSize-=o,r+=o,t.m_wRecvSize<df.Len_Tcp_Head&&(e=null),i("数据解析异常")}})},e.prototype.SendSocketData=function(e,t,n,i){var r=this.initSocketData(e,t,n,i);return this.m_Socket&&(n.position(0),this.m_Socket.writeBytes(n.getByteArray(),0,r),n.clear(),n=null),!0},e.prototype.initSocketData=function(e,t,n,i){var r=[],o=0;return 0!=(this.m_Crypt.getDataFlag()&network.DK_MAPPED)&&(n.position(df.Len_Tcp_Info),n.Append_WORD(e),n.Append_WORD(t),r=this.m_Crypt.EncryptBuffer(n,i)),n.position(0),n.Append_Byte(r[0]),n.Append_Byte(r[1]),n.Append_WORD(r[2]),o=r[2]},e.prototype.socketConnectSuccess=function(){this.m_Socket.setConnectStatus(2),this.m_CurTime=egret.getTimer();var e=this.m_ServiceModule.getDelegate();null!=e&&e.getDispatcher().dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_CONNECT_COMPLETE)),this.m_ServiceModule.socketConnectSuccess()},e.prototype.onReconnect=function(){this.m_ServiceModule.onReconnect()},e.prototype.closeService=function(){null!=this.m_Socket&&(this.m_Socket.isConnected()&&this.m_Socket.close(),this.m_Socket=null),null!=this.m_Crypt&&(this.m_Crypt=null),console.log("TcpService服务关闭")},e.prototype.onUpdate=function(){var e=this,n=egret.getTimer(),i=n-this.m_CurTime;if(null!=this.m_Socket){if(i>=t&&1==this.m_Socket.isConnected())do this.getServiceModule().getDelegate().sendPing(this),this.m_CurTime=egret.getTimer(),console.log("发送心跳");while(!1);if(this.m_RecvQueue.length>0){var r=this.m_RecvQueue[0];this.setSocketBuffer(r).then(function(){e.m_RecvQueue.shift()})["catch"](function(t){console.error(t),e.m_RecvQueue.shift()})}}},e.prototype.getServiceModule=function(){return this.m_ServiceModule},e}();e.TcpSocketService=n,__reflect(n.prototype,"service.TcpSocketService")}(service||(service={}));var utils;!function(e){var t=65536,n=t*t,i=function(){function t(){this.bytearray=new egret.ByteArray,this.bytearray.endian=egret.Endian.LITTLE_ENDIAN}return t.prototype.getLength=function(){return this.bytearray?this.bytearray.length:0},t.prototype.Append_DOUBLE=function(e){this.bytearray&&this.bytearray.writeDouble(e)},t.prototype.Append_BOOL=function(e){this.bytearray&&this.bytearray.writeBoolean(e)},t.prototype.Append_WORD=function(e){this.bytearray&&this.bytearray.writeUnsignedShort(e)},t.prototype.Append_Byte=function(e){this.bytearray&&this.bytearray.writeByte(e)},t.prototype.Append_Bytes=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0),this.bytearray&&this.bytearray.writeBytes(e,t,n)},t.prototype.Append_DWORD=function(e){this.bytearray&&this.bytearray.writeUnsignedInt(e)},t.prototype.Append_UTF16=function(e,t){for(var n=new ArrayBuffer(2*e.length),i=new Uint16Array(n),r=0,o=e.length;o>r;r++)i[r]=e.charCodeAt(r);var s=new egret.ByteArray(i.buffer);this.Append_Bytes(s);for(var r=0;r<2*(t-e.length);r++)this.Append_Byte(0)},t.prototype.Append_SCORE=function(e){for(var t=this.numberToInt64(e),n=t.length-1;n>=0;n--)this.bytearray&&this.bytearray.writeByte(t[n])},t.prototype.Append_LONGLONG=function(e){for(var t=this.numberToInt64(e),n=t.length-1;n>=0;n--)this.bytearray&&this.bytearray.writeByte(t[n])},t.prototype.Append_LONG=function(e){this.bytearray&&this.bytearray.writeInt(e)},t.prototype.Append_INT=function(e){this.bytearray&&this.bytearray.writeInt(e)},t.prototype.getByteArray=function(){return this.bytearray},t.prototype.Pop_DOUBLE=function(){return this.bytearray?this.bytearray.readDouble():0},t.prototype.Pop_BOOL=function(){return this.bytearray?this.bytearray.readBoolean():!1},t.prototype.Pop_WORD=function(){return this.bytearray?this.bytearray.readUnsignedShort():0},t.prototype.Pop_Byte=function(){return this.bytearray?this.bytearray.readByte():0},t.prototype.Pop_Bytes=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=0),this.bytearray?this.bytearray.readBytes(e,t,n):0},t.prototype.Pop_DWORD=function(){return this.bytearray?this.bytearray.readUnsignedInt():0},t.prototype.Pop_UTF16=function(t){if(this.bytearray){var n=e.Memory.newLitteEndianByteArray();e.Memory.CopyMemory(n,this,2*t,0,this.bytearray.position),this.bytearray.position+=2*t;var i=n.getByteArray(),r=String.fromCharCode.apply(null,new Uint16Array(i.buffer)),o=e.Memory.newLitteEndianByteArray();o.Append_Byte(0),o.Append_Byte(0);for(var s=String.fromCharCode.apply(null,new Uint16Array(o.getByteArray().buffer)),a=2*r.length,c=0;a>c;c++)r=r.replace(s,"");return r}return""},t.prototype.Pop_SCORE=function(){if(this.bytearray){var e=this.bytearray.readInt(),t=this.bytearray.readInt(),i=t*n+e;if(0>i){var r=4294967296;i=r+i}return i}return 0},t.prototype.Pop_LONGLONG=function(){if(this.bytearray){var e=this.bytearray.readInt(),t=this.bytearray.readInt(),i=t*n+e;if(0>i){var r=4294967296;i=r+i}return i}return 0},t.prototype.Pop_LONG=function(){return this.bytearray?this.bytearray.readInt():0},t.prototype.Pop_INT=function(){return this.bytearray?this.bytearray.readInt():0},t.prototype.clear=function(){this.bytearray&&this.bytearray.clear()},t.prototype.position=function(e){this.bytearray&&(this.bytearray.position=e)},t.prototype.getPosition=function(){return this.bytearray.position},t.prototype.int64toNumber=function(e){for(var t=e[0]>>7,n=0,i=1,r=0;8>r;r++){var o=e[7-r];n+=(t?255^o:o)*i,i*=256}return t?-1-n:n},t.prototype.numberToInt64=function(e){var t=[],n=0>e;n&&(e=-1-e);for(var i=0;8>i;i++){var r=e%256;e=(e-r)/256,t[7-i]=n?255^r:r}return t},t}();e.ByteArray=i,__reflect(i.prototype,"utils.ByteArray")}(utils||(utils={}));var utils;!function(e){var t=function(){function e(){}return e.createHttpRequest=function(t,n,i,r,o,s,a){var c=new e;return c&&c.initHttpRequest(t,n,i,r,o,s,a)?c:null},e.prototype.initHttpRequest=function(e,t,n,i,r,o,s){return egret.assert(t.length>0),egret.assert(i==egret.HttpMethod.GET||i==egret.HttpMethod.POST),0==t.length?!1:i!=egret.HttpMethod.GET&&i!=egret.HttpMethod.POST?!1:(this._onCompleteHandler=r,this._onErrorHandler=o,this._onProgressHandler=s,this._target=e,this.m_Request=new egret.HttpRequest,this.m_Request.responseType=egret.HttpResponseType.TEXT,this.m_Request.setRequestHeader("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"),i==egret.HttpMethod.POST?(this.m_Request.open(t,i),this.m_Request.send(n)):(this.m_Request.open(t+n,i),this.m_Request.send()),this.m_Request.once(egret.Event.COMPLETE,r,e),this.m_Request.once(egret.IOErrorEvent.IO_ERROR,o,e),null!=s&&this.m_Request.once(egret.ProgressEvent.PROGRESS,s,e),!0)},e.prototype.abort=function(){this.m_Request.removeEventListener(egret.Event.COMPLETE,this._onCompleteHandler,this._target),this.m_Request.removeEventListener(egret.IOErrorEvent.IO_ERROR,this._onErrorHandler,this._target),this.m_Request.removeEventListener(egret.ProgressEvent.PROGRESS,this._onProgressHandler,this._target),this._onCompleteHandler=null,this._onErrorHandler=null,this._onProgressHandler=null,this.m_Request.abort()},e}();e.HttpRequest=t,__reflect(t.prototype,"utils.HttpRequest")}(utils||(utils={}));var utils;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e._textrueName="",e._text="",e}return __extends(n,t),n.createLabel=function(e,t,i,r,o){var s=new n;return s&&s.initWithString(e,t,i,r,o)?s:null},n.prototype.initWithString=function(t,n,i,r,o){this.removeChildren();var s=t.length;if(this.width=s*r,this.height=o,this._textrueName=n,0==t.length)return!1;this._text=null,this._text=t;for(var a=0;s>a;a++)for(var c=t[a],_=0,l=0;l<i.length;l++)if(c==i[l]){_=l;var h=new egret.Rectangle(_*r,0,r,o),u=e.createBitmapByName(n,h);this.addChild(u),e.setAnchorLeftTop(u),u.x=a*r,u.y=0;break}return!0},n.prototype.getText=function(){return this._text},n}(egret.Sprite);e.LabelAtlas=t,__reflect(t.prototype,"utils.LabelAtlas")}(utils||(utils={}));var LoadingUI=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var utils;!function(e){var t=function(){function t(){}return t.CopyMemory=function(e,t,n,i,r){void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=0);var o=t.getByteArray().position;t.getByteArray().position=r,t.Pop_Bytes(e.getByteArray(),i,n),t.getByteArray().position=o},t.memset=function(e,t,n,i){void 0===i&&(i=0);var r=e.getByteArray().position;e.getByteArray().position=i;for(var o=0;n>o;o++)e.Append_Byte(t);e.getByteArray().position=r},t.memsetByByteArray=function(e,t,n,i,r){void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=0);var o=e.getByteArray().position;e.getByteArray().position=i;var s=t.getByteArray().position;t.getByteArray().position=r,e.Append_Bytes(t.getByteArray(),r,n),t.getByteArray().position=s,e.getByteArray().position=o},t.newLitteEndianByteArray=function(t){var n=new e.ByteArray;return n.getByteArray().endian=egret.Endian.LITTLE_ENDIAN,n.position(t?t:0),n},t}();e.Memory=t,__reflect(t.prototype,"utils.Memory")}(utils||(utils={}));var utils;!function(e){var t=function(t){function n(e,n,i){var r=t.call(this)||this;return r.m_CurRichElementText=[],r.m_curWidth=0,r.m_widthMax=0,r.width=e,r.height=i,r.m_widthMax=Math.min(e,n),r}return __extends(n,t),n.prototype.removeElement=function(e){},n.prototype.pushBackElement=function(e){this.m_CurRichElementText.push(e)},n.prototype.clear=function(){for(var e=0,t=this.m_CurRichElementText;e<t.length;e++){var n=t[e];this.removeChild(n)}this.m_CurRichElementText=[],this.m_curWidth=0},n.prototype.showRichText=function(){if(0!=this.m_widthMax)for(var t=0,n=this.m_CurRichElementText;t<n.length;t++){var i=n[t];if(this.m_curWidth+i.width>this.m_widthMax)return;e.setAnchorLeftMid(i),this.addChild(i),i.x=this.m_curWidth,i.y=this.height/2,this.m_curWidth+=i.width}},n}(egret.Sprite);e.RichText=t,__reflect(t.prototype,"utils.RichText")}(utils||(utils={}));var controller;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.name="ClientController",t.createClientScene(),t.addEventListener(customEvent.CustomEvent.EVENT_ENTER_BACKGROUND,t.applicationWillEnterForeground,t),t.addEventListener(customEvent.CustomEvent.EVENT_BECOME_ACTIVE,t.applicationDidBecomeActive,t),t}return __extends(t,e),t.prototype.createClientScene=function(){},t.prototype.viewWillAppear=function(e){var t=new eui.UILayer;this.addChild(t);var n=utils.createBitmapByName("background_png");t.addChild(n);var i=managers.FrameManager.getInstance().getRunningController();i.setRoot(t);var r=new client.ClientLayer;r.x=-this.width,r.y=0,i.showView(r,1,!0)},t.prototype.viewDidAppear=function(e){},t.prototype.viewWillDisappear=function(e){},t.prototype.viewDidDisappear=function(e){},t.prototype.dealloc=function(){this.removeEventListener(customEvent.CustomEvent.EVENT_ENTER_BACKGROUND,this.applicationWillEnterForeground,this),this.removeEventListener(customEvent.CustomEvent.EVENT_BECOME_ACTIVE,this.applicationDidBecomeActive,this)},t.prototype.applicationDidBecomeActive=function(e){},t.prototype.applicationWillEnterForeground=function(e){},t.prototype.onMessage=function(e){var t=e.data;t.wMainCmd},t}(models.Controller);e.ClientController=t,__reflect(t.prototype,"controller.ClientController",["df.IController"])}(controller||(controller={}));var client;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n._scene=t,n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},t.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.BattleFindLayer;var t=e.getChildByName("bt_close");t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this)},t.prototype.onButtonClick=function(e){var t=e.target,n=t.name;switch(egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},100).to({scaleX:1,scaleY:1},100),n){case"bt_close":this._scene.onChangeView()}},t.prototype.onExit=function(){},t}(eui.UILayer);e.ActivityLayer=t,__reflect(t.prototype,"client.ActivityLayer")}(client||(client={}));var client;!function(e){var t=function(t){function n(e,n){var i=t.call(this)||this;return i._gameList=[],i._curIndex=0,i._listBtn=[],i._bMoved=!1,i._lBaseScore=0,i._lCard=0,i._lDiamond=0,i._bRoomCard=!1,i._scene=e,i._param=n,i}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.addEventListener(customEvent.CustomEvent.EVENT_BATTLE_REFRESH,this.onRreshBattleUI,this)},n.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.BattleCreateLayer;var t=e.getChildByName("bt_close");t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),this.getGameListByConfig(this._param.mode),this._pageUp=e.getChildByName("PageUp"),this._pageDown=e.getChildByName("PageDown"),this._pageUp.visible=!1,egret.Tween.get(this._pageUp,{loop:!0}).to({scaleX:1.2,scaleY:1.2},300).to({scaleX:1,scaleY:1},300).wait(500).to({scaleX:1.2,scaleY:1.2},300).to({scaleX:1,scaleY:1},300),egret.Tween.get(this._pageDown,{loop:!0}).to({scaleX:1.2,scaleY:1.2},300).to({scaleX:1,scaleY:1},300).wait(500).to({scaleX:1.2,scaleY:1.2},300).to({scaleX:1,scaleY:1},300),t=e.getChildByName("battleList"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),t=e.getChildByName("gameRule"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),t=e.getChildByName("battleCreate"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),this._richText=new utils.RichText(718,718,46),this.addChild(this._richText),utils.setAnchorLeftTop(this._richText),this._richText.x=604,this._richText.y=596,this._listView=e.getChildByName("GameListScorll"),this._listView.addEventListener(egret.Event.CHANGE,this.onScrollerChange,this);for(var n=this._listView.getChildByName("Group"),i=0;i<this._gameList.length;i++){var r=this._gameList[i],o=new eui.Button;o.name=this._gameList[i].id,o.skinName="resource/eui_skins/list/battle_list_"+r.id+".exml",n.addChild(o),o.addEventListener(egret.TouchEvent.TOUCH_END,this.onButtonClick,this),utils.setAnchorCenter(o),o.scaleX=0==i?.75:.65,o.scaleY=0==i?.75:.65,o.x=n.width/2,o.y=o.height/2-15+120*i,this._listBtn.push(o)}this._scrollBattleConfig=e.getChildByName("battleConfig"),this.onGameChangeEvent(Number(this._gameList[0].id)),this._curImage=new eui.Image("battle_frame_1_png"),n.addChild(this._curImage),utils.setAnchorCenter(this._curImage),this._curImage.x=this._listBtn[0].x,this._curImage.y=this._listBtn[0].y,this._curImage.scaleX=.75,this._curImage.scaleY=.75},n.prototype.viewWillDisappear=function(){this.onCloseBattleService()},n.prototype.transFinish=function(){this.onRreshBattleUI()},n.prototype.updataCurGameIndex=function(){for(var e=this._listBtn[this._curIndex],t=0,n=this._listBtn;t<n.length;t++){var i=n[t];e==i?(i.scaleX=.75,i.scaleY=.75,this._curImage.x=this._listBtn[this._curIndex].x,this._curImage.y=this._listBtn[this._curIndex].y):(i.scaleX=.65,i.scaleY=.65)}},n.prototype.getGameListByConfig=function(e){switch(e){case df.MODE_TH_SET:this.onInitGameList();break;case df.MODE_TH_MODIFY:break;case df.MODE_TH_CREATE:}},n.prototype.onInitGameList=function(){for(var e=managers.TcpServiceCtrl.getInstance().getGameListInfo()._Info,t=0;t<e.length;t++){var n=e[t].id;if(e[t].show&&!e[t].disableBattle){var i=managers.TcpServiceCtrl.getInstance().getServerInfo().getOptionList(),r=managers.TcpServiceCtrl.getInstance().getServerInfo().getOptionSpecialList();if(null!=(i&&i[Number(n)])){var o={id:n,specialInfo:r[Number(n)],optionInfo:i[Number(n)]};this._gameList.push(o)}}}},n.prototype.onGameChangeEvent=function(t){var n=this;this._gameList.forEach(function(i){if(Number(i.id)==t){var r=n._scrollBattleConfig.getChildByName("Group");return null!=r.getChildByName("configView")&&(r.removeChild(r.getChildByName("configView")),n._configView=null),n._configView=new e.CreateConfigView(n,i,{}),n._configView.name="configView",n._configView.touchEnabled=!1,void r.addChild(n._configView)}})},n.prototype.onButtonClick=function(t){var n=this,i=t.target,r=i.name;if(!isNaN(Number(r)))return void(this._bMoved||this._listBtn.forEach(function(e,t){return e==i?(n._curIndex=t,n.updataCurGameIndex(),void n.onGameChangeEvent(Number(r))):void 0}));switch(egret.Tween.get(i).to({scaleX:1.1,scaleY:1.1},100).to({scaleX:1,scaleY:1},100),r){case"bt_close":this._scene.onChangeView();break;case"battleList":this._scene.onChangeView(df.MODE_BATTLE_LIST);break;case"battleCreate":this.onCreateRoom(this._configView.getConfigResult());break;case"gameRule":var o=managers.FrameManager.getInstance().getRunningController(),s=new e.GameHelp(o.getRootLayer());o.addWindow(s)}},n.prototype.onScrollerChange=function(e){var t=this._listView.viewport.scrollV;console.log("scrollV : "+t);var n=0,i=120*(this._gameList.length-1)-this._listView.viewport.height;n>=t?(this._pageUp.visible=!1,this._pageDown.visible=!0):t>n&&i>t?(this._pageUp.visible=!0,this._pageDown.visible=!0):(this._pageUp.visible=!0,this._pageDown.visible=!1)},n.prototype.onCloseBattleService=function(){null!=managers.TcpServiceCtrl.getInstance().getGateWayService()&&(managers.TcpServiceCtrl.getInstance().getGateWayService().closeService(),managers.TcpServiceCtrl.getInstance().m_pGateWayCtrl=null),this._battleFrame=null},n.prototype.onExit=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.removeEventListener(customEvent.CustomEvent.EVENT_BATTLE_REFRESH,this.onRreshBattleUI,this),this.onCloseBattleService()},n.prototype.onTouchBegan=function(e){this._bMoved=!1},n.prototype.onTouchMove=function(e){this._bMoved=!0},n.prototype.onTouchEnd=function(e){},n.prototype.onRreshBattleUI=function(e){var t=e?e.data:null;if(this._lBaseScore=t?t.baseScore:this._lBaseScore,this._lCard=t?t.card:this._lCard,this._lDiamond=t?t.diamond:this._lDiamond,this._bRoomCard=t?t.bRoomCard:this._bRoomCard,this._richText.clear(),0!=this._lBaseScore){var n=new eui.Label;n.text="当前游戏为 ",n.textColor=16636823,n.size=24,this._richText.pushBackElement(n),n=new eui.Label,n.text=""+this._lBaseScore,n.textColor=6670104,n.size=24,this._richText.pushBackElement(n),n=new eui.Label,n.text=" 底分,",n.textColor=16636823,n.size=24,this._richText.pushBackElement(n)}if(this._bRoomCard){var n=new eui.Label;n.text="对局记录需 ",n.textColor=16636823,n.size=24,this._richText.pushBackElement(n),n=new eui.Label,n.text=""+this._lCard,n.textColor=6670104,n.size=24,this._richText.pushBackElement(n),n=new eui.Label,n.text=" 房卡，您当前尚有 ",n.textColor=16636823,n.size=24,this._richText.pushBackElement(n),n=new eui.Label,n.text=""+managers.FrameManager.getInstance().m_GlobalUserItem.lUserRoomCard,n.textColor=6670104,n.size=24,this._richText.pushBackElement(n),n=new eui.Label,n.text=" 房卡",n.textColor=16636823,n.size=24,this._richText.pushBackElement(n)}else{var n=new eui.Label;n.text="对局需 ",n.textColor=16636823,n.size=24,this._richText.pushBackElement(n),n=new eui.Label,n.text=""+this._lDiamond,n.textColor=6670104,n.size=24,this._richText.pushBackElement(n),n=new eui.Label,n.text=" 钻石，您当前尚有 ",n.textColor=16636823,n.size=24,this._richText.pushBackElement(n),n=new eui.Label,n.text=""+managers.FrameManager.getInstance().m_GlobalUserItem.lUserIngot,n.textColor=6670104,n.size=24,this._richText.pushBackElement(n),n=new eui.Label,n.text=" 钻石",n.textColor=16636823,n.size=24,this._richText.pushBackElement(n)}this._richText.showRichText();var i={key:"wealth",data:{}};this._scene.dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_PLAZA_REFRESH,!1,!1,i))},n.prototype.onCreateRoom=function(e){this._battleFrame=new frame.BattleFrame(this),this._battleFrame.onNCreateTable(Number(e.wKindID),e.cbCurrencyKind,e.lBaseScore,e,e.wPayType),null!=managers.TcpServiceCtrl.getInstance().getGateWayService()&&managers.TcpServiceCtrl.getInstance().getGateWayService().setDelegate(this._battleFrame)},n.prototype.onStartBattleGame=function(){managers.FrameManager.getInstance().showToast("游戏接口未实现")},n}(eui.UILayer);e.BattleCreateLayer=t,__reflect(t.prototype,"client.BattleCreateLayer")}(client||(client={}));var client;!function(e){var t=function(t){function n(e,n){var i=t.call(this)||this;return i._scene=e,i._params=n,i}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},n.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.BattleDetailLayer,this.onInitBattleInfo(e);var t=e.getChildByName("bt_close");t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),this.touchEnabled=!0},n.prototype.onInitBattleInfo=function(e){var t=this._params.info,n=e.getChildByName("roomNumber");n.text=""+t.dwMappedNum;var i=managers.TcpServiceCtrl.getInstance().getGameListInfo().getGameName(t.wKindID),r=e.getChildByName("KindName");r.text=i;var o=e.getChildByName("CellScore");o.text=""+t.lBaseScore+"分";var s=e.getChildByName("SettleKind");t.cbSettleKind!=df.SETTLE_KIND_NONE&&(t.cbSettleKind==df.SETTLE_KIND_TIME?s.text=""+Math.floor(t.dwPlayTime/60)+"分钟":t.cbSettleKind==df.SETTLE_KIND_COUNT&&(s.text=""+t.wPlayCount+"局"));var a=new Date(1e3*t.dwCreateTime),c=a.toLocaleDateString().replace(/\//g,"/")+" "+a.toTimeString().substr(0,8),_=e.getChildByName("Time");_.text=c;var l=e.getChildByName("dissmiss");l.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),l=e.getChildByName("start"),l.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),l=e.getChildByName("share"),l.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this)},n.prototype.transIn=function(){egret.Tween.get(this).to({x:0,y:0},200)},n.prototype.transOut=function(){var e=this;egret.Tween.get(this).to({x:0,y:-this.height},200).call(function(){e._scene.removeChild(e)})},n.prototype.onButtonClick=function(t){var n=t.target,i=n.name;switch(egret.Tween.get(n).to({scaleX:1.1,scaleY:1.1},100).to({scaleX:1,scaleY:1},100),i){case"bt_close":this.transOut();break;case"dissmiss":var r=this._params.info;this._scene.onDismissTable(r.wKindID,r.dwMappedNum);break;case"start":managers.FrameManager.getInstance().showToast("游戏接口未实现");break;case"share":var o=managers.FrameManager.getInstance().getRunningController(),s=new e.ShareLayer(o.getRootLayer(),.4);o.addWindow(s)}},n.prototype.onExit=function(){},n}(eui.UILayer);e.BattleDetailLayer=t,__reflect(t.prototype,"client.BattleDetailLayer")}(client||(client={}));var client;!function(e){var t=6,n=function(e){function n(t){var n=e.call(this)||this;return n._numbers=[],n._idx=0,n._scene=t,n}return __extends(n,e),n.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},n.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.BattleFindLayer;var n=e.getChildByName("bt_close");n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);for(var i=0;t>i;i++){var r=utils.LabelAtlas.createLabel("0","battle_num_number_png","0123456789",46,71);utils.setAnchorCenter(r),this.addChild(r),r.visible=!1,r.x=410+103*i,r.y=221,this._numbers.push(r)}for(var i=0;12>i;i++){if(n=e.getChildByName("keybord"+i),n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),9>i){var r=utils.LabelAtlas.createLabel(""+(i+1),"battle_num_keyboard_png","0123456789",28,38);utils.setAnchorCenter(r),this.addChild(r),r.x=n.x,r.y=n.y}if(10==i){var r=utils.LabelAtlas.createLabel("0","battle_num_keyboard_png","0123456789",28,38);utils.setAnchorCenter(r),this.addChild(r),r.x=n.x,r.y=n.y}}},n.prototype.onButtonClick=function(e){var n=e.target,i=n.name;switch(egret.Tween.get(n).to({scaleX:1.1,scaleY:1.1},100).to({scaleX:1,scaleY:1},100),i){case"bt_close":this._scene.onChangeView();break;case"keybord0":case"keybord1":case"keybord2":case"keybord3":case"keybord4":case"keybord5":case"keybord6":case"keybord7":case"keybord8":case"keybord10":if(this._idx<t){this._numbers[this._idx].visible=!0;var r=Number(i.substr(7,i.length))+1;r>10&&(r=0),this._numbers[this._idx].initWithString(""+r,"battle_num_number_png","0123456789",46,71),this._idx++}break;case"keybord9":this._idx-1>=0&&(this._numbers[this._idx-1].visible=!1,this._idx--);break;case"keybord11":if(this._idx<t)return;for(var o="",s=0;t>s;s++)o+=this._numbers[s].getText();managers.FrameManager.getInstance().showPopWait("查询中,请稍后"),this.onQueryTable(df.QUERY_KIND_NUMBER,Number(o))}},n.prototype.onQueryTable=function(e,t,n){null==this._battleFrame&&(this._battleFrame=new frame.BattleFrame(this)),this._battleFrame.onQueryTable(e,t,n),null!=managers.TcpServiceCtrl.getInstance().getGateWayService()&&managers.TcpServiceCtrl.getInstance().getGateWayService().setDelegate(this._battleFrame)},n.prototype.onCloseBattleService=function(){null!=managers.TcpServiceCtrl.getInstance().getGateWayService()&&(managers.TcpServiceCtrl.getInstance().getGateWayService().closeService(),managers.TcpServiceCtrl.getInstance().m_pGateWayCtrl=null),this._battleFrame=null},n.prototype.onStartBattleGame=function(){managers.FrameManager.getInstance().showToast("游戏接口未实现")},n.prototype.onExit=function(){this.onCloseBattleService()},n}(eui.UILayer);e.BattleFindLayer=n,__reflect(n.prototype,"client.BattleFindLayer")}(client||(client={}));var client;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n._curRoomIndex=0,n._bMoved=!1,n._scene=e,n}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.addEventListener(customEvent.CustomEvent.EVENT_BATTLE_INFO_REFRESH,this.onUIRefresh,this)},n.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.BattleListLayer,this._noRoomIcon=e.getChildByName("battle_no_room"),this._listSroller=e.getChildByName("scroller");var t=e.getChildByName("bt_close");t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),t=e.getChildByName("createBattle"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),t=e.getChildByName("battleRecord"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),t=e.getChildByName("diamond"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),t=e.getChildByName("shop"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),this.onUpdateUserInfo()},n.prototype.transFinish=function(){this.onQueryTable(df.QUERY_KIND_USERID,managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID)
},n.prototype.onQueryTable=function(e,t,n){null==this._battleFrame&&(this._battleFrame=new frame.BattleFrame(this)),this._battleFrame.onQueryTable(e,t,n),null!=managers.TcpServiceCtrl.getInstance().getGateWayService()&&managers.TcpServiceCtrl.getInstance().getGateWayService().setDelegate(this._battleFrame)},n.prototype.onQueryTableUserList=function(e,t){null==this._battleFrame&&(this._battleFrame=new frame.BattleFrame(this)),this._battleFrame.onQueryTableUserList(e,t),null!=managers.TcpServiceCtrl.getInstance().getGateWayService()&&managers.TcpServiceCtrl.getInstance().getGateWayService().setDelegate(this._battleFrame)},n.prototype.onDismissTable=function(e,t){null==this._battleFrame&&(this._battleFrame=new frame.BattleFrame(this)),this._battleFrame.onDismissTable(e,t),null!=managers.TcpServiceCtrl.getInstance().getGateWayService()&&managers.TcpServiceCtrl.getInstance().getGateWayService().setDelegate(this._battleFrame)},n.prototype.onDismissResult=function(e){if(null!=e.szDescribeString&&managers.FrameManager.getInstance().showToast(e.szDescribeString),this.onCloseBattleService(),1==e.cbResultCode){var t=this.getChildByName("detailLayer");null!=t&&(this.removeChild(t),t=null),null==this._battleFrame&&(this._battleFrame=new frame.BattleFrame(this)),this._battleFrame.onFlushWealth(),null!=managers.TcpServiceCtrl.getInstance().getTcpService()&&managers.TcpServiceCtrl.getInstance().setDelegate(this._battleFrame),managers.TcpServiceCtrl.getInstance().getServerInfo().m_BattleList.splice(this._curRoomIndex,1),managers.TcpServiceCtrl.getInstance().getServerInfo().m_BattleParamList.splice(this._curRoomIndex,1),this._curRoomIndex=0,this.onUpdateList()}},n.prototype.onCloseBattleService=function(){null!=managers.TcpServiceCtrl.getInstance().getGateWayService()&&(managers.TcpServiceCtrl.getInstance().getGateWayService().closeService(),managers.TcpServiceCtrl.getInstance().m_pGateWayCtrl=null),this._battleFrame=null},n.prototype.onButtonClick=function(e){var t=e.target,n=t.name;switch(egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},100).to({scaleX:1,scaleY:1},100),n){case"bt_close":this._scene.onChangeView();break;case"createBattle":this._scene.onChangeView(df.MODE_BATTLE_CREATE);break;case"battleRecord":this._scene.onChangeView(df.MODE_BATTLE_RECORD);break;case"diamond":case"shop":this._scene._shopIndex="shop"==t.name?1:0,this._scene.onChangeView(df.MODE_SHOP)}},n.prototype.onUpdateUserInfo=function(){var e=managers.FrameManager.getInstance().m_GlobalUserItem.lUserIngot;null==this._diamond?(this._diamond=utils.LabelAtlas.createLabel(utils.StringUtils.formatNumberThousands(e),"general_num_list_ingot_png",",0123456789",15,26),this.addChild(this._diamond)):this._diamond.initWithString(utils.StringUtils.formatNumberThousands(e),"general_num_list_ingot_png",",0123456789",15,26),utils.setAnchorLeftMid(this._diamond),this._diamond.x=112,this._diamond.y=623;var t=managers.FrameManager.getInstance().m_GlobalUserItem.lUserScore;null==this._score?(this._score=utils.LabelAtlas.createLabel(utils.StringUtils.formatNumberThousands(t),"general_num_list_gold_png",",0123456789",15,26),this.addChild(this._score)):this._score.initWithString(utils.StringUtils.formatNumberThousands(t),"general_num_list_gold_png",",0123456789",15,26),utils.setAnchorLeftMid(this._score),this._score.x=112,this._score.y=657},n.prototype.onUIRefresh=function(e){this.onUpdateUserInfo()},n.prototype.onUpdateList=function(){this._noRoomIcon.visible=0==managers.TcpServiceCtrl.getInstance().getServerInfo().m_BattleList.length?!0:!1;var e=this._listSroller.getChildByName("group");e.removeChildren();for(var t=managers.TcpServiceCtrl.getInstance().getServerInfo().m_BattleList,n=managers.TcpServiceCtrl.getInstance().getServerInfo().m_BattleParamList,i=0;i<t.length;i++){var r=t[i].wKindID,o=new eui.Image("room_frame_"+r+"_png");o.name=""+i,e.addChild(o),o.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEvent,this),o.x=0+350*i,o.y=0;var s=t[i],a=n[i];if(null==a)return;if(s.cbSettleKind==df.SETTLE_KIND_TIME){var c=new eui.Image("battle_text_leave_time_png");e.addChild(c),c.x=50+350*i,c.y=280;var _=Math.floor((s.dwPlayTime-a.dwElapsedTime)/60),l=new eui.Label(""+_+"分钟");l.size=24,l.multiline=!1,l.textColor=11722263,e.addChild(l),l.x=160+350*i,l.y=285;var h=new eui.Label(""+s.lBaseScore+"底");h.size=24,h.width=200,h.height=24,h.textAlign=egret.HorizontalAlign.CENTER,h.multiline=!1,h.textColor=16776960,e.addChild(h),utils.setAnchorCenter(h),h.x=143+350*i,h.y=370}else if(s.cbSettleKind==df.SETTLE_KIND_COUNT){var c=new eui.Image("battle_text_leave_count_png");e.addChild(c),c.x=50+350*i,c.y=280;var u=new eui.Label(""+a.wFinishCount+"/"+s.wPlayCount);u.size=24,u.multiline=!1,u.textColor=11722263,e.addChild(u),u.x=160+350*i,u.y=285;var h=new eui.Label(""+s.lBaseScore+"底");h.size=24,h.width=200,h.height=24,h.textAlign=egret.HorizontalAlign.CENTER,h.multiline=!1,h.textColor=16776960,e.addChild(h),utils.setAnchorCenter(h),h.x=143+350*i,h.y=370}var d=new eui.Label(""+s.dwMappedNum+" 号房");d.size=24,d.multiline=!1,d.textColor=0,e.addChild(d),d.x=70+350*i,d.y=322}},n.prototype.onUpdateRoomDetail=function(){var t=managers.TcpServiceCtrl.getInstance().getServerInfo().m_BattleList,n=managers.TcpServiceCtrl.getInstance().getServerInfo().m_BattleParamList;if(null!=t&&0!=t.length&&null!=n&&0!=n.length&&!(this._curRoomIndex<0||this._curRoomIndex>=t.length||this._curRoomIndex<0||this._curRoomIndex>=n.length)){var i=t[this._curRoomIndex],r=n[this._curRoomIndex];if(null!=i&&null!=r){var o=new e.BattleDetailLayer(this,{info:i,param:r});this.addChild(o),o.name="detailLayer",o.x=0,o.y=-this.height,o.transIn()}}},n.prototype.onTouchEvent=function(e){var t=e.target;this._curRoomIndex=Number(t.name),this._bMoved||this.onUpdateRoomDetail()},n.prototype.onTouchBegan=function(e){this._bMoved=!1},n.prototype.onTouchMove=function(e){this._bMoved=!0},n.prototype.onTouchEnd=function(e){},n.prototype.onExit=function(){this.removeEventListener(customEvent.CustomEvent.EVENT_BATTLE_INFO_REFRESH,this.onUIRefresh,this),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.onCloseBattleService()},n}(eui.UILayer);e.BattleListLayer=t,__reflect(t.prototype,"client.BattleListLayer")}(client||(client={}));var client;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n._scene=t,n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},t.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.BattleRecordLayer;var t=e.getChildByName("bt_close");t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),t=e.getChildByName("checkVedio"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this)},t.prototype.onButtonClick=function(e){var t=e.target,n=t.name;switch(egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},100).to({scaleX:1,scaleY:1},100),n){case"bt_close":this._scene.onChangeView()}},t.prototype.onExit=function(){},t}(eui.UILayer);e.BattleRecordLayer=t,__reflect(t.prototype,"client.BattleRecordLayer")}(client||(client={}));var controller;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n.name="GameController",n._gameModule=t,n.addEventListener(customEvent.CustomEvent.EVENT_ENTER_BACKGROUND,n.applicationWillEnterForeground,n),n.addEventListener(customEvent.CustomEvent.EVENT_BECOME_ACTIVE,n.applicationDidBecomeActive,n),n}return __extends(t,e),t.prototype.viewWillAppear=function(e){},t.prototype.viewDidAppear=function(e){this._gameEngine=this.createGameClient(this._gameModule)},t.prototype.viewWillDisappear=function(e){},t.prototype.viewDidDisappear=function(e){},t.prototype.dealloc=function(){this.removeEventListener(customEvent.CustomEvent.EVENT_ENTER_BACKGROUND,this.applicationWillEnterForeground,this),this.removeEventListener(customEvent.CustomEvent.EVENT_BECOME_ACTIVE,this.applicationDidBecomeActive,this)},t.prototype.createGameClient=function(e){var t=this.addChild(utils.createInstance(this._gameModule));return managers.TcpServiceCtrl.getInstance()._isAllowDispatch=!0,t},t.prototype.applicationDidBecomeActive=function(e){console.log("GameController 激活窗口"),this._gameEngine&&this._gameEngine.onInitEngine},t.prototype.applicationWillEnterForeground=function(e){console.log("GameController 进入后台"),this._gameEngine&&this._gameEngine.onResetEngine&&this._gameEngine.onResetEngine()},t}(models.Controller);e.GameController=t,__reflect(t.prototype,"controller.GameController",["df.IController"])}(controller||(controller={}));var client;!function(e){var t={TYPE_USERCOUNT:0,TYPE_PAY:1,TYPE_CURRENCY:2,TYPE_OTHER:3,TYPE_COUNT:4,TYPE_TIME:5,TYPE_CELL:6},n={1:e.RadioGroup,2:e.CheckBoxGroup,4:e.NumInput},i=function(e){function i(t,n,i){var r=e.call(this)||this;return r._configNormal=[],r._configSpecial=[],r._kindID=0,r.m_nCurIndex=1,r.m_OtherOption=[],r.m_ControlListData={},r.m_controlCompanet={},r.m_lBaseScore=0,r.m_cbCurrencyKind=0,r.m_cbSettleKind=0,r.m_wBalanceCount=0,r.m_dwBalanceTime=0,r.m_wPlayerCount=0,r.m_wPayType=0,r.m_wShowCount=0,r.m_isTeaHouse=!1,r._scene=t,r._configNormal=n.optionInfo,r._configSpecial=n.specialInfo?n.specialInfo[0]:[],r._CurConfig=r._configNormal[0]?r._configNormal[0]:[],r._kindID=Number(n.id),r.width=910,r.height=530,r.onInitConfig(),r}return __extends(i,e),i.prototype.onInitConfig=function(){this.createUserCountConfig(),this.createPayerConfig(),this.createCurrencyConfig(),this.createCustomConfig(),this.createRoundConfig(),this.createTimeConfig(),this.createCellConfig(),this.onRestLayout(),0==this.m_dwBalanceTime&&0==this.m_wBalanceCount&&(null!=this.m_ControlListData[t.TYPE_COUNT]?(this.m_wBalanceCount=this._CurConfig.wPlayCount[0],this.m_cbSettleKind=df.SETTLE_KIND_COUNT,this.m_controlCompanet[t.TYPE_COUNT].setSelectedIndex(0)):null!=this.m_ControlListData[t.TYPE_TIME]?(this.m_dwBalanceTime=this._CurConfig.dwPlayTime[1],this.m_cbSettleKind=df.SETTLE_KIND_TIME,this.m_controlCompanet[t.TYPE_TIME].setSelectedIndex(0)):this.m_cbSettleKind=df.SETTLE_KIND_NONE)},i.prototype.onRestLayout=function(){var e=this,i=function(e,t,i){var o=new n[t.type](e,t,i);return e.addChild(o),o.x=0,o.y=r,r+=o.height+15,o},r=(this.m_wShowCount,0);if(null!=this.m_ControlListData[t.TYPE_USERCOUNT]){var o=this.m_ControlListData[t.TYPE_USERCOUNT];this.m_controlCompanet[t.TYPE_USERCOUNT]=i(this,o,function(t){e.onUserCoutChange(t,e._configNormal)})}if(null!=this.m_ControlListData[t.TYPE_PAY]){var o=this.m_ControlListData[t.TYPE_PAY];this.m_controlCompanet[t.TYPE_PAY]=i(this,o,function(n){e.m_wPayType=0==n?df.PAY_TYPE_OWNER:df.PAY_TYPE_USER,e.onConfigChangeEvent(t.TYPE_PAY,n)})}if(null!=this.m_ControlListData[t.TYPE_CURRENCY]){var o=this.m_ControlListData[t.TYPE_CURRENCY];this.m_controlCompanet[t.TYPE_CURRENCY]=i(this,o,function(n){e.m_cbCurrencyKind=0==n?df.CURRENCY_KIND_ROOMCARD:df.CURRENCY_KIND_INGOT,e.onConfigChangeEvent(t.TYPE_CURRENCY,n)})}if(null!=this.m_ControlListData[t.TYPE_OTHER]&&this.m_ControlListData[t.TYPE_OTHER].length>=1){this.m_controlCompanet[t.TYPE_OTHER]=[];for(var s=function(n){var r=a.m_ControlListData[t.TYPE_OTHER][n];a.m_controlCompanet[t.TYPE_OTHER].push(i(a,r,function(t){e.onCustomChange(n,t,e._configSpecial)})),a.m_controlCompanet[t.TYPE_OTHER][n].setSelectedIndex(r.seletedIdx)},a=this,c=0;c<this.m_ControlListData[t.TYPE_OTHER].length;c++)s(c)}if(null!=this.m_ControlListData[t.TYPE_COUNT]){var o=this.m_ControlListData[t.TYPE_COUNT];this.m_controlCompanet[t.TYPE_COUNT]=i(this,o,function(t){e.onRoundChange(t,e._configNormal)})}if(null!=this.m_ControlListData[t.TYPE_TIME]){var o=this.m_ControlListData[t.TYPE_TIME];this.m_controlCompanet[t.TYPE_TIME]=i(this,o,function(t){e.onTimeChange(t,e._configNormal)})}if(null!=this.m_ControlListData[t.TYPE_CELL]){var o=this.m_ControlListData[t.TYPE_CELL];this.m_controlCompanet[t.TYPE_CELL]=i(this,o,function(n){e.onConfigChangeEvent(t.TYPE_CELL,n)})}},i.prototype.createUserCountConfig=function(){var e=-1;if(this._configNormal.length>1){for(var n=this._recordConfig?this._recordConfig.wPlayerCount:0,i={type:df.OPTION_TYPE_SINGLE,title:"人数 :",itemCount:this._configNormal.length,seletedIdx:0,option:[]},r=0;r<this._configNormal.length;r++)i.option.push(this._configNormal[r].wPlayerCount+"人"),n==this._configNormal[r].wPlayerCount&&(i.seletedIdx=r,e=r,this.m_wPlayerCount=this._configNormal[r].wPlayerCount);-1==e&&(this.m_nCurIndex=0,this._CurConfig=this._configNormal[0],this.m_wPlayerCount=this._configNormal[0].wPlayerCount),this.m_ControlListData[t.TYPE_USERCOUNT]=i}else this.m_nCurIndex=0,this._CurConfig=this._configNormal[0],this.m_wPlayerCount=this._configNormal[0].wPlayerCount},i.prototype.createPayerConfig=function(){var e=this._CurConfig.wSuportPayType&&0!=(this._CurConfig.wSuportPayType&df.PAY_TYPE_OWNER),n=this._CurConfig.wSuportPayType&&0!=(this._CurConfig.wSuportPayType&df.PAY_TYPE_USER),i=this._recordConfig?this._recordConfig.wPayType:df.PAY_TYPE_OWNER;if(i=i==df.PAY_TYPE_OWNER?e&&i:i==df.PAY_TYPE_USER?n&&i:null,this.m_wPayType=null==i?e?df.PAY_TYPE_OWNER:df.PAY_TYPE_USER:i,!this.m_isTeaHouse&&e&&n){var r={type:df.OPTION_TYPE_SINGLE,title:"支付房费 :",itemCount:2,seletedIdx:this.m_wPayType==df.PAY_TYPE_OWNER?0:1,option:["房主支付","AA支付"]};this.m_ControlListData[t.TYPE_PAY]=r,this.m_wShowCount++}},i.prototype.createCurrencyConfig=function(){var e=this._CurConfig.wOptionMask&&0!=(this._CurConfig.wOptionMask&df.OPTION_MASK_ROOMCARD),n=this._CurConfig.wOptionMask&&0!=(this._CurConfig.wOptionMask&df.OPTION_MASK_INGOT),i=this._recordConfig?this._recordConfig.cbCurrencyKind:df.CURRENCY_KIND_INGOT;if(i=i==df.CURRENCY_KIND_ROOMCARD?e?i:df.CURRENCY_KIND_INGOT:i==df.CURRENCY_KIND_INGOT?n?i:df.CURRENCY_KIND_ROOMCARD:null,this.m_cbCurrencyKind=null==i?n?df.CURRENCY_KIND_INGOT:df.CURRENCY_KIND_ROOMCARD:i,!this.m_isTeaHouse){var r=df.STATION_ID;if(e&&n&&(2004==r||76!=this._kindID)){var o={type:df.OPTION_TYPE_SINGLE,title:"支付类型 :",itemCount:2,seletedIdx:this.m_cbCurrencyKind==df.CURRENCY_KIND_ROOMCARD?0:1,option:["房卡","钻石"]};this.m_ControlListData[t.TYPE_CURRENCY]=o,this.m_wShowCount++}}},i.prototype.createCustomConfig=function(){if(0!=this._configSpecial.length){var e=this._configSpecial.length,n=this._configSpecial,i=0;this.m_ControlListData[t.TYPE_OTHER]=[],this.m_OtherOption=[];for(var r=this._recordConfig?this._recordConfig.options:null,o=0;e>o;o++)if(this.m_OtherOption.push(0),null!=n[o].type){var s=void 0,a=Number(n[o].count?n[o].count:0),c=r?r[o]:0;if(n[o].type==df.OPTION_TYPE_INPUT){if(n[o].max&&n[o].min)return c=Math.max(c,n[o].min),c=Math.min(c,n[o].max),this.m_OtherOption[o]=c,s={type:df.OPTION_TYPE_INPUT,title:n[o].name,recordData:c,lMaxBaseScore:n[o].max,lMinBaseScore:n[o].min},this.m_ControlListData[t.TYPE_OTHER].push(s),this.m_wShowCount++,void i++}else if(a){s=[];for(var _=[],l=0;a>l;l++){var h={name:"",value:0,price:0,card:0,ownerprice:0,ownercard:0,lMaxBaseScore:0,lMinBaseScore:0};h.name=n[o].items[l].describe,h.value=n[o].items[l].value?n[o].items[l].value:l,h.price=n[o].items[l].price?n[o].items[l].price:0,h.card=n[o].items[l].card?n[o].items[l].card:0,h.ownerprice=n[o].items[l].ownerprice?n[o].items[l].ownerprice:0,h.ownercard=n[o].items[l].ownercard?n[o].items[l].ownercard:0,h.lMaxBaseScore=n[o].items[l].max,h.lMinBaseScore=n[o].items[l].min,s.push(h),_.push(h.name)}if(null==s||0==s.length)return;if(n[o].type==df.OPTION_TYPE_SINGLE){this.m_OtherOption[o]=Math.min(n[o].count-1,c);var u={type:df.OPTION_TYPE_SINGLE,title:n[o].name+" :",itemCount:a,seletedIdx:this.m_OtherOption[o],option:_};this.m_ControlListData[t.TYPE_OTHER].push(u),this.m_wShowCount++,i++}else if(n[o].type==df.OPTION_TYPE_MULTIPLE){this.m_OtherOption[o]=c;for(var d=[],p=0;a>p;p++)0!=(this.m_OtherOption[o]&s[p].value)?d.push(1):d.push(0);var u={type:df.OPTION_TYPE_MULTIPLE,title:n[o].name+" :",itemCount:a,seletedValue:d,option:_};this.m_ControlListData[t.TYPE_OTHER].push(u),this.m_wShowCount++,i++}}}}},i.prototype.createRoundConfig=function(){var e=this._CurConfig.wOptionMask&df.OPTION_MASK_COUNT;if(e&&0!=e){for(var n=this._recordConfig?this._recordConfig.wCount:0,i=-1,r={type:df.OPTION_TYPE_SINGLE,title:"局数结算 :",itemCount:0,seletedIdx:-1,option:[]},o=0;3>o;o++)0!=this._CurConfig.wPlayCount[o]&&(n==this._CurConfig.wPlayCount[o]&&(i=o,this.m_wBalanceCount=n,this.m_cbSettleKind=df.SETTLE_KIND_COUNT,r.seletedIdx=o),r.itemCount++,r.option.push(this._CurConfig.wPlayCount[o]+"局"));this.m_ControlListData[t.TYPE_COUNT]=r,this.m_wShowCount++}},i.prototype.createTimeConfig=function(){var e=this._CurConfig.wOptionMask&df.OPTION_MASK_TIME;if(e&&0!=e){for(var n=this._recordConfig?this._recordConfig.dwTime:0,i=-1,r={type:df.OPTION_TYPE_SINGLE,title:"时间结算 :",itemCount:0,seletedIdx:-1,option:[]},o=0;3>o;o++)0!=this._CurConfig.dwPlayTime[o]&&(n==this._CurConfig.dwPlayTime[o]&&(i=o,this.m_dwBalanceTime=n,this.m_cbSettleKind=df.SETTLE_KIND_TIME),r.itemCount++,r.option.push(this._CurConfig.dwPlayTime[o]/60+"分钟"));this.m_ControlListData[t.TYPE_TIME]=r,this.m_wShowCount++}},i.prototype.createCellConfig=function(){var e=this._recordConfig?this._recordConfig.cellScore:0;if(this.m_lBaseScore=e>=this._CurConfig.lMinBaseScore&&e<=this._CurConfig.lMaxBaseScore?e:this._CurConfig.lMinBaseScore,this._CurConfig.lMaxBaseScore!=this._CurConfig.lMinBaseScore){var n={type:df.OPTION_TYPE_INPUT,title:"游戏底分 :",recordData:this.m_lBaseScore,lMaxBaseScore:this._CurConfig.lMaxBaseScore,lMinBaseScore:this._CurConfig.lMinBaseScore};this.m_ControlListData[t.TYPE_CELL]=n,this.m_wShowCount++}},i.prototype.onFreshUiInfo=function(e){this._scene.dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_BATTLE_REFRESH,!1,!1,e))},i.prototype.onUserCoutChange=function(e,n){if(null!=n){if(this.m_nCurIndex=e,this._CurConfig=n[this.m_nCurIndex],this.m_wPlayerCount=this._CurConfig.wPlayerCount,null!=this.m_controlCompanet[t.TYPE_PAY]&&(this.m_wPayType=df.PAY_TYPE_OWNER,this.m_controlCompanet[t.TYPE_PAY].setSelectedIndex(0)),null!=this.m_controlCompanet[t.TYPE_CURRENCY]&&(this.m_cbCurrencyKind=df.OPTION_MASK_ROOMCARD,this.m_controlCompanet[t.TYPE_CURRENCY].setSelectedIndex(0)),null!=this.m_controlCompanet[t.TYPE_COUNT]&&(this.m_dwBalanceTime=0,this.m_cbSettleKind=df.SETTLE_KIND_COUNT,this.m_wBalanceCount=this._CurConfig.wPlayCount[0],this.m_controlCompanet[t.TYPE_COUNT].setSelectedIndex(0)),null!=this.m_controlCompanet[t.TYPE_TIME]&&(this.m_dwBalanceTime=this._CurConfig.dwPlayTime[0],this.m_wBalanceCount=0,this.m_cbSettleKind=df.SETTLE_KIND_TIME,this.m_controlCompanet[t.TYPE_TIME].setSelectedIndex(0)),null!=this.m_controlCompanet[t.TYPE_CELL]&&this.m_controlCompanet[t.TYPE_CELL].setOrignalCell(this._CurConfig.lMinBaseScore),null!=this.m_controlCompanet[t.TYPE_OTHER])for(var i=0;i<this._configSpecial.length;i++)null!=this.m_controlCompanet[t.TYPE_OTHER][i]&&(this.m_controlCompanet[t.TYPE_OTHER][i].onResetView(),this._configSpecial[i].type==df.OPTION_TYPE_SINGLE?(this.m_controlCompanet[t.TYPE_OTHER][i].setSelectedIndex(0),this.m_OtherOption[i]=0):this._configSpecial[i].type==df.OPTION_TYPE_INPUT?this.m_OtherOption[i]=this.m_controlCompanet[t.TYPE_OTHER][i].getInputValue():this.m_OtherOption[i]=0);this.onConfigChangeEvent(t.TYPE_USERCOUNT,e)}},i.prototype.onTimeChange=function(e,n){this.m_dwBalanceTime=n[this.m_nCurIndex].dwPlayTime[e]?n[this.m_nCurIndex].dwPlayTime[e]:0,null!=this.m_ControlListData[t.TYPE_COUNT]&&(this.m_wBalanceCount=0,this.m_cbSettleKind=df.SETTLE_KIND_TIME,this.m_controlCompanet[t.TYPE_COUNT].onResetView()),this.onConfigChangeEvent(t.TYPE_COUNT,e)},i.prototype.onRoundChange=function(e,n){this.m_wBalanceCount=n[this.m_nCurIndex].wPlayCount[e]?n[this.m_nCurIndex].wPlayCount[e]:0,null!=this.m_ControlListData[t.TYPE_TIME]&&(this.m_dwBalanceTime=0,this.m_cbSettleKind=df.SETTLE_KIND_COUNT,this.m_controlCompanet[t.TYPE_TIME].onResetView()),this.onConfigChangeEvent(t.TYPE_TIME,e)},i.prototype.onCustomChange=function(e,n,i){var r=i[e];if(!(null==r||this.m_controlCompanet[t.TYPE_OTHER].length<=e)){if(r.type==df.OPTION_TYPE_SINGLE)this.m_OtherOption[e]=this.m_controlCompanet[t.TYPE_OTHER][e].getSelectedIndex();else if(r.type==df.OPTION_TYPE_MULTIPLE){var o=this.m_controlCompanet[t.TYPE_OTHER][e].getSelectedValue();this.m_OtherOption[e]=o[n]}r.items[n]&&r.items[n].price&&this.onConfigChangeEvent(t.TYPE_OTHER,e,n)}},i.prototype.onConfigChangeEvent=function(e,n,i){if(null!=this._CurConfig){var r=0,o=0,s=0;this._CurConfig.lMinBaseScore&&0!=this._CurConfig.lMinBaseScore&&this._CurConfig.lMinBaseScore==this._CurConfig.lMaxBaseScore&&(r=this._CurConfig.lMinBaseScore);var a=this.m_wPayType==df.PAY_TYPE_OWNER,c=this.m_cbCurrencyKind==df.CURRENCY_KIND_ROOMCARD,_=this.m_cbSettleKind==df.SETTLE_KIND_COUNT?t.TYPE_COUNT:t.TYPE_TIME;if(null!=this.m_controlCompanet[_]){var l=this.m_controlCompanet[_].getSelectedIndex();l>=0&&this._CurConfig.wPlayCount[l]&&(c?o=(o?o:0)+(a?this._CurConfig.lRoomCard_Owner[l]:this._CurConfig.lRoomCard[l]):s=(s?s:0)+(a?this._CurConfig.lConsumeIngot_Owner[l]:this._CurConfig.lConsumeIngot[l]))}var h=this.m_controlCompanet[t.TYPE_OTHER];if(this._configSpecial.length>0&&null!=h)for(var u=this._configSpecial.length,d=0;u>d;d++)if(null!=h[d]&&this._configSpecial[d].type==df.OPTION_TYPE_SINGLE&&this._configSpecial[d].items){var p=h[d].getSelectedIndex();if(null!=this._configSpecial[d].items[p])if(c){var m=Number(this._configSpecial[d].items[p].card);o+=m}else{var g=Number(this._configSpecial[d].items[p].price);s+=g}}null!=this.m_controlCompanet[t.TYPE_CELL]&&(this.m_lBaseScore=r=Math.max(this.m_controlCompanet[t.TYPE_CELL].getInputValue(),this._CurConfig.lMinBaseScore)),this.onFreshUiInfo({baseScore:r,card:o,diamond:s,bRoomCard:c})}},i.prototype.getConfigResult=function(){var e={wKindID:0,wPlayerCount:0,cbSettleKind:0,wPlayCount:0,dwPlayTime:0,lBaseScore:0,wPayType:0,cbCurrencyKind:0,options:[]};e.wKindID=Number(this._kindID),e.wPlayerCount=Number(this.m_wPlayerCount),e.cbSettleKind=Number(this.m_cbSettleKind),e.wPlayCount=Number(this.m_wBalanceCount),e.dwPlayTime=Number(this.m_dwBalanceTime),e.lBaseScore=Number(this.m_lBaseScore),e.wPayType=Number(this.m_wPayType),e.cbCurrencyKind=Number(this.m_cbCurrencyKind);for(var t=0;t<this.m_OtherOption.length;t++)e.options.push(this.m_OtherOption[t]);return e},i}(egret.Sprite);e.CreateConfigView=i,__reflect(i.prototype,"client.CreateConfigView")}(client||(client={}));var controller;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.name="LoginController",t.createLoginScene(),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,t.onTouchBegan,t),t.addEventListener(egret.TouchEvent.TOUCH_MOVE,t.onTouchMove,t),t.addEventListener(egret.TouchEvent.TOUCH_END,t.onTouchEnd,t),t.addEventListener(customEvent.CustomEvent.EVENT_ENTER_BACKGROUND,t.applicationWillEnterForeground,t),t.addEventListener(customEvent.CustomEvent.EVENT_BECOME_ACTIVE,t.applicationDidBecomeActive,t),t}return __extends(t,e),t.prototype.viewWillAppear=function(e){console.log("LoginController viewWillAppear")},t.prototype.viewDidAppear=function(e){console.log("LoginController viewDidAppear")},t.prototype.viewWillDisappear=function(e){console.log("LoginController viewWillDisappear")},t.prototype.viewDidDisappear=function(e){console.log("LoginController viewDidDisappear")},t.prototype.dealloc=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.removeEventListener(customEvent.CustomEvent.EVENT_ENTER_BACKGROUND,this.applicationWillEnterForeground,this),this.removeEventListener(customEvent.CustomEvent.EVENT_BECOME_ACTIVE,this.applicationDidBecomeActive,this),console.log("LoginController dealloc")},t.prototype.applicationDidBecomeActive=function(e){console.log("登录场景-进入前台")},t.prototype.applicationWillEnterForeground=function(e){console.log("登录场景-进入后台")},t.prototype.createLoginScene=function(){var e=utils.createBitmapByName("background_png");this.addChild(e);var t=new client.LogonLayer;this.addChild(t)},t.prototype.onTouchBegan=function(e){console.log("onTouch Began")},t.prototype.onTouchMove=function(e){console.log("onTouch move")},t.prototype.onTouchEnd=function(e){console.log("onTouch end")},t}(models.Controller);e.LoginController=t,__reflect(t.prototype,"controller.LoginController",["df.IController"])}(controller||(controller={}));var controller;!function(e){var t=function(t){function n(){var e=t.call(this)||this;return e.name="WelComeController",managers.FrameManager.getInstance().setRunningController(e),e.createWelComeView(),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,e.onTouchBegan,e),e.addEventListener(egret.TouchEvent.TOUCH_MOVE,e.onTouchMove,e),e.addEventListener(egret.TouchEvent.TOUCH_END,e.onTouchEnd,e),e}return __extends(n,t),n.prototype.viewWillAppear=function(e){},n.prototype.viewDidAppear=function(e){},n.prototype.viewWillDisappear=function(e){},n.prototype.viewDidDisappear=function(e){},n.prototype.dealloc=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},n.prototype.applicationDidBecomeActive=function(e){},n.prototype.applicationWillEnterForeground=function(e){},n.prototype.createWelComeView=function(){return __awaiter(this,void 0,void 0,function(){var t,n,i,r,o,s;return __generator(this,function(a){switch(a.label){case 0:return t=utils.createBitmapByName("background_png"),this.addChild(t),n=utils.createBitmapByName("logo_name_00_png"),this.addChild(n),utils.setAnchorCenter(n),n.x=667,n.y=330,egret.Tween.get(n,{loop:!0}).to({alpha:.2},2e3).to({alpha:1},2e3),i=utils.createBitmapByName("copyright_png"),this.addChild(i),utils.setAnchorMidBottom(i),i.x=667,i.y=700,r=new egret.TextField,r.textColor=16777215,r.name="tips",r.textAlign="center",r.text="资源加载中,请稍后...",r.size=24,utils.setAnchorCenter(r),r.x=667,r.y=540,this.addChild(r),o=function(){managers.FrameManager.getInstance().replaceScene(new e.LoginController,!0)},s=new models.Loading(o),s.direction=eui.Direction.LTR,s.skinName=skins.ProgressBarSkin_1,s.maximum=1e3,s.minimum=0,s.name="loading",s.value=10,s.labelDisplay.visible=!1,this.addChild(s),utils.setAnchorCenter(s),s.x=667,s.y=580,[4,this.loadPlazaResource()];case 1:return a.sent(),this.httpGetLogonInfo().then(function(){s.finishLoading()}),[2]}})})},n.prototype.loadPlazaResource=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return t.trys.push([0,25,,26]),[4,RES.loadGroup("preload",0)];case 1:return t.sent(),[4,RES.loadGroup("Active",0,this)];case 2:return t.sent(),[4,RES.loadGroup("Battle",0,this)];case 3:return t.sent(),[4,RES.loadGroup("Benefit",0,this)];case 4:return t.sent(),[4,RES.loadGroup("Chat",0,this)];case 5:return t.sent(),[4,RES.loadGroup("CopyRight",0,this)];case 6:return t.sent(),[4,RES.loadGroup("Dismiss",0,this)];case 7:return t.sent(),[4,RES.loadGroup("GameList",0,this)];case 8:return t.sent(),[4,RES.loadGroup("General",0,this)];case 9:return t.sent(),[4,RES.loadGroup("GPS",0,this)];case 10:return t.sent(),[4,RES.loadGroup("Head",0,this)];case 11:return t.sent(),[4,RES.loadGroup("Logon",0,this)];case 12:return t.sent(),[4,RES.loadGroup("MoreSub",0,this)];case 13:return t.sent(),[4,RES.loadGroup("NewChat",0,this)];case 14:return t.sent(),[4,RES.loadGroup("Option",0,this)];case 15:return t.sent(),[4,RES.loadGroup("PlazaShare",0,this)];case 16:return t.sent(),[4,RES.loadGroup("Rank",0,this)];case 17:return t.sent(),[4,RES.loadGroup("Regist",0,this)];case 18:return t.sent(),[4,RES.loadGroup("Reward",0,this)];case 19:return t.sent(),[4,RES.loadGroup("RoomList",0,this)];case 20:return t.sent(),[4,RES.loadGroup("Shop",0,this)];case 21:return t.sent(),[4,RES.loadGroup("UserInfo",0,this)];case 22:return t.sent(),[4,RES.loadGroup("Video",0,this)];case 23:return t.sent(),[4,RES.loadGroup("GameInfo",0,this)];case 24:return t.sent(),[3,26];case 25:return e=t.sent(),console.error(e),[3,26];case 26:return[2]}})})},n.prototype.onProgress=function(e,t){var n=this.getChildByName("loading");n.value+1<=n.maximum&&(n.value+=1)},n.prototype.onTouchBegan=function(e){console.log("onTouch Began")},n.prototype.onTouchMove=function(e){console.log("onTouch move")},n.prototype.onTouchEnd=function(e){console.log("onTouch end")},n.prototype.httpGetLogonInfo=function(){var e=this,t=this.getChildByName("tips");t.text="加载登录信息中...";this.getChildByName("loading");return new Promise(function(t){e.ReLoadHttpInfo().then(function(){t()})["catch"](function(e){var t=JSON.parse(localStorage.getItem("LogonAccess"));t.domin&&t.port&&t.webAddr?(managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.domain=t.domin,managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.port=t.port,managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.webAddr=t.webAddr):managers.FrameManager.getInstance().showToast("登录信息获取失败")})})},n.prototype.ReLoadHttpInfo=function(){var e=this;return new Promise(function(t,n){var i="http://service.foxuc.com/GetAppService.ashx?action=GetLogonServer",r="BaseVersion="+df.APP_VERSION+"&AppSource="+df.APP_SOURCE,o=function(e){console.log("请求成功");var n=JSON.parse(e.target.response);if(null==n)console.log("json Error");else{n=n.Data,n.DomainGetLogon&&n.PortGetLogon&&n.WebAddress||t(),managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.domain=n.DomainGetLogon,managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.port=Number(n.PortGetLogon),managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.webAddr=n.WebAddress,managers.TcpServiceCtrl.getInstance().URL_RECHARGE_CARD=n.WebAddress+"/Ashx/ProService.ashx",managers.TcpServiceCtrl.getInstance().ZFB_CALLBACK_URL=n.WebAddress+"/ZFB/App/notify_url.aspx";var i={domin:"",port:0,webAddr:""};i.domin=n.DomainGetLogon,i.port=Number(n.PortGetLogon),i.webAddr=n.WebAddress,localStorage.setItem("LogonAccess",JSON.stringify(i))}t()},s=function(e){console.log("请求失败"),t()};utils.HttpRequest.createHttpRequest(e,i,r,egret.HttpMethod.POST,o,s)})},n}(models.Controller);e.WelComeController=t,__reflect(t.prototype,"controller.WelComeController",["df.IController","RES.PromiseTaskReporter"])}(controller||(controller={}));var client;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n._datas=[],n._bMoved=!1,n._scene=t,n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},t.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.BenefitLayer;var t=e.getChildByName("bt_close");t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),this._scroller=e.getChildByName("scroller"),this._datas=[0,1,2,4,3],this.initBenefit(this._datas)},t.prototype.initBenefit=function(e){for(var t=this._scroller.getChildByName("Group"),n=0;n<e.length;n++){var i=new eui.Button,r=e[n];i.name="benefit_"+n,i.skinName="resource/eui_skins/benefit/Benefit"+r+".exml",t.addChild(i),utils.setAnchorCenter(i),i.x=this._scroller.width/2,i.y=60+120*n,i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this)}},t.prototype.onButtonClick=function(e){var t=e.target,n=t.name;switch(egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},100).to({scaleX:1,scaleY:1},100),n){case"bt_close":this._scene.onChangeView();break;case"benefit_0":if(1==this._bMoved)return;
break;case"benefit_1":if(1==this._bMoved)return;break;case"benefit_2":if(1==this._bMoved)return;break;case"benefit_3":if(1==this._bMoved)return;break;case"benefit_4":if(1==this._bMoved)return}},t.prototype.onExit=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},t.prototype.onTouchBegan=function(e){this._bMoved=!1},t.prototype.onTouchMove=function(e){this._bMoved=!0},t.prototype.onTouchEnd=function(e){},t}(eui.UILayer);e.BenefitLayer=t,__reflect(t.prototype,"client.BenefitLayer")}(client||(client={}));var client;!function(e){var t=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.OperateRigest=0,e.OperateLogin=1,e.OperateWechat=2,e._operateCode=e.OperateLogin,e._account="",e._password="",e._tipsInfo=[],e._isAutoLogon=!1,e._isHandInput=!1,e}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.name="LogonLayer";var e=df.STATION_ID;2008==e?this._tipsInfo=["你好，我是贝拉，登录遇到困难？点我可以获得帮助哦！","注册帐号，您可以使用游戏中的更多功能！"]:this._tipsInfo=["你好，我是劳拉，登录遇到困难？点我可以获得帮助哦！","注册帐号，您可以使用游戏中的更多功能！"],this.onInitLayer(),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},n.prototype.childrenCreated=function(){t.prototype.childrenCreated.call(this)},n.prototype.onInitLayer=function(){var t=this;this._component=new eui.Component,this.addChild(this._component),this._component.skinName=skins.LogonLayer,managers.FrameManager.getInstance().getRunningController().setRoot(this),this.onChangeView(df.MODE_CHOOSE),this._tipsLabel=this._component.getChildByName("tips_label"),this._tipsLabel.text=this._tipsInfo[0];var n=this._tipsLabel.width,i=this._tipsLabel.height,r=this._component.getChildByName("tips_bg");r.width=n+40,r.height=i+60,utils.setAnchorLeftBottom(r),r.x=188,r.y=248,this._bubble=r,this._lora=this._component.getChildByName("bt_lora"),this._lora.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this);var o=["清凉一夏,昏地主来袭","平台严禁赌博"];this._rollNotice=models.RollNotice.createNotice("general_notice_bg_png",700,44,o,!0,1,"general_notice_icon_png"),utils.setAnchorMidTop(this._rollNotice),this.addChild(this._rollNotice),this._rollNotice.x=667,this._rollNotice.y=10,this._rollNotice.setTouchHandler(function(n){console.log("系统公告");var i=managers.FrameManager.getInstance().getRunningController();i.addWindow(new e.NoticeLayer(t,df.MODE_NOTICE))});var s=this._component.getChildByName("btn_service");if(s.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),this._serviceBtn=s,s=this._component.getChildByName("btn_set"),s.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),this._optionBtn=s,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this._localStorage=JSON.parse(localStorage.getItem("Logon")),null!=this._localStorage){var a=this._localStorage?this._localStorage.isAuto:0;this._isAutoLogon=1==Number(a)?!0:!1,setTimeout(function(){t._isAutoLogon&&managers.FrameManager.getInstance().m_IsAuto&&(t._account=t._localStorage.account,t._password=t._localStorage.password,t.onLogon())},600)}},n.prototype.onChangeView=function(t){var n=managers.FrameManager.getInstance().getRunningController();if(null==t)n.popView(),this._lora.visible=!0,this._bubble.visible=!0,this._tipsLabel.visible=!0,this._optionBtn.visible=!0,this._rollNotice.visible=!0,this._serviceBtn.visible=!0;else switch((t==df.MODE_SERVICE||t==df.MODE_OPTION)&&(this._lora.visible=!1,this._bubble.visible=!1,this._tipsLabel.visible=!1,this._optionBtn.visible=!1,this._rollNotice.visible=!1,this._serviceBtn.visible=!1),t){case df.MODE_CHOOSE:var i=new e.LogonModeView(this);i.x=-this.width,i.y=0,n.showView(i,0,!0);break;case df.MODE_ACCOUNT:var r=new e.LogonView(this);r.x=-this.width,r.y=0,n.showView(r,0,!0);break;case df.MODE_REGISTER:var o=new e.Regist(this);o.x=-this.width,o.y=0,n.showView(o,0,!0);break;case df.MODE_SERVICE:var s=new e.ServiceLayer(this);s.x=-this.width,s.y=0,n.showView(s,0,!0);break;case df.MODE_OPTION:var a=new e.OptionLayer(this);a.x=-this.width,a.y=0,n.showView(a,0,!0)}},n.prototype.onButtonClickEvent=function(e){var t=e.target;egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50);switch(t.name){case"btn_service":case"bt_lora":this.onChangeView(df.MODE_SERVICE);break;case"btn_set":this.onChangeView(df.MODE_OPTION)}},n.prototype.onRegist=function(){this._operateCode=this.OperateRigest,this._LogonFrame=new frame.LogonFrame(this),managers.TcpServiceCtrl.getInstance().onConnectPlaza(),managers.TcpServiceCtrl.getInstance().setDelegate(this._LogonFrame),managers.FrameManager.getInstance().showPopWait("正在加载中")},n.prototype.onLogon=function(){this._operateCode=this.OperateLogin,this._LogonFrame=new frame.LogonFrame(this),managers.TcpServiceCtrl.getInstance().onConnectPlaza(),managers.TcpServiceCtrl.getInstance().setDelegate(this._LogonFrame),managers.FrameManager.getInstance().showPopWait("正在加载中")},n.prototype.connectComplete=function(){var e=managers.TcpServiceCtrl.getInstance(),t=e.getTcpService();if(this._operateCode==this.OperateRigest){this._isHandInput=!0;var n=df.CMD_MB_RegisterAccounts_WEB();n.wModuleID=df.INVALID_WORD,n.wMarketID=df.MARKET_ID,n.cbDeviceType=df.DEVICE_TYPE,n.dwAppVersion=utils.PROCESS_VERSION(1,1,0,1),n.dwPlazaVersion=utils.PROCESS_VERSION(1,1,0,0),n.dwStationID=df.STATION_ID,n.szLogonPass=utils.MD5.MD5_HEX(this._password),n.wFaceID=Math.floor(19*Math.random()),n.cbGender=Math.floor(2*Math.random()),n.szAccounts=this._account,n.szNickName=this._account,n.szMachineID=utils.StringUtils.getGUID(),n.szMobilePhone="",this._LogonFrame.sendRegister(t,n)}else{var i=df.CMD_MB_LogonAccounts_WEB();i.wModuleID=df.INVALID_WORD,i.wMarketID=df.MARKET_ID,i.cbDeviceType=df.DEVICE_TYPE,i.dwAppVersion=utils.PROCESS_VERSION(1,1,0,1),i.dwPlazaVersion=utils.PROCESS_VERSION(1,1,0,1),i.dwStationID=df.STATION_ID,i.dwMappedNum=0,i.szPassword=utils.MD5.MD5_HEX(this.getPassWord()),i.szAccounts=this._account,i.szMachineID="",i.szMobilePhone="",this._LogonFrame.sendLogon(t,i)}},n.prototype.getPloatForm=function(){return this._operateCode==this.OperateWechat?df.ACCOUNT_TYPE_SELF:df.ACCOUNT_TYPE_WECHAT},n.prototype.getPassWord=function(){return this._isHandInput?this._password:utils.StringUtils.array2string(egret.Base64Util.decode(this._password))},n.prototype.getAutoLogon=function(){return this._isAutoLogon?1:0},n.prototype.onTouchBegan=function(e){console.log("onTouch Began")},n.prototype.onTouchMove=function(e){console.log("onTouch move")},n.prototype.onTouchEnd=function(e){console.log("onTouch end")},n.prototype.onExit=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this._LogonFrame.removeEventListener(),managers.TcpServiceCtrl.getInstance().setDelegate(null),managers.FrameManager.getInstance().getRunningController()._viewFrame=null,this._LogonFrame=null,managers.FrameManager.getInstance().m_IsAuto=this._isAutoLogon},n}(eui.UILayer);e.LogonLayer=t,__reflect(t.prototype,"client.LogonLayer")}(client||(client={}));var client;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n._scene=t,n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this)},t.prototype.onInitLayer=function(){this.touchEnabled=!1,this.name="LogonMode";var e=new eui.Component;this.addChild(e),e.skinName=skins.LogonModeView;var t=e.getChildByName("bt_account_logon");t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),t=e.getChildByName("bt_wechat_logon"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),t=e.getChildByName("bt_regist_account"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this)},t.prototype.onButtonClickEvent=function(e){var t=e.target;egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50);switch(t.name){case"bt_account_logon":this._scene.onChangeView(df.MODE_ACCOUNT);break;case"bt_wechat_logon":managers.FrameManager.getInstance().showDailog(0,"未找到微信应用程序,请检查是否安装",null);break;case"bt_regist_account":this._scene.onChangeView(df.MODE_REGISTER)}},t}(eui.UILayer);e.LogonModeView=t,__reflect(t.prototype,"client.LogonModeView")}(client||(client={}));var client;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n._scene=t,n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this)},t.prototype.onInitLayer=function(){this.touchEnabled=!1,this.name="LogonView";var e=new eui.Component;this.addChild(e),e.skinName=skins.LogonView;var t=e.getChildByName("bt_return");t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),t=e.getChildByName("bt_regist"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),t=e.getChildByName("bt_logon"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),this._accountTextInput=e.getChildByName("input_account"),this._accountTextInput.addEventListener(egret.Event.CHANGE,this.onChange,this),this._accountTextInput.prompt="请输入账号",this._accountTextInput.maxChars=df.LEN_ACCOUNTS,null!=this._scene._localStorage&&(this._accountTextInput.text=this._scene._localStorage.account,this._scene._account=this._scene._localStorage.account),this._passwordTextInput=e.getChildByName("input_password"),this._passwordTextInput.addEventListener(egret.Event.CHANGE,this.onChange,this),this._passwordTextInput.prompt="请输入密码",this._passwordTextInput.maxChars=df.LEN_PASSWORD,null!=this._scene._localStorage&&(this._passwordTextInput.text=this._scene._localStorage.password,this._scene._password=this._scene._localStorage.password);var n=e.getChildByName("auot_checkbox");n.addEventListener(eui.UIEvent.CHANGE,this.onEventChange,this),n.selected=this._scene._isAutoLogon},t.prototype.onChange=function(e){this._scene._isHandInput=!0;var t=e.currentTarget;t==this._accountTextInput&&(this._passwordTextInput.text="")},t.prototype.onEventChange=function(e){e.target;this._scene._isAutoLogon=!this._scene._isAutoLogon,managers.FrameManager.getInstance().m_IsAuto=this._scene._isAutoLogon},t.prototype.onButtonClickEvent=function(e){var t=e.target;if(t instanceof eui.Button){egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50)}switch(t.name){case"bt_return":this._scene.onChangeView();break;case"bt_regist":this._scene.onChangeView(df.MODE_REGISTER);break;case"bt_logon":if(0==this._accountTextInput.text.length)return void managers.FrameManager.getInstance().showToast("请输入账号");if(0==this._passwordTextInput.text.length)return void managers.FrameManager.getInstance().showToast("请输入密码");if(this._accountTextInput.text.length<6)return void managers.FrameManager.getInstance().showToast("您的账号不存在,请重新输入");if(this._passwordTextInput.text.length<6)return void managers.FrameManager.getInstance().showToast("您的密码不存在或者输入有误,请重新输入");this._scene._account=this._accountTextInput.text,this._scene._password=this._passwordTextInput.text,this._scene.onLogon()}},t}(eui.UILayer);e.LogonView=t,__reflect(t.prototype,"client.LogonView")}(client||(client={}));var client;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n.m_bAgree=!1,n._scene=e,n}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.name="RegistView",this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},n.prototype.onInitLayer=function(){this.touchEnabled=!1,this.name="RegistView";var e=new eui.Component;this.addChild(e),e.skinName=skins.RegistView;var t=e.getChildByName("bt_return");t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),t=e.getChildByName("bt_confirm"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this);var n=e.getChildByName("agree_checkbox");n.addEventListener(eui.UIEvent.CHANGE,this.onEventChange,this);var i=e.getChildByName("bt_service");i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),this._nameInput=e.getChildByName("input_account"),this._nameInput.prompt="请输入账号",this._nameInput.maxChars=31,this._passInput=e.getChildByName("input_password"),this._passInput.prompt="请输入密码",this._passInput.maxChars=31},n.prototype.onEventChange=function(e){this.m_bAgree=!this.m_bAgree},n.prototype.onButtonClickEvent=function(t){var n=t.target;if(n instanceof eui.Button){egret.Tween.get(n).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50)}if("bt_return"==n.name)this._scene.onChangeView();else if("bt_service"==n.name){var i=managers.FrameManager.getInstance().getRunningController();i.addWindow(new e.NoticeLayer(i.getRootLayer(),df.MODE_AGREE))}else if("bt_confirm"==n.name){if(!this.m_bAgree)return void managers.FrameManager.getInstance().showToast("请先阅读并接受用户服务协议");if(0==this._nameInput.text.length)return void managers.FrameManager.getInstance().showToast("请输入账号");if(0==this._passInput.text.length)return void managers.FrameManager.getInstance().showToast("请输入密码");if(this._nameInput.text.length<6||this._nameInput.text.length>31)return void managers.FrameManager.getInstance().showToast("游戏账号必须为6~31个字符,请重新输入!");if(this._passInput.text.length<6||this._nameInput.text.length>31)return void managers.FrameManager.getInstance().showToast("游戏密码必须为6~31个字符,请重新输入!");this._scene._account=this._nameInput.text,this._scene._password=this._passInput.text,this._scene.onRegist()}},n.prototype.onExit=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},n.prototype.onTouchBegan=function(e){console.log("onTouch Began")},n.prototype.onTouchMove=function(e){console.log("onTouch move")},n.prototype.onTouchEnd=function(e){console.log("onTouch end")},n}(eui.UILayer);e.Regist=t,__reflect(t.prototype,"client.Regist")}(client||(client={}));var client;!function(e){var t=function(e){function t(t,n){void 0===n&&(n=0);var i=e.call(this)||this;return i._scene=t,i._kindID=n,i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},t.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.GameHelpLayer;var t=e.getChildByName("bt_close");t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this)},t.prototype.onButtonClickEvent=function(e){var t=e.target;(t.name="bt_close")&&this._scene.removeChild(this)},t.prototype.onExit=function(){},t}(eui.UILayer);e.GameHelp=t,__reflect(t.prototype,"client.GameHelp")}(client||(client={}));var client;!function(e){var t=("http://service.foxuc.com/GameNotice.aspx?StationID="+df.STATION_ID+"&TypeID=1&KindID=0","http://service.foxuc.com/GameNotice.aspx?StationID="+df.STATION_ID+"&TypeID=2&KindID=1","http://service.foxuc.com/GameMatch.aspx?PlazaStation="+df.STATION_ID+"&TypeID=1&MatchID=",function(e){function t(t,n,i){var r=e.call(this)||this;return r._scene=t,r._mode=n,r}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},t.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.NoticeLayer;var t=e.getChildByName("panel_normal"),n=t.getChildByName("bt_close");n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this);var i=t.getChildByName("panel_title");if(i.$children.forEach(function(e){e.visible=!1}),this._mode==df.MODE_NOTICE){var r=i.getChildByName("title_notice");r.visible=!0}else if(this._mode==df.MODE_AGREE){var r=i.getChildByName("title_agree");r.visible=!0;var o=new exp.WebView;utils.setAnchorCenter(o),o.src="http://developer.egret.com",o.width=400,o.height=500,o.x=200,o.y=100,this.addChild(o)}},t.prototype.onButtonClickEvent=function(e){var t=e.target;(t.name="bt_close")&&this._scene.removeChild(this)},t.prototype.onExit=function(){},t}(eui.UILayer));e.NoticeLayer=t,__reflect(t.prototype,"client.NoticeLayer")}(client||(client={}));var client;!function(e){var t=function(e){function t(t,n){void 0===n&&(n=0);var i=e.call(this)||this;return i._scene=t,i._mode=n,i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},t.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.OptionLayer,this.touchEnabled=!0,this._bg_normal=e.getChildByName("bg_normal"),this._bg_extern=e.getChildByName("bg_extern");var t=e.getChildByName("panel_switch0"),n=e.getChildByName("panel_switch1");this._check_option=n.getChildByName("check_option"),this._check_confirm=n.getChildByName("check_confirm"),this._check_change=n.getChildByName("check_change"),this._panel_option=e.getChildByName("panel_option"),this._panel_confirm=e.getChildByName("panel_confirm"),this._panel_change=e.getChildByName("panel_change"),this._check_option.addEventListener(eui.UIEvent.CHANGE,this.onEventChange,this),this._check_confirm.addEventListener(eui.UIEvent.CHANGE,this.onEventChange,this),this._check_change.addEventListener(eui.UIEvent.CHANGE,this.onEventChange,this),0==this._mode?(t.visible=!0,n.visible=!1,this._bg_normal.visible=!0,this._bg_extern.visible=!1):1==this._mode&&(t.visible=!1,n.visible=!0,this._bg_normal.visible=!1,this._bg_extern.visible=!0),this.initOption(),this.initCertification(),this.initChangeAccount();var i=e.getChildByName("bt_return");i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this)},t.prototype.initOption=function(){},t.prototype.initCertification=function(){},t.prototype.initChangeAccount=function(){var e=this._panel_change.getChildByName("bt_change");e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this)},t.prototype.onExit=function(){},t.prototype.onEventChange=function(e){var t=e.target;t==this._check_option?(this._check_confirm.selected=!1,this._check_change.selected=!1,this._panel_option.visible=!0,this._panel_confirm.visible=!1,this._panel_change.visible=!1):t==this._check_confirm?(this._check_option.selected=!1,this._check_change.selected=!1,this._panel_option.visible=!1,this._panel_confirm.visible=!0,this._panel_change.visible=!1):t==this._check_change&&(this._check_option.selected=!1,this._check_confirm.selected=!1,this._panel_option.visible=!1,this._panel_confirm.visible=!1,this._panel_change.visible=!0)},t.prototype.onButtonClickEvent=function(e){var t=e.target;egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50);switch(t.name){case"bt_return":this._scene.onChangeView();break;case"bt_change":managers.FrameManager.getInstance().m_IsAuto=!1;var n=new controller.LoginController;managers.FrameManager.getInstance().replaceScene(n,!0)}},t}(eui.UILayer);e.OptionLayer=t,__reflect(t.prototype,"client.OptionLayer")}(client||(client={}));var client;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n._checkBoxes=[],n._panels=[],n._scene=t,n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},t.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.ServiceLayer;var t=e.getChildByName("bt_return");t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this);for(var n=0;4>n;n++){var i=e.getChildByName("check_"+n);i.addEventListener(eui.UIEvent.CHANGE,this.onEventChange,this),this._checkBoxes.push(i);var r=e.getChildByName("panel_"+n);this._panels.push(r)}},t.prototype.onExit=function(){this._checkBoxes.forEach(function(e){e=null}),this._panels.forEach(function(e){e=null}),this._checkBoxes=null,this._panels=null},t.prototype.onEventChange=function(e){for(var t=e.target,n=0;n<this._checkBoxes.length;n++){var i=this._checkBoxes[n],r=this._panels[n];t==i?(t.selected=!0,r.visible=!0):(i.selected=!1,r.visible=!1)}},t.prototype.onButtonClickEvent=function(e){var t=e.target;if(t instanceof eui.Button){egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50)}"bt_return"==t.name&&this._scene.onChangeView()},t}(eui.UILayer);e.ServiceLayer=t,__reflect(t.prototype,"client.ServiceLayer")}(client||(client={}));var client;!function(e){var t=function(e){function t(t,n,i){return e.call(this,t,n,i)||this}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},t.prototype.onInitLayer=function(){e.prototype.onInitLayer.call(this);var t=new eui.Component;this.addChild(t),t.width=998,t.height=565,utils.setAnchorCenter(t),t.x=this.width/2,t.y=this.height/2,t.skinName=skins.ShareLayer;var n=t.getChildByName("bt_wechat");n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),n=t.getChildByName("bt_circle"),n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),n=t.getChildByName("bt_close"),n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this)},t.prototype.onButtonClickEvent=function(e){var t=e.target;egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50);switch(t.name){case"bt_wechat":break;case"bt_circle":break;case"bt_close":this._scene.removeChild(this)}},t.prototype.onExit=function(){e.prototype.onExit.call(this)},t}(models.MaskExLayer);e.ShareLayer=t,__reflect(t.prototype,"client.ShareLayer")}(client||(client={}));var client;!function(e){var t=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e._gameList=[],e._listBtns=[],e._nCurAniIndex=0,e._kindID=df.INVALID_WORD,e._isTransEnd=!0,e._bMoved=!1,e._shopIndex=0,e}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.name="ClientLayer",this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.addEventListener(customEvent.CustomEvent.EVENT_PLAZA_REFRESH,this.onPlazaRefresh,this)},n.prototype.onInitLayer=function(){var t=this,n=new eui.Component;this.addChild(n),n.skinName=skins.Plaza;var i=n.getChildByName("bt_rank");i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var r=n.getChildByName("bt_share");r.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var o=n.getChildByName("bt_service");o.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var s=n.getChildByName("bt_option");s.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var a=n.getChildByName("bt_shop");a.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var c=n.getChildByName("bt_Ingot_shop");c.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),c=n.getChildByName("bt_gold_shop"),c.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var _=n.getChildByName("bt_exchange");_.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var l=n.getChildByName("bt_activity");l.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var h=n.getChildByName("findBattle");h.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var u=n.getChildByName("battleCreate");u.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var d=n.getChildByName("battleList");d.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var p=n.getChildByName("battleRecord");p.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var m=n.getChildByName("bt_teaHouse");m.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var g=n.getChildByName("bt_match");g.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this);var f=n.getChildByName("Invite_image");egret.assert(null!=f),f.$setTouchEnabled(!1),egret.Tween.get(f,{loop:!0}).to({scaleX:.8,scaleY:.8},800).to({scaleX:1,scaleY:1},800);var E=n.getChildByName("active_icon");egret.assert(null!=E),egret.Tween.get(E,{loop:!0}).to({scaleX:.2,scaleY:.2},300).to({scaleX:1,scaleY:1},300).to({scaleX:1.2,scaleY:1.2},300).wait(500).to({scaleX:.2,scaleY:.2},300).to({scaleX:1,scaleY:1},300).to({scaleX:1.2,scaleY:1.2},300);var C=n.getChildByName("lightScroll"),v=C.getChildByName("lightGroup"),S=v.getChildByName("light");egret.Tween.get(S,{loop:!0}).to({x:-15,y:100},1200).wait(2e3);for(var T=0;5>T;T++){var I="star"+(T+1),y=1e3*Math.random(),R=n.getChildByName(I);egret.Tween.get(R,{loop:!0}).to({alpha:1,rotation:90,scaleX:1},1e3).to({alpha:0,rotation:180,scaleX:.1},1e3).wait(y)}var D=(n.getChildByName("head_frame"),function(e){console.log("头像触摸"),t.onChangeView(df.MODE_USER_INFO)}),w=managers.FrameManager.getInstance().m_GlobalUserItem,A=models.HeadSprite.createHead(w,120,120,40,40,!0,D);utils.setAnchorLeftTop(A),this.addChild(A),A.x=0,A.y=0;var b=n.getChildByName("nick");b.text=managers.FrameManager.getInstance().m_GlobalUserItem.szNickName;var O=n.getChildByName("gameid");O.text=""+managers.FrameManager.getInstance().m_GlobalUserItem.dwGameID;var L=managers.FrameManager.getInstance().m_GlobalUserItem.lUserIngot;this._dimondLabel=utils.LabelAtlas.createLabel(utils.StringUtils.formatNumberThousands(L),"general_num_list_ingot_png",",0123456789",15,26),this.addChild(this._dimondLabel),utils.setAnchorLeftTop(this._dimondLabel),this._dimondLabel.x=425,this._dimondLabel.y=21;var N=managers.FrameManager.getInstance().m_GlobalUserItem.lUserScore;this._userScoreLabel=utils.LabelAtlas.createLabel(utils.StringUtils.formatNumberThousands(N),"general_num_list_gold_png",",0123456789",15,26),this.addChild(this._userScoreLabel),utils.setAnchorLeftTop(this._userScoreLabel),this._userScoreLabel.x=752,this._userScoreLabel.y=21;var M=["清凉一夏,昏地主来袭","平台严禁赌博"];this._rollNotice=models.RollNotice.createNotice("general_notice_bg_png",700,44,M,!0,0,"general_notice_icon_png"),utils.setAnchorMidTop(this._rollNotice),this.addChild(this._rollNotice),this._rollNotice.x=720,this._rollNotice.y=60,this._rollNotice.setTouchHandler(function(n){if(console.log("系统公告"),t._isTransEnd){var i=managers.FrameManager.getInstance().getRunningController();i.addWindow(new e.NoticeLayer(i.getRootLayer(),df.MODE_NOTICE))}});for(var B=managers.TcpServiceCtrl.getInstance().getGameListInfo()._Info,T=0;T<B.length;T++)B[T]&&B[T].show&&this._gameList.push(B[T]);this._listView=n.getChildByName("GameListScorll"),this._listView.addEventListener(egret.Event.CHANGE,this.onScrollerChange,this);for(var U=this._listView.getChildByName("Group"),T=0;T<this._gameList.length;T++){var G=new eui.Button;G.name=this._gameList[T].id,G.skinName="resource/eui_skins/list/battle_list_"+this._gameList[T].id+".exml",U.addChild(G),G.addEventListener(egret.TouchEvent.TOUCH_END,this.onButtonClick,this),utils.setAnchorCenter(G),G.x=G.width/2,G.y=G.height/2+160*T,this._listBtns.push(G);var P=new eui.Image("general_mask_bg_png");P.name="mask",G.addChild(P),utils.setAnchorCenter(P),P.x=G.width/2,P.y=G.height/2,P.visible=!1;var x=new eui.Image("general_mask_png");x.name="light",G.addChild(x),utils.setAnchorLeftTop(x),x.x=0,x.y=0,x.visible=!1,x.mask=P}this.listLightAni(),this._pageUp=n.getChildByName("PageUp"),this._pageDown=n.getChildByName("PageDown"),this._pageUp.visible=!1,egret.Tween.get(this._pageUp,{loop:!0}).to({scaleX:1.5,scaleY:1.5},500).to({scaleX:1,scaleY:1},500).wait(500).to({scaleX:1.5,scaleY:1.5},500).to({scaleX:1,scaleY:1},500),egret.Tween.get(this._pageDown,{loop:!0}).to({scaleX:1.5,scaleY:1.5},500).to({scaleX:1,scaleY:1},500).wait(500).to({scaleX:1.5,scaleY:1.5},500).to({scaleX:1,scaleY:1},500)},n.prototype.viewWillDisappear=function(){console.log("ClientLayer viewWillDisappear")},n.prototype.transAnibegin=function(){this._isTransEnd=!1,console.log("ClientLayer transAnibegin")},n.prototype.transFinish=function(){console.log("ClientLayer transAniFinish"),this._isTransEnd=!0,0!=managers.FrameManager.getInstance().m_GlobalUserItem.wLockServerID&&managers.FrameManager.getInstance().m_GlobalUserItem.wLockServerID!=df.INVALID_WORD},n.prototype.connectComplete=function(){},n.prototype.onUpdateUserWealth=function(){var e=managers.FrameManager.getInstance().m_GlobalUserItem.lUserIngot;this._dimondLabel.initWithString(utils.StringUtils.formatNumberThousands(e),"general_num_list_ingot_png",",0123456789",15,26);var t=managers.FrameManager.getInstance().m_GlobalUserItem.lUserScore;this._userScoreLabel.initWithString(utils.StringUtils.formatNumberThousands(t),"general_num_list_gold_png",",0123456789",15,26)},n.prototype.onExit=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.removeEventListener(customEvent.CustomEvent.EVENT_PLAZA_REFRESH,this.onPlazaRefresh,this)},n.prototype.onChangeView=function(t){var n=managers.FrameManager.getInstance().getRunningController();if(null==t)n.popView();else if(t==df.MODE_PLAZA_OPTION){var i=new e.OptionLayer(this,1);i.name="OPTION",i.x=this.width,i.y=0,n.showView(i,1,!0)}else if(t==df.MODE_SERVICE){var r=new e.ServiceLayer(this);r.x=this.width,r.y=0,r.name="SERVICE",n.showView(r,1,!0)}else if(t==df.MODE_USER_INFO){var o=new e.UserInfoLayer(this);o.x=this.width,o.y=0,o.name="USERINFO",n.showView(o,1,!0)}else if(t==df.MODE_SHOP){var s=new e.ShopLayer(this,this._shopIndex);s.x=this.width,s.y=0,s.name="SHOP",n.showView(s,1,!0)}else if(t==df.MODE_RANK){var a=new e.RankLayer(this);a.x=this.width,a.y=0,a.name="RANK",n.showView(a,1,!0)}else if(t==df.MODE_BATTLE_FIND){var c=new e.BattleFindLayer(this);c.x=this.width,c.y=0,c.name="FINDBATTLE",n.showView(c,1,!0)}else if(t==df.MODE_BATTLE_LIST){var _=new e.BattleListLayer(this);_.x=this.width,_.y=0,_.name="BATTLELIST",n.showView(_,1,!0)}else if(t==df.MODE_BATTLE_RECORD){var l=new e.BattleRecordLayer(this);l.x=this.width,l.y=0,l.name="BATTLERECORD",n.showView(l,1,!0)}else if(t==df.MODE_BENEFIT){var h=new e.BenefitLayer(this);h.x=this.width,h.y=0,h.name="BENEFIT",n.showView(h,1,!0)}else if(t==df.MODE_BATTLE_CREATE){if(null!=n.getViewByName("BATTLECREATE"))return void n.popView();var u=new e.BattleCreateLayer(this,{mode:df.MODE_TH_SET});u.x=this.width,u.y=0,u.name="BATTLECREATE",n.showView(u,1,!0)}else if(t==df.MODE_ROOM_LIST){var d=new e.RoomListLayer(this,this._kindID);d.x=this.width,d.y=0,d.name="ROOMLIST",n.showView(d,1,!0)}},n.prototype.onTouchBegan=function(e){this._bMoved=!1},n.prototype.onTouchMove=function(e){this._bMoved=!0},n.prototype.onTouchEnd=function(e){},n.prototype.onPlazaRefresh=function(e){var t=e.data;
if(null!=t.key)switch(t.key){case"wealth":this.onUpdateUserWealth()}},n.prototype.onScrollerChange=function(e){var t=this._listView.viewport.scrollV,n=0,i=150*this._gameList.length-this._listView.viewport.height;n>=t?(this._pageUp.visible=!1,this._pageDown.visible=!0):t>n&&i>t?(this._pageUp.visible=!0,this._pageDown.visible=!0):(this._pageUp.visible=!0,this._pageDown.visible=!1)},n.prototype.onButtonClick=function(t){var n=t.target;n.name;switch(egret.Tween.get(n).to({scaleX:1.1,scaleY:1.1},100).to({scaleX:1,scaleY:1},100),n.name){case"bt_option":this.onChangeView(df.MODE_PLAZA_OPTION);break;case"bt_service":this.onChangeView(df.MODE_SERVICE);break;case"bt_activity":this.onChangeView(df.MODE_BENEFIT);break;case"bt_share":var i=managers.FrameManager.getInstance().getRunningController(),r=new e.ShareLayer(i.getRootLayer(),.4);i.addWindow(r);break;case"bt_rank":this.onChangeView(df.MODE_RANK);break;case"bt_shop":case"bt_Ingot_shop":case"bt_gold_shop":this._shopIndex="bt_gold_shop"==n.name?1:0,this.onChangeView(df.MODE_SHOP);break;case"bt_exchange":this._shopIndex=3,this.onChangeView(df.MODE_SHOP);break;case"findBattle":this.onChangeView(df.MODE_BATTLE_FIND);break;case"battleList":this.onChangeView(df.MODE_BATTLE_LIST);break;case"battleRecord":this.onChangeView(df.MODE_BATTLE_RECORD);break;case"battleCreate":this.onChangeView(df.MODE_BATTLE_CREATE);break;case"bt_teaHouse":this.onChangeView(df.MODE_BATTLE_CREATE),managers.TcpServiceCtrl.getInstance().getServerInfo().onFlushAgent();break;default:if(!this._bMoved){var o=Number(n.name);this._kindID=o,this.onChangeView(df.MODE_ROOM_LIST)}}},n.prototype.listLightAni=function(){var e=this,t=this._listBtns[this._nCurAniIndex],n=t.getChildByName("mask"),i=t.getChildByName("light");n.visible=!0,i.visible=!0,egret.Tween.get(i).to({x:t.width,y:0},1e3).wait(1e3/60).call(function(){n.visible=!1,i.visible=!1,i.x=0,i.y=0,e._nCurAniIndex=(e._nCurAniIndex+1)%e._gameList.length,e.listLightAni()})},n.prototype.onStartGame=function(e,t){return __awaiter(this,void 0,void 0,function(){var t,n;return __generator(this,function(i){switch(i.label){case 0:return t=managers.TcpServiceCtrl.getInstance().getGameListInfo().isGameSupport(e),null==t?[2]:(n=t.group,0!=RES.isGroupLoaded(n)?[3,2]:(managers.FrameManager.getInstance().showPopWait("资源加载中,请稍后"),[4,this.loadGameResource(n)]));case 1:return i.sent(),managers.FrameManager.getInstance().dismissPopWait(),managers.TcpServiceCtrl.getInstance().onConnectRoom(),[3,3];case 2:managers.TcpServiceCtrl.getInstance().onConnectRoom(),i.label=3;case 3:return[2]}})})},n.prototype.loadGameResource=function(e){return __awaiter(this,void 0,void 0,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,RES.loadGroup(e,0,this)];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),console.error(t),[3,3];case 3:return[2]}})})},n.prototype.onProgress=function(e,t){console.log("current is "+e+",total is "+t)},n}(eui.UILayer);e.ClientLayer=t,__reflect(t.prototype,"client.ClientLayer",["RES.PromiseTaskReporter"])}(client||(client={}));var client;!function(e){var t=function(){function e(){this._Info=[],this._Favourite=[],this._FavouriteTimes=10,this._Info=df.GAMELISTINFO,0!=df.SPECIAL_ID&&(1029==df.SPECIAL_ID?this._Info=[{id:"28",cn:"拼十",name:"ox",path:"recreational",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"92",cn:"一痞二癞麻将",name:"sparroweslz",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,video:!0,version:utils.PROCESS_VERSION(1,1,0,1)}]:2011==df.SPECIAL_ID&&(this._Info=[{id:"67",cn:"衡阳麻将",name:"sparrowhy",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,version:utils.PROCESS_VERSION(1,1,0,1)},{id:"68",cn:"衡阳鬼麻将",name:"sparrowhyg",path:"chess",module:game.landlord.GameClient,logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,version:utils.PROCESS_VERSION(1,1,0,1)}]))}return e.prototype.loadGameFavourite=function(){},e.prototype.getGameFavourite=function(e){return 0},e.prototype.getGameName=function(e){for(var t=this._Info,n="未知",i=0,r=t;i<r.length;i++){var o=r[i];if(o.id==e&&1==o.show){n=o.cn;break}}return n},e.prototype.setGameFavourite=function(e,t){},e.prototype.isGameSupport=function(e,t){var n=this._Info,i={id:"-1",cn:"未知",name:"",path:"",module:null,group:"",logic:"0",res:"0",step:!1,md5:!1,show:!1,sort:0,model:!0,version:0};return n.forEach(function(n){return n.id==e&&(n.show||t)?i=n:void 0}),i},e.prototype.isVideoSupport=function(e){},e}();e.GameListInfo=t,__reflect(t.prototype,"client.GameListInfo")}(client||(client={}));var client;!function(e){var t=function(e){function t(t,n){var i=e.call(this)||this;return i._kindID=df.INVALID_WORD,i._bMoved=!1,i._scene=t,i._kindID=n,i}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},t.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.RoomListLayer;var t=e.getChildByName("ListIcon");t.source="gamelogo_"+this._kindID+"_png";var n=e.getChildByName("bt_close");n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),n=e.getChildByName("gameRule"),n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),n=e.getChildByName("QuickStart"),n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),n=e.getChildByName("diamond"),n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),n=e.getChildByName("shop"),n.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this),this._listScroller=e.getChildByName("RoomScroller"),this.onUpdateRoomView(),this.onUpdateUserInfo(),this.addEventListener(customEvent.CustomEvent.EVENT_ROOM_REFRESH,this.onUIRefresh,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},t.prototype.onButtonClick=function(e){var t=e.target,n=t.name;switch(egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},100).to({scaleX:1,scaleY:1},100),n){case"bt_close":var i=managers.TcpServiceCtrl.getInstance().getDelegate();null!=i&&i.onExitRoom&&i.onExitRoom(),this._scene.onChangeView();break;case"gameRule":break;case"QuickStart":break;case"diamond":case"shop":this._scene._shopIndex="shop"==t.name?1:0,this._scene.onChangeView(df.MODE_SHOP)}},t.prototype.onUpdateRoomView=function(){var e=this._listScroller.getChildByName("Group"),t=managers.TcpServiceCtrl.getInstance().getServerInfo().GetRoomList(this._kindID);if(null!=t)for(var n=[],i=0,r=0;r<t.length;r++){var o=t[r].isYueZhan(),s=0!=(t[r].wServerType&df.GAME_GENRE_MATCH);if(!o&&!s){n.push(t[r]);var a=new eui.Image("room_frame_"+this._kindID+"_png");a.name=""+t[r].wServerID,e.addChild(a),a.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEvent,this),a.x=0+290*i,a.y=0,i++}}},t.prototype.onTouchEvent=function(e){var t=e.target;this._bMoved||(managers.TcpServiceCtrl.getInstance().getServerInfo().m_CurKindID=this._kindID,managers.TcpServiceCtrl.getInstance().getServerInfo().m_CurServerID=Number(t.name),console.log("当前游戏ID:"+this._kindID+",ServerID: "+Number(t.name)),this._scene.onStartGame(this._kindID,Number(t.name)))},t.prototype.onTouchBegan=function(e){this._bMoved=!1},t.prototype.onTouchMove=function(e){this._bMoved=!0},t.prototype.onTouchEnd=function(e){},t.prototype.onUpdateUserInfo=function(){var e=managers.FrameManager.getInstance().m_GlobalUserItem.lUserIngot;null==this._diamond?(this._diamond=utils.LabelAtlas.createLabel(utils.StringUtils.formatNumberThousands(e),"general_num_list_ingot_png",",0123456789",15,26),this.addChild(this._diamond)):this._diamond.initWithString(utils.StringUtils.formatNumberThousands(e),"general_num_list_ingot_png",",0123456789",15,26),utils.setAnchorLeftMid(this._diamond),this._diamond.x=110,this._diamond.y=657;var t=managers.FrameManager.getInstance().m_GlobalUserItem.lUserScore;null==this._score?(this._score=utils.LabelAtlas.createLabel(utils.StringUtils.formatNumberThousands(t),"general_num_list_gold_png",",0123456789",15,26),this.addChild(this._score)):this._score.initWithString(utils.StringUtils.formatNumberThousands(t),"general_num_list_gold_png",",0123456789",15,26),utils.setAnchorLeftMid(this._score),this._score.x=110,this._score.y=696},t.prototype.onUIRefresh=function(e){this.onUpdateUserInfo()},t.prototype.onExit=function(){this.removeEventListener(customEvent.CustomEvent.EVENT_ROOM_REFRESH,this.onUIRefresh,this),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},t}(eui.UILayer);e.RoomListLayer=t,__reflect(t.prototype,"client.RoomListLayer")}(client||(client={}));var client;!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(e){this._data=e,this.skinName=skins.RankCell,this.updateView(this._data)},enumerable:!0,configurable:!0}),t.prototype.updateView=function(e){this.bg.visible=this.itemIndex%2==0?!0:!1},t}(eui.Component);__reflect(t.prototype,"RankCell",["eui.IItemRenderer","eui.UIComponent","egret.DisplayObject"]);var n=function(e){function n(t){var n=e.call(this)||this;return n._scene=t,n}return __extends(n,e),n.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},n.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.RankLayer;var n=e.getChildByName("RankTotal");this._listTotal=new models.ListView,n.addChild(this._listTotal),this._listTotal.width=n.width,this._listTotal.height=n.height,this._listTotal.x=0,this._listTotal.y=0,this._listTotal.initItemRenderer(t);for(var i=[],r=0;10>r;r++){var o=new models.CellData(this,{bg:"rank_bg_0_png",image:"rank_icon_0_png",nick:"Jack333",id:"ID:23240956",medal:"0"});i.push(o)}this._listTotal.bindData(i);var s=e.getChildByName("bt_close");s.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this)},n.prototype.onExit=function(){},n.prototype.onButtonClickEvent=function(e){var t=e.target;switch(t.name){case"bt_close":this._scene.onChangeView()}},n}(eui.UILayer);e.RankLayer=n,__reflect(n.prototype,"client.RankLayer")}(client||(client={}));var shop;!function(e){var t={Flush:0,Save:1,Take:2},n=function(){function e(e,n){this._bankOperateCode=t.Save,this._viewFrame=e,this._view=n,this.onInit()}return e.prototype.onInit=function(){null==this._bankTextInput&&(this._bankTextInput=this._view.getChildByName("textInput"),this._bankTextInput.inputType=egret.TextFieldInputType.TEL,this._bankTextInput.addEventListener(egret.Event.CHANGE,function(e){},this));var e=this._view.getChildByName("take");e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),e=this._view.getChildByName("save"),e.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),this.onUserWealth()},e.prototype.onUserWealth=function(){if(null==this._userScore){var e=utils.StringUtils.formatNumberThousands(managers.FrameManager.getInstance().m_GlobalUserItem.lUserScore);this._userScore=utils.LabelAtlas.createLabel(e,"bank_num_png",",0123456789",34,57),utils.setAnchorLeftMid(this._userScore),this._view.addChild(this._userScore),this._userScore.x=274,this._userScore.y=65}else{var e=utils.StringUtils.formatNumberThousands(managers.FrameManager.getInstance().m_GlobalUserItem.lUserScore);this._userScore.initWithString(e,"bank_num_png",",0123456789",34,57)}if(null==this._userInsure){var e=utils.StringUtils.formatNumberThousands(managers.FrameManager.getInstance().m_GlobalUserItem.lUserInsure);this._userInsure=utils.LabelAtlas.createLabel(e,"bank_num_png",",0123456789",34,57),utils.setAnchorLeftMid(this._userInsure),this._view.addChild(this._userInsure),this._userInsure.x=274,this._userInsure.y=145}else{var e=utils.StringUtils.formatNumberThousands(managers.FrameManager.getInstance().m_GlobalUserItem.lUserInsure);this._userInsure.initWithString(e,"bank_num_png",",0123456789",34,57)}},e.prototype.onButtonClickEvent=function(e){var n=e.target;egret.Tween.get(n).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50);switch(n.name){case"take":if(0==this._bankTextInput.text.length)return void managers.FrameManager.getInstance().showToast("请输入操作金额!");if(isNaN(Number(this._bankTextInput.text)))return void managers.FrameManager.getInstance().showToast("请输入合法金额!");if(Number(this._bankTextInput.text)>managers.FrameManager.getInstance().m_GlobalUserItem.lUserInsure)return void managers.FrameManager.getInstance().showToast("输入金额超过存款金额,请重新输入!");this._bankFrame=new frame.BankFrame(this),this._bankOperateCode=t.Take,managers.TcpServiceCtrl.getInstance().onConnectPlaza(),managers.TcpServiceCtrl.getInstance().setDelegate(this._bankFrame);break;case"save":if(0==this._bankTextInput.text.length)return void managers.FrameManager.getInstance().showToast("请输入操作金额!");if(isNaN(Number(this._bankTextInput.text)))return void managers.FrameManager.getInstance().showToast("请输入合法金额!");if(Number(this._bankTextInput.text)>managers.FrameManager.getInstance().m_GlobalUserItem.lUserScore)return void managers.FrameManager.getInstance().showToast("输入金额超过携带金额,请重新输入!");this._bankOperateCode=t.Save,this._bankFrame=new frame.BankFrame(this),managers.TcpServiceCtrl.getInstance().onConnectPlaza(),managers.TcpServiceCtrl.getInstance().setDelegate(this._bankFrame)}},e.prototype.connectComplete=function(){switch(this._bankOperateCode){case t.Take:this._bankFrame.sendTakeScore(managers.TcpServiceCtrl.getInstance().getTcpService(),Number(this._bankTextInput.text));break;case t.Save:this._bankFrame.sendSaveScore(managers.TcpServiceCtrl.getInstance().getTcpService(),Number(this._bankTextInput.text))}},e}();e.Bank=n,__reflect(n.prototype,"shop.Bank")}(shop||(shop={}));var shop;!function(e){var t="http://"+managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.webAddr+"/Ashx/ProService.ashx?action=GetIngotList",n=("http://"+managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.webAddr+"/Ashx/ProService.ashx?action=ConvertScore",function(){function e(e,t){this._isHaveData=!1,this._viewFrame=e,this._view=t,this.onGetIngotList()}return e.prototype.updateShow=function(){this._listScroller=this._view.getChildByName("scroller");for(var e=this._listScroller.getChildByName("Group"),t=0;t<this._jsonRet.length;t++){var n=new eui.Panel;n.skinName=skins.Gold,n.name=""+t,e.addChild(n),n.x=20+t%3*(n.width+15),n.y=10+Math.floor(t/3)*(n.height+20);var i=6>=t+1?t+1:6,r=n.getChildByName("icon");r.source="shop_icon_gold_"+i+"_png";var o=utils.StringUtils.formatNumberThousands(Number(this._jsonRet[t].PresentScore)),s=utils.LabelAtlas.createLabel(o,"shop_buy_exchange_present_png",",0123456789",24,41);n.addChild(s),utils.setAnchorMidBottom(s),s.x=130,s.y=127;var a=utils.StringUtils.formatNumberThousands(Number(this._jsonRet[t].Price));s=utils.LabelAtlas.createLabel(a,"shop_num_exchange_png",",0123456789",25,33),n.addChild(s),s.touchEnabled=!1,utils.setAnchorMidBottom(s),s.x=120,s.y=171;var c=n.getChildByName("purchase");c.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this)}},e.prototype.onGetIngotList=function(){var e=this;return new Promise(function(n,i){if(e._isHaveData||managers.FrameManager.getInstance().m_Localization.getCacheByKey("ingotList"))return e._jsonRet=managers.FrameManager.getInstance().m_Localization.getCacheByKey("ingotList"),e.updateShow(),void n();var r=Math.floor((new Date).getTime()/1e3),o=managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID,s=df.STATION_ID,a=df.DEVICE_TYPE,c=df.LUA_VERSION,_="&servertime="+r+"&userid="+o+"&stationid="+s+"&deviceid="+a+"&version="+c,l=function(t){console.log("请求成功");var i=JSON.parse(t.target.response);null==i&&console.log("json Error"),e._isHaveData=!0,e._jsonRet=i.Data,null!=e._jsonRet.list&&(e._jsonRet=e._jsonRet.list),e.updateShow(),managers.FrameManager.getInstance().m_Localization.saveCache("ingotList",e._jsonRet),n()},h=function(e){console.log("请求失败"),i("获取商品列表失败！")};utils.HttpRequest.createHttpRequest(e,t,_,egret.HttpMethod.POST,l,h)})},e.prototype.onButtonClick=function(e){var t=e.target;egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50)},e}());e.Exchange=n,__reflect(n.prototype,"shop.Exchange")}(shop||(shop={}));var shop;!function(e){var t="http://"+managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.webAddr+"/Ashx/ProService.ashx?action=GetAwardList",n=("http://"+managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.webAddr+"/Ashx/ProService.ashx?action=ConvertScore",function(){function e(e,t){this._isHaveData=!1,this._viewFrame=e,this._view=t,this.onGetRealList()}return e.prototype.updateShow=function(){this._listScroller=this._view.getChildByName("scroller");var e=this._listScroller.getChildByName("Group"),t=this._jsonRet.length;if(0==t){var n=this._view.getChildByName("tips");return void(n.visible=!0)}for(var i=0;t>i;i++){var r=new eui.Panel;r.skinName=skins.RealItem,r.name=""+i,e.addChild(r),r.x=20+i%3*(r.width+15),r.y=10+Math.floor(i/3)*(r.height+20);var o=this._jsonRet[i].AwardID,s=r.getChildByName("icon");s.source="item_"+Number(o)+"_png";var a=r.getChildByName("name");a.text=this._jsonRet[i].AwardName;var c=utils.StringUtils.formatNumberThousands(Number(this._jsonRet[i].Price)),_=utils.LabelAtlas.createLabel(c,"shop_num_exchange_png",",0123456789",25,33);r.addChild(_),_.touchEnabled=!1,utils.setAnchorMidBottom(_),_.x=120,_.y=171;var l=r.getChildByName("exchange");l.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this)}},e.prototype.onGetRealList=function(){var e=this;return new Promise(function(n,i){if(e._isHaveData||managers.FrameManager.getInstance().m_Localization.getCacheByKey("realItem"))return e._jsonRet=managers.FrameManager.getInstance().m_Localization.getCacheByKey("realItem"),e.updateShow(),void n();var r=Math.floor((new Date).getTime()/1e3),o=managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID,s=df.STATION_ID,a=df.DEVICE_TYPE,c=df.LUA_VERSION,_="&servertime="+r+"&userid="+o+"&stationid="+s+"&deviceid="+a+"&version="+c,l=function(t){console.log("请求成功");var i=JSON.parse(t.target.response);null==i&&console.log("json Error"),e._isHaveData=!0,e._jsonRet=i.Data,null!=e._jsonRet.list&&(e._jsonRet=e._jsonRet.list),e.updateShow(),managers.FrameManager.getInstance().m_Localization.saveCache("realItem",e._jsonRet),n()},h=function(e){console.log("请求失败"),i("获取实物列表失败！")};utils.HttpRequest.createHttpRequest(e,t,_,egret.HttpMethod.POST,l,h)})},e.prototype.onButtonClick=function(e){var t=e.target;egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50)},e}());e.RealItem=n,__reflect(n.prototype,"shop.RealItem")}(shop||(shop={}));var shop;!function(e){var t="http://"+managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.webAddr+"/Ashx/ProService.ashx?action=GetLuaAppList",n=("http://"+managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.webAddr+"/AppPay/CheckReceipt.aspx","http://"+managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.webAddr+"/Ashx/ProService.ashx?action=PayWxConfig",["http://"+managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.webAddr+"/Ashx/ProService.ashx","http://"+managers.TcpServiceCtrl.getInstance().m_DefaultServerInfo.webAddr+"/Ashx/ProService.ashx"],function(){function e(e,t){this._isHaveData=!1,this._viewFrame=e,this._view=t,this.onGetAppList()}return e.prototype.updateShow=function(){this._listScroller=this._view.getChildByName("scroller");for(var e=this._listScroller.getChildByName("Group"),t=0;t<this._jsonRet.length;t++){var n=new eui.Panel;n.skinName=skins.Diamond,n.name=""+t,e.addChild(n),n.x=20+t%3*(n.width+15),n.y=10+Math.floor(t/3)*(n.height+20);var i=6>=t+1?t+1:6,r=n.getChildByName("Icon");r.source="shop_icon_ingot_"+i+"_png",i=3>=t+1?t+1:4;var o=n.getChildByName("corner");o.source="icon_recharge_"+i+"_png";var s=utils.StringUtils.formatNumberThousands(Number(this._jsonRet[t].PresentIngot)),a=utils.LabelAtlas.createLabel(s,"shop_num_buy_present_png",",0123456789",24,41);n.addChild(a),a.x=47,a.y=58;var c=utils.StringUtils.formatNumberThousands(Number(this._jsonRet[t].Price));a=utils.LabelAtlas.createLabel(c,"shop_num_buy_png",",0123456789",25,33),n.addChild(a),a.touchEnabled=!1,utils.setAnchorLeftMid(a),a.x=100,a.y=164;var _=n.getChildByName("purchase");_.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClick,this)}},e.prototype.onGetAppList=function(){var e=this;return new Promise(function(n,i){if(e._isHaveData||managers.FrameManager.getInstance().m_Localization.getCacheByKey("shopList"))return e._jsonRet=managers.FrameManager.getInstance().m_Localization.getCacheByKey("shopList"),e.updateShow(),void n();var r=Math.floor((new Date).getTime()/1e3),o=managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID,s=df.STATION_ID,a=df.DEVICE_TYPE,c=df.LUA_VERSION,_="&servertime="+r+"&userid="+o+"&stationid="+s+"&deviceid="+a+"&version="+c,l=function(t){console.log("请求成功");var i=JSON.parse(t.target.response);null==i&&console.log("json Error"),e._isHaveData=!0,e._jsonRet=i.Data,null!=e._jsonRet.list&&(e._jsonRet=e._jsonRet.list),e.updateShow(),managers.FrameManager.getInstance().m_Localization.saveCache("shopList",e._jsonRet),n()},h=function(e){console.log("请求失败"),i("获取商品列表失败！")};utils.HttpRequest.createHttpRequest(e,t,_,egret.HttpMethod.POST,l,h)})},e.prototype.onButtonClick=function(e){var t=e.target;egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50)},e}());e.Recharge=n,__reflect(n.prototype,"shop.Recharge")}(shop||(shop={}));var client;!function(e){var t={Wechat:0,AliPay:1},n=function(e){function n(n,i){var r=e.call(this)||this;return r._showIndex=0,r._paymentMode=t.Wechat,r._checkItems=[],r._panels=[],r._scene=n,r._showIndex=i?i:0,r}return __extends(n,e),n.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this),this.addEventListener(customEvent.CustomEvent.EVENT_SHOP_REFRESH,this.onRefreshInfo,this)},n.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.ShopLayer,this._panel_purchase_type=e.getChildByName("panel_purchaseType"),this._panel_info=e.getChildByName("panel_info"),this._panel_medal=e.getChildByName("panel_medal"),this._panel_purchase_ingot=e.getChildByName("PurchaseIngot"),this._panel_purchase_gold=e.getChildByName("PurchaseGold"),this._panel_bank=e.getChildByName("Bank"),this._panel_exchange=e.getChildByName("Exchange"),this._panel_purchase_roomCard=e.getChildByName("RoomCard"),this._panels=[this._panel_purchase_ingot,this._panel_purchase_gold,this._panel_bank,this._panel_exchange,this._panel_purchase_roomCard],this._check_wechat=this._panel_purchase_type.getChildByName("Wechat"),this._check_wechat.addEventListener(egret.Event.CHANGE,this.onEventChange,this),this._check_zfb=this._panel_purchase_type.getChildByName("ZFB"),this._check_zfb.addEventListener(egret.Event.CHANGE,this.onEventChange,this);for(var t=0;5>t;t++){var n=e.getChildByName("check_"+t);this._checkItems.push(n),n.addEventListener(egret.Event.CHANGE,this.onEventChange,this)}this._Label_Ingot=this._panel_info.getChildByName("label_ingot"),this._Label_Gold=this._panel_info.getChildByName("label_gold"),this._Label_Medal=this._panel_medal.getChildByName("label_madal"),this.updateData();var i=e.getChildByName("bt_close");i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),i=this._panel_info.getChildByName("info_refresh"),i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),i=this._panel_medal.getChildByName("medal_refresh"),i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),this._tips=e.getChildByName("tips"),this._tips_content=e.getChildByName("content"),this.initShowIndex(this._showIndex)},n.prototype.onExit=function(){this.removeEventListener(customEvent.CustomEvent.EVENT_SHOP_REFRESH,this.onRefreshInfo,this)},n.prototype.updateTips=function(e){this._tips_content.text=e},n.prototype.updateData=function(){var e=managers.FrameManager.getInstance().m_GlobalUserItem;this._Label_Ingot.text=utils.StringUtils.formatNumberThousands(e.lUserIngot),this._Label_Gold.text=utils.StringUtils.formatNumberThousands(e.lUserScore),this._Label_Medal.text=utils.StringUtils.formatNumberThousands(e.lUserMedal)},n.prototype.showSelected=function(e){for(var t=0;t<this._checkItems.length;t++)e==t?this._checkItems[t].selected=!0:this._checkItems[t].selected=!1},n.prototype.initShowIndex=function(e){switch(e){case 0:this.showSelected(0),this._panel_purchase_type.visible=!0,this._panel_info.visible=!0,this._panel_medal.visible=!1,this._panel_purchase_ingot.visible=!0,this._panel_purchase_gold.visible=!1,this._panel_bank.visible=!1,this._panel_exchange.visible=!1,this._panel_purchase_roomCard.visible=!1,this._tips.x=820,this._tips.y=160,this.updateTips("钻石用于约战开房记录战绩"),this._tips_content.x=942,this._tips_content.y=160,null==this._rechargeView&&(this._rechargeView=new shop.Recharge(this,this._panel_purchase_ingot));break;case 1:this.showSelected(1),this._panel_purchase_type.visible=!1,this._panel_info.visible=!1,this._panel_medal.visible=!1,this._panel_purchase_ingot.visible=!1,this._panel_purchase_gold.visible=!0,this._panel_bank.visible=!1,this._panel_exchange.visible=!1,this._panel_purchase_roomCard.visible=!1,this._tips.x=820,this._tips.y=160,this.updateTips("金币用于金币房间进行游戏"),this._tips_content.x=942,this._tips_content.y=160,null==this._exchangeView&&(this._exchangeView=new shop.Exchange(this,this._panel_purchase_gold));break;case 2:this.showSelected(2),this._panel_purchase_type.visible=!1,this._panel_info.visible=!1,this._panel_medal.visible=!1,this._panel_purchase_ingot.visible=!1,this._panel_purchase_gold.visible=!1,this._panel_bank.visible=!0,this._panel_exchange.visible=!1,this._panel_purchase_roomCard.visible=!1,this._tips.x=390,this._tips.y=160,this.updateTips("存款会预留身上携带1888金币,取款将收取1‰的手续费"),this._tips_content.x=507,this._tips_content.y=160,null==this._bankView&&(this._bankView=new shop.Bank(this,this._panel_bank));break;case 3:this.showSelected(3),this._panel_purchase_type.visible=!1,this._panel_info.visible=!1,this._panel_medal.visible=!0,this._panel_purchase_ingot.visible=!1,this._panel_purchase_gold.visible=!1,this._panel_bank.visible=!1,this._panel_exchange.visible=!0,this._panel_purchase_roomCard.visible=!1,this._tips.x=390,this._tips.y=160,this.updateTips("奖牌可在约战场获得,兑换将在72小时内发货,周末节假日顺延"),this._tips_content.x=507,this._tips_content.y=160,null==this._realItemView&&(this._realItemView=new shop.RealItem(this,this._panel_exchange));break;case 4:this.showSelected(4),this._panel_purchase_type.visible=!0,this._panel_info.visible=!0,this._panel_medal.visible=!1,this._panel_purchase_ingot.visible=!1,this._panel_purchase_gold.visible=!1,this._panel_bank.visible=!1,this._panel_exchange.visible=!1,this._panel_purchase_roomCard.visible=!0,this._tips.x=820,this._tips.y=160,this.updateTips("钻石用于约战开房记录战绩"),this._tips_content.x=942,this._tips_content.y=160}},n.prototype.onRefreshInfo=function(){this.updateData(),null!=this._bankView&&this._bankView.onUserWealth();var e={key:"wealth",data:{}};this._scene.dispatchEvent(new customEvent.CustomEvent(customEvent.CustomEvent.EVENT_PLAZA_REFRESH,!1,!1,e))},n.prototype.onEventChange=function(e){var t=this,n=e.target;switch(n.name){case"Wechat":this._check_wechat.selected=!0,this._check_zfb.selected=!1;break;case"ZFB":this._check_wechat.selected=!1,this._check_zfb.selected=!0;break;default:this._checkItems.forEach(function(e,i){e==n?t.initShowIndex(i):e.selected=!1});for(var i=0,r=this._checkItems;i<r.length;i++){var o=r[i];o==n?o.selected=!0:o.selected=!1}}},n.prototype.onButtonClickEvent=function(e){var t=e.target;egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50);switch(t.name){case"bt_close":this._scene.onChangeView()}},n}(eui.UILayer);e.ShopLayer=n,__reflect(n.prototype,"client.ShopLayer")}(client||(client={}));var client;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n.RES_BOY=["face_x_00_png","face_x_01_png","face_x_02_png","face_x_03_png","face_x_04_png","face_x_05_png","face_x_06_png","face_x_07_png","face_x_08_png","face_x_09_png"],n.RES_GIRL=["face_x_10_png","face_x_11_png","face_x_12_png","face_x_13_png","face_x_14_png","face_x_15_png","face_x_16_png","face_x_17_png","face_x_18_png","face_x_19_png"],n._scene=t,n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},t.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.HeadModify;for(var t=managers.FrameManager.getInstance().m_GlobalUserItem.cbGender,n=0;10>n;n++){var i=e.getChildByName("panel_head"),r=new egret.Shape;r.graphics.beginFill(0,1),r.graphics.drawRoundRect(0,0,80,80,30,30),r.graphics.endFill(),i.addChild(r),r.x=20+n%6*120,r.y=25+130*Math.floor(n/6);var o=new eui.Image(t==df.GENDER_MANKIND?this.RES_BOY[n]:this.RES_GIRL[n]);o.scaleX=.4,o.scaleY=.4,i.addChild(o),o.touchEnabled=!1,o.x=12+n%6*120,o.y=16+130*Math.floor(n/6),o.mask=r}var s=e.getChildByName("bt_close");s.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),s=e.getChildByName("bt_modify"),s.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this)},t.prototype.onExit=function(){},t.prototype.transIn=function(){egret.Tween.get(this).to({x:0,y:0},200)},t.prototype.transOut=function(){var e=this.parent;e.removeChild(e.getChildByName("mask"));egret.Tween.get(this).to({x:0,y:-this.height},200)},t.prototype.onButtonClickEvent=function(e){var t=e.target;egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50);"bt_close"==t.name&&this.transOut()},t}(eui.UILayer);e.ModifyFaceLayer=t,__reflect(t.prototype,"client.ModifyFaceLayer")}(client||(client={}));var client;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n._scene=t,n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},t.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.InfoModify;var t=e.getChildByName("bt_close");t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),t=e.getChildByName("bt_modify"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this);var n=managers.FrameManager.getInstance().m_GlobalUserItem,i=e.getChildByName("radio_man");i.$setSelected(n.cbGender==df.GENDER_MANKIND?!0:!1),i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),i=e.getChildByName("radio_woman"),i.$setSelected(n.cbGender==df.GENDER_FEMALE?!0:!1),i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),i=e.getChildByName("radio_secret"),i.$setSelected(n.cbGender==df.GENDER_SECRET?!0:!1),i.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this)},t.prototype.transIn=function(){egret.Tween.get(this).to({x:0,y:0},200)},t.prototype.transOut=function(){var e=this.parent;e.removeChild(e.getChildByName("mask"));egret.Tween.get(this).to({x:0,y:-this.height},200)},t.prototype.onExit=function(){},t.prototype.onButtonClickEvent=function(e){var t=e.target;
if("radio_man"!=t.name&&"radio_woman"!=t.name&&"radio_secret"!=t.name){egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50)}"bt_close"==t.name&&this.transOut()},t}(eui.UILayer);e.InfoModifyLayer=t,__reflect(t.prototype,"client.InfoModifyLayer")}(client||(client={}));var client;!function(e){var t=function(e){function t(t){var n=e.call(this)||this;return n._scene=t,n}return __extends(t,e),t.prototype.createChildren=function(){e.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},t.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.PasswordModify;var t=e.getChildByName("bt_close");t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),t=e.getChildByName("bt_modify"),t.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this)},t.prototype.transIn=function(){egret.Tween.get(this).to({x:0,y:0},200)},t.prototype.transOut=function(){var e=this.parent;e.removeChild(e.getChildByName("mask"));egret.Tween.get(this).to({x:0,y:-this.height},200)},t.prototype.onExit=function(){},t.prototype.onButtonClickEvent=function(e){var t=e.target;egret.Tween.get(t).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50);"bt_close"==t.name&&this.transOut()},t}(eui.UILayer);e.PasswordModifyLayer=t,__reflect(t.prototype,"client.PasswordModifyLayer")}(client||(client={}));var client;!function(e){var t=function(t){function n(e){var n=t.call(this)||this;return n._scene=e,n}return __extends(n,t),n.prototype.createChildren=function(){t.prototype.createChildren.call(this),this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this)},n.prototype.onInitLayer=function(){var e=new eui.Component;this.addChild(e),e.skinName=skins.UserInfoLayer;var t=managers.FrameManager.getInstance().m_GlobalUserItem,n=models.HeadSprite.createSysHeadWithCorner(t,240,240,65,65);utils.setAnchorLeftTop(n),this.addChild(n),n.x=140,n.y=160;var i=e.getChildByName("ID");i.text=utils.StringUtils.clipByConfig(""+t.dwGameID,175,utils.StringUtils.getSystemConfig(26));var r=e.getChildByName("account");r.text=utils.StringUtils.clipByConfig(t.szAccounts,175,utils.StringUtils.getSystemConfig(26));var o=e.getChildByName("nick");o.text=utils.StringUtils.clipByConfig(t.szNickName,175,utils.StringUtils.getSystemConfig(26));var s=e.getChildByName("level");s.text=utils.StringUtils.clipByConfig(df.getLevelDescribe(t.lUserScore),175,utils.StringUtils.getSystemConfig(26));var a=utils.createBitmapByName("userinfo_icon_level_png",new egret.Rectangle(42*(df.getExpImgLevel(t.dwExperience,20)-1),0,42,42));this.addChild(a),utils.setAnchorLeftMid(a),a.x=850,a.y=362;var c=e.getChildByName("diam");c.text=utils.StringUtils.clipByConfig(utils.StringUtils.formatNumberThousands(t.lUserIngot),175,utils.StringUtils.getSystemConfig(26));var _=e.getChildByName("medel");_.text=utils.StringUtils.clipByConfig(utils.StringUtils.formatNumberThousands(t.lUserMedal),175,utils.StringUtils.getSystemConfig(26));var l=e.getChildByName("take");l.text=utils.StringUtils.clipByConfig(utils.StringUtils.formatNumberThousands(t.lUserScore),175,utils.StringUtils.getSystemConfig(26));var h=e.getChildByName("save");h.text=utils.StringUtils.clipByConfig(utils.StringUtils.formatNumberThousands(t.lUserInsure),175,utils.StringUtils.getSystemConfig(26));var u=e.getChildByName("modifyHead");u.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),u=e.getChildByName("modifyPassword"),u.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),u=e.getChildByName("modifyInfo"),u.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),u=e.getChildByName("right"),u.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),u=e.getChildByName("join"),u.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),u=e.getChildByName("purchase"),u.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),u=e.getChildByName("bank"),u.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this),u=e.getChildByName("bt_return"),u.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onButtonClickEvent,this)},n.prototype.onExit=function(){},n.prototype.onButtonClickEvent=function(t){var n=t.target;if(n instanceof eui.Button){egret.Tween.get(n).to({scaleX:1.1,scaleY:1.1},50).to({scaleX:1,scaleY:1},50)}if("bt_return"==n.name)this._scene.onChangeView();else if("modifyPassword"==n.name||"modifyInfo"==n.name||"modifyHead"==n.name){var i=new egret.Shape;if(i.name="mask",i.graphics.beginFill(0,1),i.graphics.drawRect(0,0,this.width,this.height),i.graphics.endFill(),i.alpha=.5,utils.setAnchorCenter(i),this.addChild(i),i.x=this.width/2,i.y=this.height/2,i.touchEnabled=!0,"modifyPassword"==n.name){var r=new e.PasswordModifyLayer(this);this.addChild(r),r.x=0,r.y=-this.height,r.transIn()}else if("modifyInfo"==n.name){var o=new e.InfoModifyLayer(this);this.addChild(o),o.x=0,o.y=-this.height,o.transIn()}else{var s=new e.ModifyFaceLayer(this);this.addChild(s),s.x=0,s.y=-this.height,s.transIn()}}else if("join"==n.name||"purchase"==n.name||"bank"==n.name){var a="bank"==n.name?2:0;this._scene._shopIndex=a,this._scene.onChangeView(df.MODE_SHOP)}},n}(eui.UILayer);e.UserInfoLayer=t,__reflect(t.prototype,"client.UserInfoLayer")}(client||(client={}));var df;!function(e){function t(){var e={wFaceID:0,wChairID:0,dwUserID:0,dwGameID:0,dwCustomID:0,szNickName:""};return e}function n(){var e={wKindID:0,dwUserID:0,cbQueryKind:0,dwQueryArgKey:0};return e}function i(){var e={dwUserID:0,dwStationID:0,szPassword:"",dwGroupID:0,dwGroupCreaterID:0,wKindID:0,wPayType:0,wPlayerCount:0,cbSettleKind:0,cbVideoMode:0,cbCurrencyKind:0,cbForbidSameIP:0,wPlayCount:0,dwPlayTime:0,lBaseScore:0,szMachineID:""};return e}function r(){var e={wKindID:0,dwMappedNum:0,dwUserID:0,szPassword:""};return e}function o(){var e={wKindID:0,dwMappedNum:0};return e}function s(){var e={wTableCount:0};return e}function a(){var e={dwUserID:0,dwMappedNum:0,TableUserItem:t()};return e}function c(){var e={wChairID:0,dwUserID:0,dwMappedNum:0};return e}function _(){var e={dwMappedNum:0,dwStartTime:0,wFinishCount:0};return e}function l(){var e={dwGroupID:0,dwMappedNum:0};return e}function h(){var e={cbResultCode:0,szDescribeString:""};return e}function u(){var e={dwMappedNum:0,wUserCount:0};return e}e.URL_TEAHOUSE_SHARE="http://testwww.foxuc.com/Mobile/WxGroupShare.aspx",e.UPDATE_KIND_WEALTH=1,e.UPDATE_KIND_PROPERTY=2,e.UPDATE_KIND_BATTLERULE=4,e.APPLY_MSG_TYPE_REQUEST=1,e.APPLY_MSG_TYPE_RESPOND=2,e.APPLY_STATUS_NONE=0,e.APPLY_STATUS_AGREE=1,e.APPLY_STATUS_REFUSE=2,e.APPLY_STATUS_REPEAL=3,e.GROUP_BATTLE_MASK_GYKF=1,e.MDM_GA_BATTLE_SERVICE=1,e.SUB_GA_QUERY_TABLE=110,e.SUB_GA_CREATE_TABLE=111,e.SUB_GA_DISMISS_TABLE=112,e.SUB_GA_GET_TABLE_USERLIST=113,e.SUB_GA_TABLE_ITEM=200,e.SUB_GA_TABLE_LIST=201,e.SUB_GA_OPERATE_FAILED=202,e.SUB_GA_BATTLE_RECORD=203,e.SUB_GA_TABLE_PARAMLIST=204,e.SUB_GA_TABLE_USERLIST=205,e.SUB_GA_DISMISS_RESULT=206,e.SUB_GA_USER_SITDOWN=300,e.SUB_GA_USER_STANDUP=301,e.SUB_GA_TABLE_PARAM=302,e.SUB_GA_TABLE_DISMISS=303,e.tagTableUserItem=t,e.CMD_GA_QueryTable=n,e.CMD_GA_CreateTable=i,e.CMD_GA_DismissTable=r,e.CMD_GA_GetTableUserList=o,e.CMD_GA_TableList=s,e.CMD_GA_UserSitdown=a,e.CMD_GA_UserStandup=c,e.CMD_GA_TableParam=_,e.CMD_GA_TableDismiss=l,e.CMD_GA_DismissResult=h,e.CMD_GA_TableUserList=u,e.MDM_GA_LOGIC_SERVICE=2,e.SUB_GA_ENTER_SERVER=1,e.SUB_GA_SEARCH_GROUP=2,e.SUB_GA_CREATE_GROUP=3,e.SUB_GA_UPDATE_GROUP=4,e.SUB_GA_DELETE_GROUP=5,e.SUB_GA_DELETE_MEMBER=7,e.SUB_GA_APPLY_REQUEST=8,e.SUB_GA_APPLY_RESPOND=9,e.SUB_GA_APPLY_DELETE=10,e.SUB_GA_APPLY_REPEAL=11,e.SUB_GA_SETTLE_BATTLE=12,e.SUB_GA_LEAVE_SERVER=19,e.SUB_GA_APPEND_CONFIG=20,e.SUB_GA_MODIFY_CONFIG=21,e.SUB_GA_DELETE_CONFIG=22,e.SUB_GA_GROUP_OPTION=100,e.SUB_GA_APPLY_MESSAGE=101,e.SUB_GA_LOGON_FAILURE=102,e.SUB_GA_SEARCH_RESULT=103,e.SUB_GA_WEALTH_UPDATE=104,e.SUB_GA_APPLY_DEL_RESULT=105,e.SUB_GA_OPERATE_SUCCESS=200,e.SUB_GA_OPERATE_FAILURE=201,e.SUB_GA_SYSTEM_MESSAGE=300,e.MDM_GA_GROUP_SERVICE=3,e.SUB_GA_ENTER_GROUP=1,e.SUB_GA_LEAVE_GROUP=2,e.SUB_GA_GROUP_ITEM=100,e.SUB_GA_GROUP_PROPERTY=101,e.SUB_GA_GROUP_MEMBER=102,e.SUB_GA_GROUP_UPDATE=103,e.SUB_GA_GROUP_DELETE=104,e.SUB_GA_MEMBER_INSERT=105,e.SUB_GA_MEMBER_DELETE=106,e.SUB_GA_MEMBER_UPDATE=107,e.SUB_GA_BATTLE_CONFIG=120,e.SUB_GA_CONFIG_APPEND=121,e.SUB_GA_CONFIG_MODIFY=122,e.SUB_GA_CONFIG_DELETE=123,e.SUB_GA_ENTER_SUCCESS=200,e.SUB_GA_ENTER_FAILURE=201}(df||(df={}));var df;!function(e){e.MDM_GR_LOGON=1,e.SUB_GR_LOGON_USERID=1,e.SUB_GR_LOGON_ACCOUNTS=3,e.SUB_GR_LOGON_MOBILE=4,e.SUB_GR_LOGON_SUCCESS=100,e.SUB_GR_LOGON_FAILURE=101,e.SUB_GR_LOGON_FINISH=102,e.SUB_GR_UPDATE_NOTIFY=200;var t=function(){function e(){this.dwPlazaVersion=0,this.dwFrameVersion=0,this.dwProcessVersion=0,this.dwUserStationID=0,this.dwPlazaStationID=0,this.dwUserID=0,this.szPasspublic=""}return e}();e.CMD_GR_LogonByUserID=t,__reflect(t.prototype,"df.CMD_GR_LogonByUserID");var n=function(){function e(){this.dwPlazaVersion=0,this.dwFrameVersion=0,this.dwProcessVersion=0,this.dwUserStationID=0,this.dwPlazaStationID=0,this.szPasspublic=0,this.szAccounts=""}return e}();e.CMD_GR_LogonByAccounts=n,__reflect(n.prototype,"df.CMD_GR_LogonByAccounts");var i=function(){function e(){this.wGameID=0,this.dwPlazaVersion=0,this.dwProcessVersion=0,this.cbDeviceType=0,this.wBehaviorFlags=0,this.wPageTableCount=0,this.dwUserStationID=0,this.dwPlazaStationID=0,this.dwUserID=0,this.szPasspublic="",this.szServerPasswdf="",this.szMachineID="",this.dGlobalPosLng=0,this.dGlobalPosLat=0,this.dwMatchID=0,this.lMatchNo=0}return e}();e.CMD_GR_LogonByMobile=i,__reflect(i.prototype,"df.CMD_GR_LogonByMobile");var r=function(){function e(e){this.dwUserID=0,this.dwUserRight=0,this.dwMasterRight=0,this.cbMemberOrderUseTrumpet=0,this.dwUserID=e.cbBuffer.Pop_DWORD(),this.dwUserRight=e.cbBuffer.Pop_DWORD(),this.dwMasterRight=e.cbBuffer.Pop_DWORD(),this.cbMemberOrderUseTrumpet=e.cbBuffer.Pop_Byte()}return e}();e.CMD_GR_LogonSuccess=r,__reflect(r.prototype,"df.CMD_GR_LogonSuccess");var o=function(){function e(e){this.lErrorCode=0,this.wLockServerID=0,this.szDescribeString="",this.lErrorCode=e.cbBuffer.Pop_INT(),this.wLockServerID=e.cbBuffer.Pop_WORD(),this.szDescribeString=e.cbBuffer.Pop_UTF16(e.cbBuffer.getByteArray().bytesAvailable/2)}return e}();e.CMD_GR_LogonFailure=o,__reflect(o.prototype,"df.CMD_GR_LogonFailure");var s=function(){function e(e){this.cbMustUpdatePlaza=0,this.cbMustUpdateClient=0,this.cbAdviceUpdateClient=0,this.dwCurrentPlazaVersion=0,this.dwCurrentFrameVersion=0,this.dwCurrentClientVersion=0,this.cbMustUpdatePlaza=e.cbBuffer.Pop_Byte(),this.cbMustUpdateClient=e.cbBuffer.Pop_Byte(),this.cbAdviceUpdateClient=e.cbBuffer.Pop_Byte(),this.dwCurrentPlazaVersion=e.cbBuffer.Pop_DWORD(),this.dwCurrentFrameVersion=e.cbBuffer.Pop_DWORD(),this.dwCurrentClientVersion=e.cbBuffer.Pop_DWORD()}return e}();e.CMD_GR_UpdateNotify=s,__reflect(s.prototype,"df.CMD_GR_UpdateNotify"),e.MDM_GR_CONFIG=2,e.SUB_GR_CONFIG_COLUMN=100,e.SUB_GR_CONFIG_SERVER=101,e.SUB_GR_CONFIG_FINISH=102,e.SUB_GR_CONFIG_RULE=103,e.SUB_GR_CONFIG_USER_RIGHT=104;var a=function(){function e(){this.cbColumnCount=0}return e}();e.CMD_GR_ConfigColumn=a,__reflect(a.prototype,"df.CMD_GR_ConfigColumn");var c=function(){function e(e){this.wKindID=0,this.wTableCount=0,this.wChairCount=0,this.wServerType=0,this.cbSegmentGame=0,this.dwServerRule=0,this.dwGameBuglePrice=0,this.dwRoomBuglePrice=0,this.wKindID=e.cbBuffer.Pop_WORD(),this.wTableCount=e.cbBuffer.Pop_WORD(),this.wChairCount=e.cbBuffer.Pop_WORD(),this.wServerType=e.cbBuffer.Pop_WORD(),this.cbSegmentGame=e.cbBuffer.Pop_Byte(),this.dwServerRule=e.cbBuffer.Pop_DWORD(),this.dwGameBuglePrice=e.cbBuffer.Pop_DWORD(),this.dwRoomBuglePrice=e.cbBuffer.Pop_DWORD()}return e}();e.CMD_GR_ConfigServer=c,__reflect(c.prototype,"df.CMD_GR_ConfigServer");var _=function(){function e(){this.dwServerRule=0}return e}();e.CMD_GR_ConfigRule=_,__reflect(_.prototype,"df.CMD_GR_ConfigRule");var l=function(){function e(){this.dwUserRight=0}return e}();e.CMD_GR_ConfigUserRight=l,__reflect(l.prototype,"df.CMD_GR_ConfigUserRight"),e.DTP_GR_SERVER_TITLE=1,e.MDM_GR_USER=3,e.SUB_GR_USER_RULE=1,e.SUB_GR_USER_LOOKON=2,e.SUB_GR_USER_SITDOWN=3,e.SUB_GR_USER_STANDUP=4,e.SUB_GR_USER_APPLY=5,e.SUB_GR_USER_FEE_QUERY=6,e.SUB_GR_USER_REPULSE_SIT=7,e.SUB_GR_USER_INFO_REQ=8,e.SUB_GR_USER_CHAIR_REQ=9,e.SUB_GR_USER_CHAIR_INFO_REQ=10,e.SUB_GR_USER_DISMISS_TABLE=11,e.SUB_GR_USER_ENTER=100,e.SUB_GR_USER_SCORE=101,e.SUB_GR_USER_STATUS=102,e.SUB_GR_USER_SEGMENT=103,e.SUB_GR_REQUEST_FAILURE=104,e.SUB_GR_USER_WEALTH=105,e.SUB_GR_USER_WAIT_DISTRIBUTE=106,e.SUB_GR_USER_DISMISS_RESULT=107,e.SUB_GR_USER_MATCH_SHARE=108,e.SUB_GR_USER_CHAT=200,e.SUB_GR_USER_WISPER=201,e.SUB_GR_USER_CONVERSATION=202,e.SUB_GR_USER_BUGLE=203,e.SUB_GR_WHSPER_REPLY=204,e.SUB_GR_INVITE_USER=300,e.RFC_PASSpublic_INCORRECT=1,e.RFC_TMP_PASSWD_INCORRECT=2,e.BUGLE_TYPE_ROOM=0,e.BUGLE_TYPE_GAME=1,e.BUGLE_TYPE_PLATFORM=2,e.CONSUMER_ROOM_BUGLE=0,e.CONSUMER_GAME_BUGLE=1,e.CONSUMER_PLATFORM_BUGLE=2,e.CONSUMER_MATCH_FEE=3;var h=function(){function e(){}return e}();e.CMD_GR_UserLookon=h,__reflect(h.prototype,"df.CMD_GR_UserLookon");var u=function(){function e(){}return e}();e.CMD_GR_UserSitDown=u,__reflect(u.prototype,"df.CMD_GR_UserSitDown");var d=function(){function e(){}return e}();e.CMD_GR_UserStandUp=d,__reflect(d.prototype,"df.CMD_GR_UserStandUp");var p=function(){function e(){}return e}();e.CMD_GR_UserScore=p,__reflect(p.prototype,"df.CMD_GR_UserScore");var m=function(){function e(){}return e}();e.CMD_GR_MobileUserScore=m,__reflect(m.prototype,"df.CMD_GR_MobileUserScore");var g=function(){function e(){}return e}();e.CMD_GR_UserSegment=g,__reflect(g.prototype,"df.CMD_GR_UserSegment");var f=function(){function e(){}return e}();e.CMD_GR_UserStatus=f,__reflect(f.prototype,"df.CMD_GR_UserStatus");var E=function(){function e(){}return e}();e.CMD_GR_UserWealth=E,__reflect(E.prototype,"df.CMD_GR_UserWealth");var C=function(){function e(e){this.cbFailureCode=e.cbBuffer.Pop_Byte(),this.szDescribeString=e.cbBuffer.Pop_UTF16(e.cbBuffer.getByteArray().bytesAvailable/2)}return e}();e.CMD_GR_RequestFailure=C,__reflect(C.prototype,"df.CMD_GR_RequestFailure");var v=function(){function e(){}return e}();e.CMD_GR_S_UserChat=v,__reflect(v.prototype,"df.CMD_GR_S_UserChat");var S=function(){function e(){}return e}();e.CMD_GR_R_UserChat=S,__reflect(S.prototype,"df.CMD_GR_R_UserChat");var T=function(){function e(){}return e}();e.CMD_GR_S_UserWisper=T,__reflect(T.prototype,"df.CMD_GR_S_UserWisper");var I=function(){function e(){}return e}();e.CMD_GR_R_UserWisper=I,__reflect(I.prototype,"df.CMD_GR_R_UserWisper");var y=function(){function e(){}return e}();e.CMD_GR_UserConversation=y,__reflect(y.prototype,"df.CMD_GR_UserConversation");var R=function(){function e(){}return e}();e.CMD_GR_UserRepulseSit=R,__reflect(R.prototype,"df.CMD_GR_UserRepulseSit");var D=function(){function e(){}return e}();e.CMD_GR_UserInfoReq=D,__reflect(D.prototype,"df.CMD_GR_UserInfoReq");var w=function(){function e(){}return e}();e.CMD_GR_ChairUserInfoReq=w,__reflect(w.prototype,"df.CMD_GR_ChairUserInfoReq");var A=function(){function e(){}return e}();e.CMD_GR_DismissTable=A,__reflect(A.prototype,"df.CMD_GR_DismissTable");var b=function(){function e(){}return e}();e.CMD_GR_DismissResult=b,__reflect(b.prototype,"df.CMD_GR_DismissResult");var O=function(){function e(){}return e}();e.CMD_GR_UserMatchShare=O,__reflect(O.prototype,"df.CMD_GR_UserMatchShare");var L=function(){function e(){}return e}();e.CMD_GR_R_InviteUser=L,__reflect(L.prototype,"df.CMD_GR_R_InviteUser");var N=function(){function e(){}return e}();e.CMD_GR_S_InviteUser=N,__reflect(N.prototype,"df.CMD_GR_S_InviteUser");var M=function(){function e(){}return e}();e.CMD_GR_UserBugle=M,__reflect(M.prototype,"df.CMD_GR_UserBugle"),e.UR_LIMIT_SAME_IP=1,e.UR_LIMIT_WIN_RATE=2,e.UR_LIMIT_FLEE_RATE=4,e.UR_LIMIT_GAME_SCORE=8;var B=function(){function e(){}return e}();e.CMD_GR_UserRule=B,__reflect(B.prototype,"df.CMD_GR_UserRule"),e.MDM_GR_STATUS=4,e.SUB_GR_TABLE_INFO=100,e.SUB_GR_TABLE_STATUS=101,e.SUB_GR_TABLE_SCORE=102,e.SUB_GR_SCORE_VARIATION=103;var U=function(){function e(){}return e}();e.CMD_GR_TableInfo=U,__reflect(U.prototype,"df.CMD_GR_TableInfo");var G=function(){function e(){}return e}();e.CMD_GR_TableStatus=G,__reflect(G.prototype,"df.CMD_GR_TableStatus");var P=function(){function e(){}return e}();e.CMD_GR_TableScore=P,__reflect(P.prototype,"df.CMD_GR_TableScore");var x=function(){function e(){}return e}();e.CMD_GR_ScoreVariation=x,__reflect(x.prototype,"df.CMD_GR_ScoreVariation"),e.MDM_GR_MANAGE=5,e.SUB_GR_SEND_WARNING=1,e.SUB_GR_SEND_MESSAGE=2,e.SUB_GR_LOOK_USER_IP=3,e.SUB_GR_KILL_USER=4,e.SUB_GR_LIMIT_ACCOUNS=5,e.SUB_GR_SET_USER_RIGHT=6,e.SUB_GR_OPTION_SERVER=7,e.SUB_GR_KICK_ALL_USER=8,e.SUB_GR_LIMIT_USER_CHAT=9,e.SUB_GR_TABLE_RULE=10,e.SUB_GR_SERVER_OPTION=11,e.SUB_GR_DISMISSGAME=12,e.SUB_GR_DISMISS_MATCH=13,e.OSW_ROOM=1,e.OSW_GAME=2;var k=function(){function e(){}return e}();e.CMD_GR_SendWarning=k,__reflect(k.prototype,"df.CMD_GR_SendWarning");var F=function(){function e(){}return e}();e.CMD_GR_SendMessage=F,__reflect(F.prototype,"df.CMD_GR_SendMessage");var W=function(){function e(){}return e}();e.CMD_GR_LookUserIP=W,__reflect(W.prototype,"df.CMD_GR_LookUserIP");var H=function(){function e(){}return e}();e.CMD_GR_KillUser=H,__reflect(H.prototype,"df.CMD_GR_KillUser");var V=function(){function e(){}return e}();e.CMD_GR_DismissGame=V,__reflect(V.prototype,"df.CMD_GR_DismissGame");var Y=function(){function e(){}return e}();e.CMD_GR_DismissMatch=Y,__reflect(Y.prototype,"df.CMD_GR_DismissMatch");var K=function(){function e(){}return e}();e.CMD_GR_LimitAccounts=K,__reflect(K.prototype,"df.CMD_GR_LimitAccounts");var z=function(){function e(){}return e}();e.CMD_GR_SetUserRight=z,__reflect(z.prototype,"df.CMD_GR_SetUserRight");var X=function(){function e(){}return e}();e.CMD_GR_OptionServer=X,__reflect(X.prototype,"df.CMD_GR_OptionServer");var Q=function(){function e(){}return e}();e.CMD_GR_KickAllUser=Q,__reflect(Q.prototype,"df.CMD_GR_KickAllUser");var j=function(){function e(){}return e}();e.CMD_GR_LimitUserChat=j,__reflect(j.prototype,"df.CMD_GR_LimitUserChat");var J=function(){function e(){}return e}();e.CMD_GR_ManageServerOption=J,__reflect(J.prototype,"df.CMD_GR_ManageServerOption"),e.MDM_GR_MEMBER=6,e.SUB_GR_KICK_USER=1;var q=function(){function e(){}return e}();e.CMD_GR_KickUser=q,__reflect(q.prototype,"df.CMD_GR_KickUser"),e.OSF_ROOM_CHAT=1,e.OSF_GAME_CHAT=2,e.OSF_ROOM_WISPER=3,e.OSF_ENTER_ROOM=4,e.OSF_ENTER_GAME=5,e.OSF_PLAY_CHAT=6,e.OSF_REMOTE_SEARCH=7,e.OSF_ANDROID_ATTEND=8,e.OSF_ANDROID_SIMULATE=9,e.OSF_CLOSE_NOPLAYER=10,e.OSF_MEMBER_CAN_CHAT=11,e.OSF_LOOK_ON=12,e.OSF_SEND_BUGLE=13,e.OSF_LOOK_ON_CHAT=14,e.MDM_GR_QUERY=7,e.SUB_GR_QUERY_BY_GAMEID=1,e.SUB_GR_QUERY_BY_ACCOUNTS=2,e.SUB_GR_QUERY_USER_RESULT=200,e.SUB_GR_QUERY_NOT_FOUND=201;var Z=function(){function e(){}return e}();e.CMD_GR_QueryByGameID=Z,__reflect(Z.prototype,"df.CMD_GR_QueryByGameID");var $=function(){function e(){}return e}();e.CMD_GR_QueryByAccounts=$,__reflect($.prototype,"df.CMD_GR_QueryByAccounts");var et=function(){function e(){}return e}();e.CMD_GR_QueryNotFound=et,__reflect(et.prototype,"df.CMD_GR_QueryNotFound"),e.QUERY_NOT_FOUND=1,e.QUERY_FORBID_USE=2,e.MDM_GR_MATCH=8,e.SUB_GR_MATCH_SIGNUP=1,e.SUB_GR_MATCH_UNSIGNUP=2,e.SUB_GR_MATCH_REVIVE=3,e.SUB_GR_SHARE_MATCH=4,e.SUB_GR_MATCH_NUMBER=10,e.SUB_GR_MATCH_STATUS=11,e.SUB_GR_MATCH_USTATUS=12,e.SUB_GR_SHARE_RESULT=13,e.SUB_GR_SIGNUP_SUCCESS=14;var tt=function(){function e(){}return e}();e.CMD_GR_MatchRequest=tt,__reflect(tt.prototype,"df.CMD_GR_MatchRequest");var nt=function(){function e(){}return e}();e.tagLockTimeMatchData=nt,__reflect(nt.prototype,"df.tagLockTimeMatchData");var it=function(){function e(){}return e}();e.tagImmediateMatchData=it,__reflect(it.prototype,"df.tagImmediateMatchData");var rt=function(){function e(){}return e}();e.CMD_GR_MatchNumber=rt,__reflect(rt.prototype,"df.CMD_GR_MatchNumber");var ot=function(){function e(){}return e}();e.CMD_GR_ShareResult=ot,__reflect(ot.prototype,"df.CMD_GR_ShareResult"),e.MDM_GF_FRAME=100,e.SUB_GF_GAME_OPTION=1,e.SUB_GF_USER_READY=2,e.SUB_GF_USER_CHAT=3,e.SUB_GF_LOOKON_CONFIG=4,e.SUB_GF_USER_LOOK2SIT=5,e.SUB_GF_USER_SIT2LOOK=6,e.SUB_GF_JOIN_GAME=7,e.SUB_GF_USER_BUGLE=8,e.SUB_GF_USER_VOICE=9,e.SUB_GF_LAUNCH_DISMISS=10,e.SUB_GF_BALLOT_DISMISS=11,e.SUB_GF_MATCH_DATA=20,e.SUB_GF_MATCH_RANK=21,e.SUB_GF_MATCH_SCORE=22,e.SUB_GF_MATCH_WAIT=23,e.SUB_GF_MATCH_PROMOTE=24,e.SUB_GF_MATCH_ELIMINATE=25,e.SUB_GF_MATCH_ROUND_SWITCH=26,e.SUB_GF_MATCH_RESULT=30,e.SUB_GF_GAME_STATUS=100,e.SUB_GF_GAME_SCENE=101,e.SUB_GF_LOOKON_STATUS=102,e.SUB_GF_TABLE_PARAM=150,e.SUB_GF_TABLE_BATTLE=151,e.SUB_GF_TABLE_GRADE=152,e.SUB_GF_TABLE_PARAMEX=153,e.SUB_GF_VIDEO_PARAM=154,e.SUB_GF_DISMISS_NOTIFY=160,e.SUB_GF_DISMISS_BALLOT=161,e.SUB_GF_DISMISS_SUCCESS=162,e.SUB_GF_SYSTEM_MESSAGE=200,e.SUB_GF_ACTION_MESSAGE=201;var st=function(){function e(){}return e}();e.CMD_GF_GameOption=st,__reflect(st.prototype,"df.CMD_GF_GameOption");var at=function(){function e(){}return e}();e.CMD_GF_GameStatus=at,__reflect(at.prototype,"df.CMD_GF_GameStatus");var ct=function(){function e(){}return e}();e.CMD_GF_SendVoice=ct,__reflect(ct.prototype,"df.CMD_GF_SendVoice");var _t=function(){function e(){}return e}();e.CMD_GF_UserVoice=_t,__reflect(_t.prototype,"df.CMD_GF_UserVoice");var lt=function(){function e(){}return e}();e.CMD_GF_LookonConfig=lt,__reflect(lt.prototype,"df.CMD_GF_LookonConfig");var ht=function(){function e(){}return e}();e.CMD_GF_LookonStatus=ht,__reflect(ht.prototype,"df.CMD_GF_LookonStatus");var ut=function(){function e(){}return e}();e.CMD_GF_Look2Sit=ut,__reflect(ut.prototype,"df.CMD_GF_Look2Sit");var dt=function(){function e(){}return e}();e.CMD_GF_Sit2Look=dt,__reflect(dt.prototype,"df.CMD_GF_Sit2Look");var pt=function(){function e(){}return e}();e.CMD_GF_MatchScore=pt,__reflect(pt.prototype,"df.CMD_GF_MatchScore");var mt=function(){function e(){}return e}();e.CMD_GF_MatchData=mt,__reflect(mt.prototype,"df.CMD_GF_MatchData");var gt=function(){function e(){}return e}();e.CMD_GF_MatchWait=gt,__reflect(gt.prototype,"df.CMD_GF_MatchWait");var ft=function(){function e(){}return e}();e.CMD_GF_MatchPromote=ft,__reflect(ft.prototype,"df.CMD_GF_MatchPromote");var Et=function(){function e(){}return e}();e.CMD_GF_MatchEliminate=Et,__reflect(Et.prototype,"df.CMD_GF_MatchEliminate");var Ct=function(){function e(){}return e}();e.CMD_GF_MatchRoundSwitch=Ct,__reflect(Ct.prototype,"df.CMD_GF_MatchRoundSwitch");var vt=function(){function e(){}return e}();e.CMD_GF_MatchResult=vt,__reflect(vt.prototype,"df.CMD_GF_MatchResult");var St=function(){function e(){}return e}();e.CMD_GF_TableParam=St,__reflect(St.prototype,"df.CMD_GF_TableParam");var Tt=function(){function e(){}return e}();e.CMD_GF_VideoParam=Tt,__reflect(Tt.prototype,"df.CMD_GF_VideoParam");var It=function(){function e(){}return e}();e.CMD_GF_BallotDismiss=It,__reflect(It.prototype,"df.CMD_GF_BallotDismiss");var yt=function(){function e(){}return e}();e.CMD_GF_DismissNotify=yt,__reflect(yt.prototype,"df.CMD_GF_DismissNotify");var Rt=function(){function e(){}return e}();e.CMD_GF_DismissBallot=Rt,__reflect(Rt.prototype,"df.CMD_GF_DismissBallot"),e.MDM_GF_GAME=200,e.DTP_GR_COMPUTER_ID=1,e.DTP_GR_TABLE_PASSpublic=2,e.DTP_GR_VERIFY_COMPUTER_ID=3,e.DTP_GR_USER_ACCOUNTS=10,e.DTP_GR_USER_GROUP_NAME=11,e.DTP_GR_USER_UNDER_WRITE=12,e.DTP_GR_AREA=20,e.DTP_GR_CITY=21,e.DTP_GR_PROVINCE=22,e.DTP_GR_CUSTOM_FACE=23,e.DTP_GR_USER_NOTE=30,e.DTP_GR_SERVER_INFO=40,e.REQUEST_FAILURE_NORMAL=0,e.REQUEST_FAILURE_NOGOLD=1,e.REQUEST_FAILURE_NOSCORE=2,e.REQUEST_FAILURE_PASSpublic=3,e.MDM_CM_SYSTEM=1e3,e.SUB_CM_SYSTEM_MESSAGE=1,e.SUB_CM_ACTION_MESSAGE=2,e.SMT_CHAT=1,e.SMT_EJECT=2,e.SMT_GLOBAL=4,e.SMT_PROMPT=8,e.SMT_TABLE_ROLL=16,e.SMT_CLOSE_ROOM=256,e.SMT_CLOSE_GAME=512,e.SMT_CLOSE_LINK=1024,e.SMT_SHOW_MOBILE=4096}(df||(df={}));var cmd;!function(e){var t;!function(e){e.GAME_PLAYER=4,e.PLAYER_COUNT=3,e.MY_VIEW=0,e.MAX_WEAVE=3,e.MAX_RIGHT_COUNT=2,e.MAX_INDEX=27,e.MAX_COUNT=11,e.MAX_REPERTORY=72,e.GAME_SCENE_FREE=0,e.GS_PLAYING=102,e.GAME_ACTION_NULL=0,e.GAME_ACTION_WIND=1,e.GAME_ACTION_RAIN=2,e.GAME_ACTION_CHI_HU=4,e.OUT_CARD_JIA_GANG=1,e.OUT_CARD_QING_HU=2,e.SUB_S_GAME_START=100,e.SUB_S_OUT_CARD=101,e.SUB_S_SEND_CARD=102,e.SUB_S_NOGANG_INFO=103,e.SUB_S_OPERATE_NOTIFY=104,e.SUB_S_OPERATE_RESULT=105,e.SUB_S_CHIHU_RESULT=107,e.SUB_S_GAME_END=108,e.SUB_S_TRUSTEE=109,e.SUB_S_VOICEPHRASE=110,e.SUB_S_GAME_ACTION_NOTIFY=112,e.SUB_S_GAME_RULE_SETTING=113,e.SUB_S_GAME_RULE_NOTIFY=114,e.SUB_S_BAO_HU_NOTIFY=115,e.SUB_S_TRANSFER_NOTIFY=116,e.SUB_C_OUT_CARD=1,e.SUB_C_OPERATE_CARD=2,e.SUB_C_TRUSTEE=3,e.SUB_C_SEND_CARD=4,e.SUB_C_VOICEPHRASE=5,e.SUB_C_GAME_RULE_SETTING=7,e.SUB_C_USER_BAO_HU=8,e.WIK_NULL=0,e.WIK_LEFT=1,e.WIK_PENG=2,e.WIK_GANG=4,e.WIK_JIA_GANG=8,e.WIK_BAO_HU=16,e.WIK_QING_HU=32,e.WIK_CHI_HU=64,e.WIK_DIAN_PAO=128,e.WIK_EX_TIAN_HU=256,e.WIK_EX_DI_HU=512,e.WIK_EX_FANG_PAO=1024,e.WIK_EX_CHI_HU=2048,e.WIK_EX_ZIMO=4096,e.WIK_EX_GANG_PAO=8192,e.WIK_EX_GANG_KAI=16384,e.WIK_EX_QING_HU=32768,e.WIK_EX_LIU_JU=272,e.WIK_EX_CHI_BAO_HU=1,e.WIK_EX_CHI_QING_HU=2,e.CHR_PING_HU=1,e.CHR_DUI_DUI_HU=2,e.CHR_QING_DUI=4,e.CHR_JIANG_DUI=8,e.CHR_QING_YI_SE=16,e.CHR_WU_DUI=32,e.CHR_QING_WU_DUI=64,e.CHR_JIANG_WU_DUI=128,e.CHR_LONG_WU_DUI=256,e.CHR_QLONG_WU_DUI=512,e.CHR_JLONG_WU_DUI=1024,e.CHR_QJLONG_WU_DUI=2048,e.CHR_TAKE_YI_JIU=4096,e.CHR_QING_TAKE_YI_JIU=32768,e.CHR_DUI_TAKE_YI_JIU=8192,e.CHR_LDUI_TAKE_YI_JIU=16384,e.CHR_TIAN_HU=65536,e.CHR_DI_HU=131072,e.CHR_BREAK_YI_JIU=1048576,e.CHR_GANG_KAI=2097152,e.CHR_GANG_PAO=4194304,e.CHR_QIANG_GANG=8388608,e.CHR_HAI_DI_LAO=16777216,e.CHR_HAI_DI_PAO=33554432,e.CHR_BAO_JIAO=67108864,e.MASK_CHI_HU_RIGHT=268435455,e.MASK_COLOR=240,e.MASK_VALUE=15,e.IDI_GAME_START=1,e.IDI_OPERATE_CARD=2,e.IDI_BAO_JIAO=3,e.IDI_DLEAY_MATCH=4,e.TIME_GAME_START=20,e.TIME_OPERATE_CARD=15,e.TIME_BAO_JIAO=10,e.MS_NAME={1:"[出牌命令]",2:"[操作扑克]",3:"[用户托管]",4:"[发送扑克]",5:"[语音短语]",7:"[规则设置]",8:"[报胡命令]",100:"[游戏开始]",101:"[用户出牌]",102:"[发送扑克]",104:"[操作提示]",105:"[操作结果]",107:"[吃胡命令]",108:"[游戏结束]",109:"[用户托管]",110:"[语言短语]",112:"[动作提醒]",113:"[规则设置]",114:"[规则提醒]",115:"[报胡提醒]",116:"[呼叫转移]"};var t=function(){function e(){}return e}();e.tagCustomOption=t,__reflect(t.prototype,"cmd.sparrowsclm.tagCustomOption");var n=function(){function e(){this.cbCardData=utils.allocArray(4,Number),this.cbCardCount=[0,0,0,0],this.cbWeaveKind=0,this.cbCenterCard=0,this.cbPublicCard=0,this.wProvideUser=0,this.cbCardData=[0,0,0,0],this.cbCardCount=[0,0,0,0]}return e.prototype.readBuffer=function(e){this.cbWeaveKind=e.Pop_Byte(),this.cbCenterCard=e.Pop_Byte(),this.cbPublicCard=e.Pop_Byte(),this.wProvideUser=e.Pop_WORD();for(var t=0;4>t;t++)this.cbCardData[t]=e.Pop_Byte();for(var t=0;4>t;t++)this.cbCardCount[t]=e.Pop_Byte()},e}();e.tagWeaveItem=n,__reflect(n.prototype,"cmd.sparrowsclm.tagWeaveItem");var i=function(){function e(){this.cbActionType=0,this.cbActionCode=0,this.wOperaterUser=0,this.wProvideUser=0}return e.prototype.readBuffer=function(e){this.cbActionType=e.Pop_Byte(),this.cbActionCode=e.Pop_Byte(),this.wOperaterUser=e.Pop_WORD(),this.wProvideUser=e.Pop_WORD()},e}();e.tagGameAction=i,__reflect(i.prototype,"cmd.sparrowsclm.tagGameAction");var r=function(){function e(){this.cbGamePlayer=0,this.cbAllowJoin=0,this.lBaseScore=0}return e.prototype.readBuffer=function(e){this.cbGamePlayer=e.Pop_Byte(),this.cbAllowJoin=e.Pop_Byte(),this.lBaseScore=e.Pop_SCORE()},e}();e.tagGameRuleParams=r,__reflect(r.prototype,"cmd.sparrowsclm.tagGameRuleParams");var o=function(){function e(){this.cbOperateCode=0,this.wRecodeParam=0}return e.prototype.readBuffer=function(e){this.cbOperateCode=e.Pop_Byte(),this.wRecodeParam=e.Pop_WORD()},e}();e.tagActionInfo=o,__reflect(o.prototype,"cmd.sparrowsclm.tagActionInfo");var s=function(){function e(){this.nWindFanShu=[0,0],this.nRainFanShu=[0,0],this.nChiHuFanShu=[0,0,0,0],this.lTransferScore=0}return e.prototype.readBuffer=function(e){for(var t=0;2>t;t++)this.nWindFanShu[t]=e.Pop_INT();for(var t=0;2>t;t++)this.nRainFanShu[t]=e.Pop_INT();for(var t=0;4>t;t++)this.nChiHuFanShu[t]=e.Pop_INT();this.lTransferScore=e.Pop_SCORE()},e}();e.tagSettlementInfo=s,__reflect(s.prototype,"cmd.sparrowsclm.tagSettlementInfo");var a=function(){function e(){this.lTransferScore=[0,0,0,0],this.cbTransferValid=0,this.cbGameActionIndex=0,this.cbTransferCount=0}return e.prototype.readBuffer=function(e){},e}();e.tagTransferInfo=a,__reflect(a.prototype,"cmd.sparrowsclm.tagTransferInfo");var c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.bUserTransfer=[0,0,0,0],t}return __extends(t,e),t}(a);e.tagTransferItem=c,__reflect(c.prototype,"cmd.sparrowsclm.tagTransferItem");var _=function(){function t(t){this.bTrustee=[!1,!1,!1,!1],this.lTurnScore=[0,0,0,0],this.lCollectScore=[0,0,0,0],this.wBankerUser=t.Pop_WORD();for(var n=0;n<e.GAME_PLAYER;n++)this.bTrustee[n]=t.Pop_BOOL();this.lCellScore=t.Pop_SCORE(),this.bAllowJoin=t.Pop_BOOL(),this.bIsRuleSetting=t.Pop_BOOL();for(var n=0;n<e.GAME_PLAYER;n++)this.lTurnScore[n]=t.Pop_SCORE();for(var n=0;n<e.GAME_PLAYER;n++)this.lTurnScore[n]=t.Pop_SCORE()}return t}();e.CMD_S_StatusFree=_,__reflect(_.prototype,"cmd.sparrowsclm.CMD_S_StatusFree");var l=function(){function t(){this.cbNoGangCard=[0,0,0],this.cbUserStatusnumber=[0,0,0,0],this.cbDiscardCount=[0,0,0,0],this.cbDiscardCard=utils.alloc2Array(e.GAME_PLAYER,60,Number),this.cbCardCount=[0,0,0,0],this.cbCardData=utils.alloc2Array(e.GAME_PLAYER,e.MAX_COUNT,Number),this.cbChiHuCardData=[0,0,0,0],this.cbWeaveCount=[0,0,0,0],this.WeaveItemArray=utils.alloc2Array(e.GAME_PLAYER,e.MAX_WEAVE,n),this.cbHeapCardInfo=utils.alloc2Array(e.GAME_PLAYER,2,Number),this.lTurnScore=[0,0,0,0],this.lCollectScore=[0,0,0,0],this.bUserBaoFlag=[0,0,0,0],this.wUserHuKind=[0,0,0,0],this.nGameActionFanShu=utils.alloc2Array(5*e.GAME_PLAYER,e.GAME_PLAYER,Number),this.GameActionArray=utils.allocArray(5*e.GAME_PLAYER,i),this.TransferInfoArray=utils.allocArray(e.GAME_PLAYER-1,a)}return t.prototype.readBuffer=function(t){this.wBankerUser=t.Pop_WORD(),this.wCurrentUser=t.Pop_WORD(),this.wCurrBaoUser=t.Pop_WORD(),this.lCellScore=t.Pop_SCORE(),this.lSiceCount=t.Pop_LONG();for(var n=0;3>n;n++)this.cbNoGangCard[n]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.cbUserStatusnumber[n]=t.Pop_Byte();this.cbActionCard=t.Pop_Byte(),this.cbActionMask=t.Pop_Byte(),this.cbLeftCardCount=t.Pop_Byte(),this.bSelfTrustee=t.Pop_BOOL(),this.bAllowJoin=t.Pop_BOOL(),this.wOutCardUser=t.Pop_WORD(),this.cbOutCardData=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.cbDiscardCount[n]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)for(var i=0;60>i;i++)this.cbDiscardCard[n][i]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.cbCardCount[n]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)for(var i=0;i<e.MAX_COUNT;i++)this.cbCardData[n][i]=t.Pop_Byte();this.cbSendCardData=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.cbChiHuCardData[n]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.cbWeaveCount[n]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)for(var i=0;i<e.MAX_WEAVE;i++){var r=this.WeaveItemArray[n][i];r.readBuffer(t)}this.wHeapHand=t.Pop_WORD(),this.wHeapTail=t.Pop_WORD();for(var n=0;n<e.GAME_PLAYER;n++)for(var i=0;2>i;i++)this.cbHeapCardInfo[n][i]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.lTurnScore[n]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.lCollectScore[n]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.bUserBaoFlag[n]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.wUserHuKind[n]=t.Pop_WORD();this.cbGameActionCount=t.Pop_Byte();for(var n=0;n<5*e.GAME_PLAYER;n++)for(var i=0;i<e.GAME_PLAYER;i++)this.nGameActionFanShu[n][i]=t.Pop_INT();for(var n=0;n<5*e.GAME_PLAYER;n++){var o=this.GameActionArray[n];o.readBuffer(t)
}for(var n=0;n<e.GAME_PLAYER-1;n++){var s=this.TransferInfoArray[n];s.readBuffer(t)}},t}();e.CMD_S_StatusPlay=l,__reflect(l.prototype,"cmd.sparrowsclm.CMD_S_StatusPlay");var h=function(){function t(){this.cbCardData=utils.allocArray(e.MAX_COUNT,Number),this.cbHeapCardInfo=utils.alloc2Array(e.GAME_PLAYER,2,Number)}return t.prototype.readBuffer=function(t){this.lSiceCount=t.Pop_LONG(),this.wBankerUser=t.Pop_WORD(),this.wCurrentUser=t.Pop_WORD(),this.wCurrBaoUser=t.Pop_WORD(),this.cbUserAction=t.Pop_Byte();for(var n=0;n<e.MAX_COUNT;n++)this.cbCardData[n]=t.Pop_Byte();this.wHeapHead=t.Pop_WORD(),this.wHeapTail=t.Pop_WORD();for(var n=0;n<e.GAME_PLAYER;n++)for(var i=0;2>i;i++)this.cbHeapCardInfo[n][i]=t.Pop_Byte()},t}();e.CMD_S_GameStart=h,__reflect(h.prototype,"cmd.sparrowsclm.CMD_S_GameStart");var u=function(){function t(){this.nPerUserFanCount=utils.allocArray(e.GAME_PLAYER,Number),this.GameAction=new i}return t.prototype.readBuffer=function(t){this.GameAction.readBuffer(t);for(var n=0;n<e.GAME_PLAYER;n++)this.nPerUserFanCount[n]=t.Pop_INT()},t}();e.CMD_S_GAME_ACTION_NOTIFY=u,__reflect(u.prototype,"cmd.sparrowsclm.CMD_S_GAME_ACTION_NOTIFY");var d=function(){function t(){this.lTransferScore=utils.allocArray(e.GAME_PLAYER,Number),this.cbGameActionIndex=0,this.cbTransferCount=0}return t.prototype.readBuffer=function(t){this.cbGameActionIndex=t.Pop_Byte(),this.cbTransferCount=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.lTransferScore[n]=t.Pop_SCORE()},t}();e.CMD_S_TRANSFER_NOTIFY=d,__reflect(d.prototype,"cmd.sparrowsclm.CMD_S_TRANSFER_NOTIFY");var p=function(){function e(){this.bTrusteeOut=!1,this.wOutCardUser=df.INVALID_ITEM,this.cbOutCardData=df.INVALID_BYTE}return e.prototype.readBuffer=function(e){this.bTrusteeOut=e.Pop_BOOL(),this.wOutCardUser=e.Pop_WORD(),this.cbOutCardData=e.Pop_Byte()},e}();e.CMD_S_OutCard=p,__reflect(p.prototype,"cmd.sparrowsclm.CMD_S_OutCard");var m=function(){function e(){this.cbNoGangCard=[0,0,0]}return e.prototype.readBuffer=function(e){for(var t=0;3>t;t++)this.cbNoGangCard[t]=e.Pop_Byte()},e}();e.CMD_S_NOGANG=m,__reflect(m.prototype,"cmd.sparrowsclm.CMD_S_NOGANG");var g=function(){function e(){this.cbCardData=0,this.cbActionMask=0,this.wCurrentUser=df.INVALID_CHAIR,this.bTail=!1}return e.prototype.readBuffer=function(e){this.cbCardData=e.Pop_Byte(),this.cbActionMask=e.Pop_Byte(),this.wCurrentUser=e.Pop_WORD(),this.bTail=e.Pop_BOOL()},e}();e.CMD_S_SendCard=g,__reflect(g.prototype,"cmd.sparrowsclm.CMD_S_SendCard");var f=function(){function e(){this.wResumeUser=df.INVALID_CHAIR,this.cbActionMask=0,this.cbActionCard=0}return e.prototype.readBuffer=function(e){this.wResumeUser=e.Pop_WORD(),this.cbActionMask=e.Pop_Byte(),this.cbActionCard=e.Pop_Byte()},e}();e.CMD_S_OperateNotify=f,__reflect(f.prototype,"cmd.sparrowsclm.CMD_S_OperateNotify");var E=function(){function e(){this.cbOperateCard=[0,0,0],this.wOperateUser=df.INVALID_CHAIR,this.wProvideUser=df.INVALID_CHAIR,this.cbOperateCode=0,this.cbUserAction=0,this.cbExcludeCard=0}return e.prototype.readBuffer=function(e){this.wOperateUser=e.Pop_WORD(),this.wProvideUser=e.Pop_WORD(),this.cbOperateCode=e.Pop_Byte();for(var t=0;3>t;t++)this.cbOperateCard[t]=e.Pop_Byte();this.cbUserAction=e.Pop_Byte(),this.cbExcludeCard=e.Pop_Byte()},e}();e.CMD_S_OperateResult=E,__reflect(E.prototype,"cmd.sparrowsclm.CMD_S_OperateResult");var C=function(){function t(){this.cbCardData=utils.allocArray(e.MAX_COUNT,Number),this.wOperateUser=df.INVALID_CHAIR,this.wProvideUser=df.INVALID_CHAIR,this.wUserHuKind=0,this.cbOperateCard=0,this.bMultplePao=!1,this.bQingHuFlag=!1,this.cbCardCount=0}return t.prototype.readBuffer=function(t){this.wOperateUser=t.Pop_WORD(),this.wProvideUser=t.Pop_WORD(),this.wUserHuKind=t.Pop_WORD(),this.cbOperateCard=t.Pop_Byte(),this.bMultplePao=t.Pop_BOOL(),this.bQingHuFlag=t.Pop_BOOL(),this.cbCardCount=t.Pop_Byte();for(var n=0;n<e.MAX_COUNT;n++)this.cbCardData[n]=t.Pop_Byte()},t}();e.CMD_S_ChiHuResult=C,__reflect(C.prototype,"cmd.sparrowsclm.CMD_S_ChiHuResult");var v=function(){function t(){this.wProvideUser=utils.allocArray(e.GAME_PLAYER,Number),this.cbGengCount=utils.allocArray(e.GAME_PLAYER,Number),this.dwChiHuKind=utils.allocArray(e.GAME_PLAYER,Number),this.dwChiHuRight=utils.alloc2Array(e.GAME_PLAYER,e.MAX_RIGHT_COUNT,Number),this.lGameScore=utils.allocArray(e.GAME_PLAYER,Number),this.lZiMoAddScore=utils.alloc2Array(e.GAME_PLAYER,e.GAME_PLAYER,Number),this.cbCardCount=utils.allocArray(e.GAME_PLAYER,Number),this.cbCardData=utils.alloc2Array(e.GAME_PLAYER,e.MAX_COUNT,Number),this.cbUserCardType=utils.allocArray(e.GAME_PLAYER,Number),this.cbUserGengCount=utils.allocArray(e.GAME_PLAYER,Number),this.cbUserQiaCount=utils.allocArray(e.GAME_PLAYER,Number),this.cbCheckJiaoBeiShu=utils.allocArray(e.GAME_PLAYER,Number),this.UserSettlementInfo=utils.allocArray(e.GAME_PLAYER,s)}return t.prototype.readBuffer=function(t){this.lCellScore=t.Pop_SCORE();for(var n=0;n<e.GAME_PLAYER;n++)this.wProvideUser[n]=t.Pop_WORD();this.wEscapeUser=t.Pop_WORD(),this.cbEscapeFanShu=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.cbGengCount[n]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.dwChiHuKind[n]=t.Pop_DWORD();for(var n=0;n<e.GAME_PLAYER;n++)for(var i=0;i<e.MAX_RIGHT_COUNT;n++)this.dwChiHuRight[n][i]=t.Pop_DWORD();for(var n=0;n<e.GAME_PLAYER;n++)this.lGameScore[n]=t.Pop_SCORE();for(var n=0;n<e.GAME_PLAYER;n++)for(var i=0;i<e.GAME_PLAYER;n++)this.lZiMoAddScore[n][i]=t.Pop_SCORE();for(var n=0;n<e.GAME_PLAYER;n++)this.cbCardCount[n]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)for(var i=0;i<e.MAX_COUNT;n++)this.cbCardData[n][i]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.cbUserCardType[n]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.cbUserGengCount[n]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.cbUserQiaCount[n]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++)this.cbCheckJiaoBeiShu[n]=t.Pop_Byte();for(var n=0;n<e.GAME_PLAYER;n++){var r=this.UserSettlementInfo[n];r.readBuffer(t)}},t}();e.CMD_S_GameEnd=v,__reflect(v.prototype,"cmd.sparrowsclm.CMD_S_GameEnd");var S=function(){function e(){}return e.prototype.readBuffer=function(e){this.bTrustee=e.Pop_BOOL(),this.wChairID=e.Pop_WORD()},e}();e.CMD_S_Trustee=S,__reflect(S.prototype,"cmd.sparrowsclm.CMD_S_Trustee");var T=function(){function t(){this.cbTingCard=utils.allocArray(e.MAX_COUNT,Number)}return t.prototype.readBuffer=function(t){this.wChairId=t.Pop_WORD(),this.cbTingCardCount=t.Pop_Byte();for(var n=0;n<e.MAX_COUNT;n++)this.cbTingCard[n]=t.Pop_Byte()},t}();e.CMD_S_Listen=T,__reflect(T.prototype,"cmd.sparrowsclm.CMD_S_Listen");var I=function(){function t(){this.bUserDingCardColor=utils.allocArray(e.GAME_PLAYER,Number)}return t.prototype.readBuffer=function(t){this.wBankerUser=t.Pop_WORD();for(var n=0;n<e.GAME_PLAYER;n++)this.bUserDingCardColor[n]=t.Pop_Byte()},t}();e.CMD_S_DING_ZHANG_END=I,__reflect(I.prototype,"cmd.sparrowsclm.CMD_S_DING_ZHANG_END");var y=function(){function e(){}return e.prototype.readBuffer=function(e){this.bForceExit=e.Pop_BOOL(),this.bPromptNotice=e.Pop_BOOL(),this.cbGamePlayer=e.Pop_Byte(),this.lBaseScore=e.Pop_SCORE()},e}();e.CMD_S_GAME_RULE_NOTIFY=y,__reflect(y.prototype,"cmd.sparrowsclm.CMD_S_GAME_RULE_NOTIFY");var R=function(){function e(){}return e.prototype.readBuffer=function(e){this.lCellScore=e.Pop_SCORE()},e}();e.CMD_S_GAME_RULE_SETTING=R,__reflect(R.prototype,"cmd.sparrowsclm.CMD_S_GAME_RULE_SETTING");var D=function(){function e(){}return e.prototype.readBuffer=function(e){this.wCurrentUser=e.Pop_WORD(),this.wLastUser=e.Pop_WORD(),this.bBaoHuFlag=e.Pop_BOOL(),this.cbCardData=e.Pop_Byte()},e}();e.CMD_S_BAO_HU_NOTIFY=D,__reflect(D.prototype,"cmd.sparrowsclm.CMD_S_BAO_HU_NOTIFY")}(t=e.sparrowsclm||(e.sparrowsclm={}))}(cmd||(cmd={}));var game;!function(e){var t;!function(e){e.MASK_COLOR=240,e.MASK_VALUE=15,e.MAX_INDEX=27,e.WIK_NULL=0,e.WIK_LEFT=1,e.WIK_PENG=2,e.WIK_GANG=4,e.WIK_JIA_GANG=8,e.WIK_BAO_HU=16,e.WIK_QING_HU=32,e.WIK_CHI_HU=64,e.WIK_EX_CHI_BAO_HU=1,e.WIK_EX_CHI_QING_HU=2,e.WIK_EX_TIAN_HU=256,e.WIK_EX_DI_HU=512,e.WIK_EX_FANG_PAO=1024,e.WIK_EX_CHI_HU=2048,e.WIK_EX_ZIMO=4096,e.WIK_EX_GANG_PAO=8192,e.WIK_EX_GANG_KAI=16384,e.WIK_EX_QING_HU=32768,e.TING_KIND_NONE=0,e.TING_KIND_NORMAL=1,e.TING_KIND_WUDUI=2,e.CHR_PING_HU=1,e.CHR_DUI_DUI_HU=2,e.CHR_QING_DUI=4,e.CHR_JIANG_DUI=8,e.CHR_QING_YI_SE=16,e.CHR_WU_DUI=32,e.CHR_QING_WU_DUI=64,e.CHR_LONG_WU_DUI=256,e.CHR_QLONG_WU_DUI=512,e.CHR_TAKE_YI_JIU=4096,e.CHR_DUI_TAKE_YI_JIU=8192,e.CHR_QING_TAKE_YI_JIU=32768,e.CHR_TIAN_HU=65536,e.CHR_DI_HU=131072,e.CHR_BREAK_YI_JIU=1048576,e.CHR_GANG_KAI=2097152,e.CHR_GANG_PAO=4194304,e.CHR_QIANG_GANG=8388608,e.CHR_HAI_DI_LAO=16777216,e.CHR_HAI_DI_PAO=33554432,e.CHR_BAO_JIAO=67108864;var t=function(){function t(){}return t.prototype.GetCardValue=function(t){var n=0;return n=t&e.MASK_VALUE},t.prototype.GetCardColor=function(t){var n=0;return n=(t&e.MASK_COLOR)>>4},t.prototype.IsValidCard=function(t){var n=t&e.MASK_VALUE,i=(t&e.MASK_COLOR)>>4;return n>=1&&9>=n&&2>=i||n>=1&&15>=n&&3==i},t.prototype.RemoveCard=function(e,t){return!0},t.prototype.SwitchToCardData=function(t){return egret.assert(t<e.MAX_INDEX),27>t?t/9<<4|t%9+1:48|t-27+1},t.prototype.SwitchToCardIndex=function(t){var n=0;return n=9*((t&e.MASK_COLOR)>>4)+(t&e.MASK_VALUE)-1},t.prototype.SortCardList=function(e,t){if(0==t||t>cmd.sparrowsclm.MAX_COUNT)return!1;var n=!0,i=0,r=t-1;do{n=!0;for(var o=0;r>o;o++)e[o]>e[o+1]&&(n=!1,i=e[o],e[o]=e[o+1],e[o+1]=i);r--}while(0==n);return!0},t}();e.GameLogic=t,__reflect(t.prototype,"game.sparrowsclm.GameLogic")}(t=e.sparrowsclm||(e.sparrowsclm={}))}(game||(game={}));var game;!function(e){var t;!function(e){var t=88,n=128,i=255,r={17:"一条",18:"二条",19:"三条",20:"四条",21:"五条",22:"六条",23:"七条",24:"八条",25:"九条",33:"一筒",34:"二筒",35:"三筒",36:"四筒",37:"五筒",38:"六筒",39:"七筒",40:"八筒",41:"九筒"},o=function(o){function s(s,a,c){var _=o.call(this)||this;if(_._cbCardData=0,_._isTouchEnable=!0,_._isShoot=!1,_._nShootSpace=20,_._nCardIndex=0,_._nNormalPosY=0,_._sCardName="",_._sTextureFile="",_.width=c?c.width:t,_.height=c?c.width:n,_._sTextureFile=s,_._gameLogic=new e.GameLogic,_._cbCardData=a,_.once(egret.Event.REMOVED_FROM_STAGE,_.onExit,_),a==i){_._sCardName="牌背";var l=void 0;l=c&&c.bSheet?utils.createTextureByName(s,new egret.Rectangle(0,0,_.width,_.height)):s,_._cardSprite=new eui.Image(l),_.addChild(_._cardSprite)}else if(_._gameLogic.IsValidCard(a)){_._sCardName=r[a],_._nCardIndex=_._gameLogic.SwitchToCardIndex(a)-9;var h=c?c.pos:0,l=RES.getRes("card"+(_._nCardIndex+h));_._cardSprite=new eui.Image(l),_.addChild(_._cardSprite)}return _}return __extends(s,o),s.prototype.setTouchCallBack=function(e){this._touchCallback=null,this._touchCallback=e},s.prototype.onTouch=function(e){!this._isTouchEnable},s.prototype.updateTexture=function(e){if(e!=i&&this._gameLogic.IsValidCard(e)&&null!=this._cardSprite){var r=this._gameLogic.SwitchToCardIndex(e),o=utils.createTextureByName(this._sTextureFile,new egret.Rectangle((r-1)*t,0,t,n));this._cardSprite.source=o}},s.prototype.setShoot=function(e){void 0===e&&(e=!1),this._isShoot=e,this.y=this._isShoot?this._nNormalPosY-this._nShootSpace:this._nNormalPosY},s.prototype.setOrignalPosY=function(e){this._nNormalPosY=e},s.prototype.setCardGray=function(){if(null!=this._cardSprite){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0],t=new egret.ColorMatrixFilter(e);this._cardSprite.filters=[t]}},s.prototype.setNormalCard=function(){this._cardSprite.filters=null},s.prototype.onExit=function(){this._touchCallback=null},s}(egret.DisplayObjectContainer);e.CardSprite=o,__reflect(o.prototype,"game.sparrowsclm.CardSprite")}(t=e.sparrowsclm||(e.sparrowsclm={}))}(game||(game={}));var game;!function(e){var t;!function(e){var t=2,n=1,i=function(){function i(t,n,i){this._cbCardsData=[],this._handCardsObject=[],this._handCardsPanel=[],this._isAllowOut=!1,this._bMoved=!1,this._scene=t,this.onInitCardsData(),this._handCardsPanel[cmd.sparrowsclm.MY_VIEW].addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this._handCardsPanel[cmd.sparrowsclm.MY_VIEW].addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this._handCardsPanel[cmd.sparrowsclm.MY_VIEW].addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this._gameLogic=new e.GameLogic}return i.prototype.onInitCardsData=function(){for(var e=0;e<cmd.sparrowsclm.PLAYER_COUNT;e++)null==this._cbCardsData[e]&&(this._cbCardsData[e]=[]),null==this._handCardsObject[e]&&(this._handCardsObject[e]=[]),this._handCardsPanel[e]=this._scene._companet.getChildByName("handcardArea"+e),this._handCardsPanel[e].removeChildren()},i.prototype.onRestCardsData=function(){for(var e=0;e<cmd.sparrowsclm.PLAYER_COUNT;e++)null!=this._cbCardsData[e]&&(this._cbCardsData[e]=[]),null!=this._handCardsObject[e]&&(this._handCardsObject[e]=[]),this._handCardsPanel[e]=this._scene._companet.getChildByName("handcardArea"+e),this._handCardsPanel[e].removeChildren()},i.prototype.createHandCard=function(i,r,o,s){void 0===o&&(o=!1);for(var a=0;a<r.length;a++)i==cmd.sparrowsclm.MY_VIEW?this._gameLogic.IsValidCard(r[a])&&this._cbCardsData[i].push(r[a]):this._cbCardsData[i].push(r[a]);egret.assert(this._cbCardsData[i].length<=cmd.sparrowsclm.MAX_COUNT);var c="";i==cmd.sparrowsclm.MY_VIEW?c=s?s.texture:"game_handcard_png":i==n?c=s?s.texture:"game_handcard_1_png":i==t&&(c=s?s.texture:"game_handcard_2_png");for(var _=0,a=0;a<r.length;a++){var l=r[a],h=new e.CardSprite(c,l,s);i==cmd.sparrowsclm.MY_VIEW||i==t?this._handCardsPanel[i].addChild(h):i==n&&this._handCardsPanel[i].addChildAt(h,0),this._handCardsObject[i].push(h),_=this._handCardsObject[i].length-1,this.sortCardsPos(i,_,this._handCardsObject[i].length,o)}},i.prototype.sortCardsPos=function(e,i,r,o){this._scene._weaveCard.getWeaveItemCount(e),this._scene._weaveCard.getWeaveItemWidth();switch(e){case cmd.sparrowsclm.MY_VIEW:var s=this._handCardsObject[e][i];s.x=i*s.width+(o?20:0),s.y=505,s.setOrignalPosY(505);break;case n:var s=this._handCardsObject[e][i];s.x=99,s.y=372-38*i+(o?-8:0);break;case t:var s=this._handCardsObject[e][i];s.x=0,s.y=40*i+(o?10:0)}},i.prototype.removeHandCard=function(e,t,n){e==cmd.sparrowsclm.MY_VIEW&&this._gameLogic.RemoveCard(this._cbCardsData[e],n)&&this.updateCardsData(e,this._cbCardsData[e])},i.prototype.updateCardsData=function(e,t){null!=this._cbCardsData[e]&&(this._cbCardsData[e]=[]),this._handCardsPanel[e].removeChildren(),this._handCardsObject[e]=[],this.createHandCard(e,t)},i.prototype.getHandCardData=function(){return this._cbCardsData[cmd.sparrowsclm.MY_VIEW]},i.prototype.sortHandCards=function(){this._gameLogic.SortCardList(this._cbCardsData[cmd.sparrowsclm.MY_VIEW],this._cbCardsData[cmd.sparrowsclm.MY_VIEW].length),this.updateCardsData(cmd.sparrowsclm.MY_VIEW,this._cbCardsData[cmd.sparrowsclm.MY_VIEW])},i.prototype.showSleepCards=function(e,t){},i.prototype.setAllowOutCardStats=function(e){this._isAllowOut=e},i.prototype.onTouchBegan=function(e){console.log("onTouch Began"),this._bMoved=!1;for(var t=new egret.Point(e.localX,e.localY),n=0;n<this._handCardsObject[cmd.sparrowsclm.MY_VIEW].length;n++){var i=this._handCardsObject[cmd.sparrowsclm.MY_VIEW][n],r=i.getBounds();if(r.x=i.x,r.y=i.y,r.containsPoint(t)){if(i._isShoot&&this._isAllowOut)return void(this._scene&&this._scene.onUserOutCard&&this._scene.onUserOutCard(i));i.setShoot(!i._isShoot)}else i.setShoot(!1)}},i.prototype.onTouchMove=function(e){console.log("HandCards onTouch move [x:][y:]",e.localX,e.localY),this._bMoved=!0},i.prototype.onTouchEnd=function(e){console.log("onTouch end")},i.prototype.dealloc=function(){this._handCardsPanel[cmd.sparrowsclm.MY_VIEW].removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this._handCardsPanel[cmd.sparrowsclm.MY_VIEW].removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this._handCardsPanel[cmd.sparrowsclm.MY_VIEW].removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this);for(var e=0;e<cmd.sparrowsclm.PLAYER_COUNT;e++)null==this._cbCardsData[e]&&(this._cbCardsData[e]=null),null==this._handCardsObject[e]&&(this._handCardsObject[e]=null),this._handCardsPanel[e]=this._scene._companet.getChildByName("handcardArea"+e),this._handCardsPanel[e].removeChildren(),this._handCardsPanel[e]=null;this._gameLogic=null,this._cbCardsData=null,this._handCardsPanel=null},i}();e.HandCard=i,__reflect(i.prototype,"game.sparrowsclm.HandCard")}(t=e.sparrowsclm||(e.sparrowsclm={}))}(game||(game={}));var game;!function(e){var t,n=0,i=3;!function(e){var t=function(){function e(e){this._weavePanel=[],this._scene=e,this.onInit()}return e.prototype.onInit=function(){this._nWeaveCount=utils.allocArray(i,Number),this._nWeaveIndex=utils.allocArray(i,Number),this._weaveInfo=utils.alloc2Array(cmd.sparrowsclm.PLAYER_COUNT,i,cmd.sparrowsclm.tagWeaveItem);for(var e=0;e<cmd.sparrowsclm.PLAYER_COUNT;e++)this._weavePanel[e]=this._scene._companet.getChildByName("handcardArea"+e)},e.prototype.onRest=function(){this._nWeaveCount=[0,0,0],this._nWeaveIndex=[0,0,0],this._weaveInfo=[[],[],[]];for(var e=0;e<cmd.sparrowsclm.PLAYER_COUNT;e++)this._weavePanel[e]=this._scene._companet.getChildByName("handcardArea"+e),this._weavePanel[e].removeChildren()},e.prototype.getWeaveItemCount=function(e){return this._nWeaveCount[e]},e.prototype.getWeaveItemWidth=function(e){return 0>e||e>=cmd.sparrowsclm.PLAYER_COUNT?void 0:e==cmd.sparrowsclm.MY_VIEW?n:0},e.prototype.getWeaveItem=function(e,t){return egret.assert(e>=0&&e<cmd.sparrowsclm.PLAYER_COUNT),egret.assert(i>t),t>=i?void 0:null!=this._weaveInfo[e][t]?this._weaveInfo[e][t]:void 0},e.prototype.operateResult=function(e,t){if(egret.assert(t.cbOperateCard[0]>0),0!=t.cbOperateCard[0]){var n={};if(t.cbOperateCode==cmd.sparrowsclm.WIK_GANG&&(n=this.searchWeaveItem(e,cmd.sparrowsclm.WIK_PENG,t.cbOperateCard[0]),null!=n&&null!=n.weaveItem)){var r=n.weaveItem;return r.cbWeaveKind=cmd.sparrowsclm.WIK_GANG,r.cbPublicCard=1,r.wProvideUser=t.wProvideUser,r.cbCardData[0]=Number(t.cbOperateCard),r.cbCardData[1]=Number(t.cbOperateCard),r.cbCardData[2]=Number(t.cbOperateCard),r.cbCardData[3]=Number(t.cbOperateCard),void this.showWeaveItem(e,n,n.nIndex)}if(null!=this._weaveInfo[e][this._nWeaveIndex[e]]&&0==this._weaveInfo[e][this._nWeaveIndex[e]].cbCardData[0]){var r=new cmd.sparrowsclm.tagWeaveItem;r.cbWeaveKind=t.cbOperateCode,r.cbCenterCard=t.cbOperateCard,r.cbPublicCard=t.cbOperateCode==cmd.sparrowsclm.WIK_GANG?0:1,r.wProvideUser=t.wProvideUser,r.cbCardData[0]=Number(t.cbOperateCard),r.cbCardData[1]=Number(t.cbOperateCard),r.cbCardData[2]=Number(t.cbOperateCard),r.cbCardData[3]=t.cbOperateCode==cmd.sparrowsclm.WIK_GANG?Number(t.cbOperateCard):0,this.showWeaveItem(e,r),this._weaveInfo[e][this._nWeaveIndex[e]]=r,this._nWeaveIndex[e]++,this._nWeaveCount[e]++}egret.assert(this._nWeaveIndex[e]<=i)}},e.prototype.setWeaveItem=function(e,t){egret.assert(t.cbCardData[0]>0),egret.assert(t.cbWeaveKind!=cmd.sparrowsclm.WIK_NULL),0!=t.cbCardData[0]&&t.cbWeaveKind!=cmd.sparrowsclm.WIK_NULL&&(null!=this._weaveInfo[e][this._nWeaveIndex[e]]&&0==this._weaveInfo[e][this._nWeaveIndex[e]].cbCardData[0]&&(this._weaveInfo[e][this._nWeaveIndex[e]]=t,this._nWeaveIndex[e]++,this._nWeaveCount[e]++,this.showWeaveItem(e,t)),egret.assert(this._nWeaveIndex[e]<=i))},e.prototype.searchWeaveItem=function(e,t,n){var i={};i.weaveItem=null,i.nIndex=-1;for(var r=0;r<this._weaveInfo[e].length;r++){var o=this._weaveInfo[e][r];if(o.cbWeaveKind==t&&o.cbCenterCard==n){i.weaveItem=o,i.nIndex=r;break}}return i},e.prototype.showWeaveItem=function(e,t,n){t.cbWeaveKind!=cmd.sparrowsclm.WIK_NULL&&(0!=(t.cbWeaveKind&cmd.sparrowsclm.WIK_GANG)?0==t.cbPublicCard?this.createWeaveCard(e,t.cbCardData,4):n?this.createWeaveCard(e,t.cbCenterCard,1,n):this.createWeaveCard(e,t.cbCardData,4):0!=(t.cbWeaveKind&cmd.sparrowsclm.WIK_PENG)&&this.createWeaveCard(e,t.cbCardData,3))},e.prototype.createWeaveCard=function(e,t,n,i){},e.prototype.dealloc=function(){for(var e=0;e<cmd.sparrowsclm.PLAYER_COUNT;e++)this._weavePanel[e]=null;this._weavePanel=null},e}();e.WeaveCard=t,__reflect(t.prototype,"game.sparrowsclm.WeaveCard")}(t=e.sparrowsclm||(e.sparrowsclm={}))}(game||(game={}));var game;!function(e){var t;!function(e){var t=function(e){function t(t,n){var i=e.call(this)||this;return i._clockID=0,i._viewId=0,i._clockMC=[],i._clockTime=0,i._scene=t,i._clockID=n,i.onInitClock(),i.setCurClockID(n),i}return __extends(t,e),t.prototype.onInitClock=function(){for(var e=RES.getRes("anim_json"),t=RES.getRes("anim_png"),n=this._scene._companet,i=0;i<cmd.sparrowsclm.GAME_PLAYER;i++){var r=n.getChildByName("clock"+i),o=new egret.MovieClipDataFactory(e,t),s=new egret.MovieClip(o.generateMovieClipData("clockanim"));r.addChild(s),s.x=-4,this._clockMC.push(s),s.visible=!1}},t.prototype.setClockId=function(e){this._clockID=e},t.prototype.getClockId=function(){return this._clockID},t.prototype.setClockViewId=function(e){this._viewId=e},t.prototype.getClockViewId=function(){return this._viewId},t.prototype.onUpdateClockEvent=function(){this._clockTime-1>=0&&(this._clockTime--,0==this._clockTime&&this._scene&&this._scene.logicTimeZero&&this._scene.logicTimeZero(this.getClockViewId(),this.getClockId()),this.updateShow())},t.prototype.setClockTime=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=cmd.sparrowsclm.MY_VIEW),0>=e||(this._clockTime=e,this.setClockId(t),this.setClockViewId(n),this.setCurClockID(n),this.updateShow())},t.prototype.updateShow=function(){var e="";if(e=this._clockTime>=10?""+this._clockTime:"0"+this._clockTime,null!=this._clockNum)return void this._clockNum.initWithString(e,"game_num_1_png","0123456789",28,52);var t=this._scene._companet,n=utils.LabelAtlas.createLabel(e,"game_num_1_png","0123456789",28,52);utils.setAnchorCenter(n),t.addChild(n),n.x=667,n.y=277,this._clockNum=n},t.prototype.deleteClock=function(){for(var e=(this._scene._companet,0);e<this._clockMC.length;e++){var t=this._clockMC[e];null!=t&&(t.stop(),t=null)}this._clockMC=null},t.prototype.setCurClockID=function(e){if(!(0>e||null==e))if(this._clockID=e,e!=df.INVALID_ITEM)for(var t=0;t<cmd.sparrowsclm.GAME_PLAYER;t++){var n=this._clockMC[t];t==e?(n.visible=!0,n.gotoAndPlay(1,-1)):(n.visible=!1,n.stop())}else for(var t=0;t<cmd.sparrowsclm.GAME_PLAYER;t++){var n=this._clockMC[t];n.visible=!1,n.stop()}},t}(egret.Sprite);e.ClockView=t,__reflect(t.prototype,"game.sparrowsclm.ClockView")}(t=e.sparrowsclm||(e.sparrowsclm={}))}(game||(game={}));var game;!function(e){var t;!function(e){var t=[{x:667,y:618},{x:1074,y:172},{x:144,y:172}],n=function(n){function i(e){var t=n.call(this)||this;return t._wBankerUser=df.INVALID_CHAIR,t._bTrustee=!0,t._lCellScore=0,t._bAllowJoin=!0,t._bIsRuleSetting=!1,t._lTurnScore=[0,0,0,0],t._lCollectScore=[0,0,0,0],t._userList=[],t._nActionIndex=0,t._changeRecord=egret.getTimer(),t._bMoved=!1,t._gameEngine=e,t}return __extends(i,n),i.prototype.createChildren=function(){n.prototype.createChildren.call(this),this.name="GameViewLayer",this.once(egret.Event.ADDED_TO_STAGE,this.onInitLayer,this),this.once(egret.Event.REMOVED_FROM_STAGE,this.onExit,this),this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},i.prototype.onInitLayer=function(){var t=new eui.Component;this.addChild(t),this._companet=t,t.skinName=skins.sparrowsclm.GameLayer,this._handCard=new e.HandCard(this),this._weaveCard=new e.WeaveCard(this),this.showMyselfInfo(),this.initDesk();for(var n=0;n<cmd.sparrowsclm.PLAYER_COUNT;n++)this.onInitUser(n);this.initButton()},i.prototype.onRestGameView=function(){this._wBankerUser=df.INVALID_CHAIR,this._bTrustee=!0,this._lCellScore=0,this._bAllowJoin=!0,this._bIsRuleSetting=!1,this._lTurnScore=[0,0,0,0],this._lCollectScore=[0,0,0,0];var e=this._companet.getChildByName("start");e.visible=!0,e.x=840,e=this._companet.getChildByName("changeDesk"),e.visible=!0,e.x=494,this.stopAllAction();for(var t=0;t<cmd.sparrowsclm.PLAYER_COUNT;t++){var n=this._companet.getChildByName("userinfo"+t),i=n.getChildByName("ready");i.visible=!1,t!=cmd.sparrowsclm.MY_VIEW&&this.onInitUser(t)}for(var t=0;t<this._userList.length;t++){var r=this._userList[t];this._userList.shift(),r=null}this._userList=[],this.initDesk(),null!=this._handCard&&this._handCard.onRestCardsData()},i.prototype.stopAllAction=function(){managers.TimerCtrl.getInstance().killTimer(this,"tipsWait"),this.showWaitTips(0,!1)},i.prototype.drawSice=function(t,n,i){var r=new e.SiceView(t,n,i);this.addChild(r)},i.prototype.createHandCards=function(e,t){var n=e==cmd.sparrowsclm.MY_VIEW?null:{};e!=cmd.sparrowsclm.MY_VIEW&&(n.bSheet=!1,n.texture="game_handcard_"+e+"_png",n.width=24,n.height=63),this._handCard.createHandCard(e,t,1==t.length?!0:!1,n)},i.prototype.onUserOutCard=function(e){},i.prototype.setOperateNotify=function(e){},i.prototype.dispatchCard=function(e,t){for(var n=this,i=[],r=function(t){var r=e[t],o=function(){n.createHandCards(r.viewId,r.cardData)};i.push(o)},o=0;o<e.length;o++)r(o);null!=t&&i.push(t),this._nActionIndex=0,this.startDispatch(i)},i.prototype.startDispatch=function(e){var t=this;null!=e&&egret.Tween.get(this).wait(50).call(function(){var n=e[t._nActionIndex];if(null!=n){if(t._nActionIndex++,t._nActionIndex==e.length&&(e=null),n(),null==e)return;t._nActionIndex<e.length&&t.startDispatch(e)}})},i.prototype.initDesk=function(){var e=this._gameEngine._gameFrame.getTableID()+1;if(e!=df.INVALID_TABLE+1){if(null!=this.getChildByName("deskNum")){var t=this.getChildByName("deskNum");t.initWithString(""+e,"yz_num_count_png",":/0123456789",28,35)}else{var t=utils.LabelAtlas.createLabel(""+e,"yz_num_count_png",":/0123456789",28,35);t.name="deskNum",utils.setAnchorLeftMid(t),t.x=565,t.y=115,this.addChild(t)}var n=utils.StringUtils.formatNumberThousands(this._lCellScore);if(null!=this.getChildByName("deskCell")){var i=this.getChildByName("deskCell");i.initWithString(n,"yz_num_cell_png",",0123456789",28,35)}else{var i=utils.LabelAtlas.createLabel(n,"yz_num_cell_png",",0123456789",28,35);i.name="deskCell",utils.setAnchorLeftMid(i),i.x=815,i.y=115,this.addChild(i)}}},i.prototype.showMyselfInfo=function(){var e=this._gameEngine.getMeUserItem();if(null!=e){e.cbUserStatus==df.US_READY&&this.showUserReady(e);var n=this._companet.getChildByName("userinfo0"),i=models.HeadSprite.createHead(e,120,120,35,35);utils.setAnchorCenter(i),n.addChild(i),i.x=t[cmd.sparrowsclm.MY_VIEW].x,i.y=t[cmd.sparrowsclm.MY_VIEW].y;var r=n.getChildByName("userID");r.text="ID:"+e.dwUserID;var o=n.getChildByName("userNick");o.text=utils.StringUtils.clipByConfig(e.szNickName,150,utils.StringUtils.getSystemConfig(24));var s=n.getChildByName("userScore");s.text=utils.StringUtils.clipByConfig(utils.StringUtils.formatNumberThousands(e.lScore),150,utils.StringUtils.getSystemConfig(24))}},i.prototype.cacheUser=function(e){for(var t=0;t<this._userList.length;t++){var n=this._userList[t];if(n.dwUserID==e.dwUserID){this._userList.splice(t,1);break}}var i=new models.UserItem(e);this._userList.push(i)},i.prototype.removeUserCache=function(e){if(0==this._userList.length)return df.INVALID_ITEM;for(var t=!1,n=df.INVALID_ITEM,i=0;i<this._userList.length;i++){var r=this._userList[i];if(r.dwUserID==e.dwUserID){this._userList.splice(i,1),t=!0,n=this._gameEngine.switchViewChairID(r.wChairID);break}}return egret.assert(t),n},i.prototype.showWaitTips=function(e,t){var n=this,i=this._companet.getChildByName("waitImg");if(null!=i)if(0!=t){i.visible=!0,0==e&&(i.source="game_ready_text_wait_png");for(var r=884,o=0,s=0;3>s;s++)if(null==this.getChildByName("dot"+s)){var a=new eui.Image("dot_"+(s+1)+"_png");a.name="dot"+s,utils.setAnchorLeftMid(a),this.addChild(a),a.visible=0==s?!0:!1,a.x=r,a.y=490}var c=egret.getTimer();managers.TimerCtrl.getInstance().createTimer(this,1e3/60,0,function(){var e=egret.getTimer();if(e-c>=500){for(var t=0;3>t;t++){var i=n.getChildByName("dot"+t);i.visible=o==t?!0:!1}o=(o+1)%3,c=egret.getTimer()}},"tipsWait")}else{i.visible=!1;for(var s=0;3>s;s++)null!=this.getChildByName("dot"+s)&&this.removeChild(this.getChildByName("dot"+s))}},i.prototype.showUserReady=function(e,t){void 0===t&&(t=!0);var n=this._gameEngine.switchViewChairID(e.wChairID),i=this._companet.getChildByName("userinfo"+n),r=i.getChildByName("ready");if(r.visible=t,t&&n==cmd.sparrowsclm.MY_VIEW){var o=this._companet.getChildByName("start");o.visible=!1;var s=this._companet.getChildByName("changeDesk");s.x=this.width/2,this.showWaitTips(0,!0)}},i.prototype.showUserOffLine=function(e){},i.prototype.showUser=function(e,n){null!=e&&this.cacheUser(e);var i=this._gameEngine.switchViewChairID(e.wChairID),r=this._companet.getChildByName("userinfo"+i);if(null!=r.getChildByName("userHead")&&r.removeChild(r.getChildByName("userHead")),i!=cmd.sparrowsclm.MY_VIEW){var o=r.getChildByName("head");o.visible=!1;var s=r.getChildByName("head_normal");s.visible=!0}var a=models.HeadSprite.createHead(e,120,120,35,35);utils.setAnchorLeftTop(a),a.name="userHead",r.addChild(a),a.x=t[i].x,a.y=t[i].y;var c=r.getChildByName("userID");c.visible=!0,c.text="ID:"+e.dwUserID;var _=r.getChildByName("userNick");_.visible=!0,_.text=utils.StringUtils.clipByConfig(e.szNickName,150,utils.StringUtils.getSystemConfig(24));var l=r.getChildByName("userScore");l.visible=!0,l.text=utils.StringUtils.clipByConfig(utils.StringUtils.formatNumberThousands(e.lScore),150,utils.StringUtils.getSystemConfig(24))},i.prototype.removeUser=function(e){var t=this.removeUserCache(e);t!=df.INVALID_ITEM&&this.onInitUser(t,!1)},i.prototype.onInitUser=function(e,t){void 0===t&&(t=!1);var n=this._companet.getChildByName("userinfo"+e);n.x=0;var i=n.getChildByName("userHead");null==i||t||n.removeChild(i);var r=n.getChildByName("ready");if(r.visible=!1,e!=cmd.sparrowsclm.MY_VIEW){var o=n.getChildByName("head");o.visible=!0;var s=n.getChildByName("head_normal");s.visible=!1;var a=n.getChildByName("userID");a.visible=t;var c=n.getChildByName("userNick");c.visible=t;var _=n.getChildByName("userScore");_.visible=t}},i.prototype.gamePlayingHeadAnim=function(e){void 0===e&&(e=!0);for(var t=[-585,115,-115],n=0;n<cmd.sparrowsclm.PLAYER_COUNT;n++){var i=this._companet.getChildByName("userinfo"+n);egret.Tween.get(i).to({x:t[n]},e?200:0)}},i.prototype.onUpdataUser=function(e,t,n){null!=e&&(e.cbUserStatus>=df.US_SIT&&e.cbUserStatus!=df.US_LOOKON&&(e.dwUserID!=managers.FrameManager.getInstance().m_GlobalUserItem.dwUserID&&this.showUser(e,!0),e.cbUserStatus==df.US_READY&&this.showUserReady(e),e.cbUserStatus==df.US_OFFLINE&&this.showUserOffLine(e)),e.cbUserStatus<=df.US_FREE&&this.removeUser(e))},i.prototype.initButton=function(){var e=this._companet.getChildByName("back");e.addEventListener(egret.TouchEvent.TOUCH_END,this.onButtonClick,this),e=this._companet.getChildByName("start"),e.addEventListener(egret.TouchEvent.TOUCH_END,this.onButtonClick,this),e=this._companet.getChildByName("changeDesk"),e.addEventListener(egret.TouchEvent.TOUCH_END,this.onButtonClick,this)},i.prototype.onButtonClick=function(e){var t=e.target;switch(t.name){case"back":this._gameEngine.onQueryExitGame();break;case"start":var n=this._gameEngine.getMeUserItem();if(n.cbUserStatus>=df.US_READY)return;this._gameEngine._gameFrame.onUserReady(),t.visible=!1;break;case"changeDesk":var i=egret.getTimer();if(i-this._changeRecord<1e3)return managers.FrameManager.getInstance().showToast("亲,你换的太频繁了!"),void(this._changeRecord=egret.getTimer());managers.FrameManager.getInstance().showPopWait(""),this._gameEngine._bChangeDesk=!0,this._gameEngine._gameFrame.onChangeDesk(),this._changeRecord=egret.getTimer(),t.visible=!1}},i.prototype.updateClockView=function(){null!=this._clockView&&this._clockView.onUpdateClockEvent()},i.prototype.logicTimeZero=function(e,t){if(e==cmd.sparrowsclm.MY_VIEW&&t==cmd.sparrowsclm.IDI_GAME_START){var n=this._gameEngine.getMeUserItem();n.cbUserStatus<df.US_READY&&this._gameEngine.onExitGame()}},i.prototype.showSceneFree=function(t){null==this._clockView&&(this._clockView=new e.ClockView(this)),this.setGameClock(cmd.sparrowsclm.TIME_GAME_START,cmd.sparrowsclm.IDI_GAME_START);
var n=t,i=new cmd.sparrowsclm.CMD_S_StatusFree(n.cbBuffer);this._wBankerUser=i.wBankerUser,this._bTrustee=!1,this._lCellScore=i.lCellScore,this._bAllowJoin=i.bAllowJoin,this._bIsRuleSetting=i.bIsRuleSetting,this._lTurnScore=i.lTurnScore,this._lCollectScore=i.lCollectScore,this.initDesk()},i.prototype.setGameClock=function(t,n,i){void 0===n&&(n=0),void 0===i&&(i=0),null==this._clockView&&(this._clockView=new e.ClockView(this)),this._clockView.setClockTime(t,n,i)},i.prototype.showGameStart=function(e){var t=this._companet.getChildByName("start");t.visible=!1;var n=this._companet.getChildByName("changeDesk");n.visible=!1,this.showWaitTips(0,!1),managers.TimerCtrl.getInstance().killTimer(this,"tipsWait");for(var i=0;i<cmd.sparrowsclm.PLAYER_COUNT;i++){var r=this._companet.getChildByName("userinfo"+i),o=r.getChildByName("ready");o.visible=!1}this.gamePlayingHeadAnim()},i.prototype.onTouchBegan=function(e){this._bMoved=!1},i.prototype.onTouchMove=function(e){this._bMoved=!0},i.prototype.onTouchEnd=function(e){},i.prototype.onExit=function(){this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegan,this),this.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.onTouchMove,this),this.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),managers.TimerCtrl.getInstance().killTimer(this,"tipsWait"),null!=this._handCard&&this._handCard.dealloc()},i}(eui.UILayer);e.GameViewLayer=n,__reflect(n.prototype,"game.sparrowsclm.GameViewLayer")}(t=e.sparrowsclm||(e.sparrowsclm={}))}(game||(game={}));var game;!function(e){var t;!function(e){var t=function(e){function t(t,n,i){var r=e.call(this)||this;return r._sice0=t,r._sice1=n,r.startAction(r._sice0,r._sice1,i),r}return __extends(t,e),t.prototype.startAction=function(e,t,n){var i=this;if(egret.assert(e>=0&&6>=e),egret.assert(t>=0&&6>=t),!(0>e||e>6||0>t||t>6)){var r=RES.getRes("sice"+e+"_json"),o=RES.getRes("sice_"+e+"_png"),s=new egret.MovieClipDataFactory(r,o),a=new egret.MovieClip(s.generateMovieClipData("SiceAnim"+e));this.addChild(a),a.x=567,a.y=250,a.gotoAndPlay(1,1),r=RES.getRes("sice"+t+"_json"),o=RES.getRes("sice_"+t+"_png"),s=new egret.MovieClipDataFactory(r,o),a=new egret.MovieClip(s.generateMovieClipData("SiceAnim"+t)),this.addChild(a),a.x=667,a.y=330,a.gotoAndPlay(1,1),egret.Tween.get(this).wait(2e3).call(function(){n&&n(),i.parent.removeChild(i)})}},t}(eui.UILayer);e.SiceView=t,__reflect(t.prototype,"game.sparrowsclm.SiceView")}(t=e.sparrowsclm||(e.sparrowsclm={}))}(game||(game={}));var exp;!function(e){function t(e){e.style.position="relative",e.style.border="0",e.style.left="0px",e.style.top="0px"}var n=function(){function e(){}return e.initDOMRoot=function(n){var i=this,r=document.getElementById("egretDOMRoot");if(null==r){var o=document.getElementsByClassName("egret-player")[0];r=document.createElement("div"),t(r),r.setAttribute("id","egretDOMRoot"),o.appendChild(r),r.style.width="400px",r.style.height="400px",e.tempStage=n;var s=function(){var e=document.getElementsByClassName("egret-player")[0],t=e.getElementsByTagName("canvas")[0],n=e.getBoundingClientRect(),o=t.getBoundingClientRect(),s=!1,a=i.tempStage.orientation;a!=egret.OrientationMode.AUTO&&(s=a!=egret.OrientationMode.PORTRAIT&&n.height>n.width||a==egret.OrientationMode.PORTRAIT&&n.width>n.height);var c,_;s?(c=o.width/t.height,_=o.height/t.width):(c=o.width/t.width,_=o.height/t.height),r.style.left=t.style.left,r.style.top=t.style.top,r.style.transformOrigin="0% 0% 0px",r.style.transform=t.style.transform};this.tempStage.addEventListener(egret.Event.RESIZE,s,this),s()}},e.getDOMRoot=function(){var e=document.getElementById("egretDOMRoot");return e},e}();__reflect(n.prototype,"DOMRoot");var i=function(){function e(){this.lastMatrix=new egret.Matrix,this.lastWidth=0,this.lastHeight=0,this.node=document.createElement("div"),t(this.node)}return e.prototype.mapDisplayObject=function(e){this.dp=e},e.prototype.show=function(){n.initDOMRoot(this.dp.stage);var e=n.getDOMRoot();e.appendChild(this.node)},e.prototype.hide=function(){this.node&&this.node.parentNode&&this.node.parentNode.removeChild(this.node)},e.prototype.bind=function(e){this.unbind(),this.element=e,this.element.style.width="100%",this.element.style.height="100%",t(this.element),this.node.appendChild(e)},e.prototype.unbind=function(){this.element&&this.element.parentNode==this.node&&this.node.removeChild(this.element),this.element=null},e.prototype.updatePosition=function(){var e=this.dp;if(null!=e.stage){for(var t=!0,n=e;n&&n!=e.stage;){if(!n.visible||0==n.alpha){t=!1;break}n=n.parent}if(t)this.element&&null==this.element.parentNode&&this.node.appendChild(this.element);else if(this.element&&this.element.parentNode)return void this.element.parentNode.removeChild(this.element);var i=e.$getConcatenatedMatrix();this.lastMatrix.a!=i.a||this.lastMatrix.b!=i.b||this.lastMatrix.c!=i.c||this.lastMatrix.d!=i.d||this.lastMatrix.tx!=i.tx||this.lastMatrix.ty!=i.ty,this.node.style.width="100 %px",this.node.style.height="100 %px"}},e}();e.DOMNode=i,__reflect(i.prototype,"exp.DOMNode")}(exp||(exp={}));var df;!function(e){function t(){var e={wModuleID:0,wMarketID:0,cbDeviceType:0,dwAppVersion:0,dwPlazaVersion:0,dwStationID:0,dwMappedNum:0,szPassword:"",szAccounts:"",szMachineID:"",szMobilePhone:""};return e}function n(){var e={wModuleID:0,wMarketID:0,cbDeviceType:0,dwAppVersion:0,dwPlazaVersion:0,dwStationID:0,szLogonPass:"",wFaceID:0,cbGender:0,szAccounts:"",szNickName:"",szMachineID:"",szMobilePhone:""};return e}function i(){var e={wFaceID:0,cbGender:0,dwCustomID:0,dwUserID:0,dwGameID:0,dwStationID:0,dwExperience:0,dwLoveLiness:0,szNickName:"",szAccounts:"",szLogonPass:"",szInsurePass:"",lUserIngot:0,lUserMedal:0,lUserScore:0,lUserInsure:0,cbMemberOrder:0,MemberOverDate:{},wLockServerID:0};return e}function r(){var e={lResultCode:0,szDescribeString:""};return e}function o(){}e.MDM_MB_LOGON=100,e.SUB_MB_LOGON_ACCOUNTS=2,e.SUB_MB_REGISTER_ACCOUNTS=3,e.SUB_MB_LOGON_OTHERPLATFORM=4,e.SUB_MB_LOGON_GAMEID_LUA=10,e.SUB_MB_LOGON_ACCOUNTS_LUA=11,e.SUB_MB_LOGON_OTHERPLATFORM_LUA=12,e.SUB_MB_REGISTER_ACCOUNTS_LUA=13,e.SUB_MB_LOGON_SUCCESS=100,e.SUB_MB_LOGON_FAILURE=101,e.SUB_MB_LOGON_FINISH=102,e.SUB_MB_UPDATE_NOTIFY=200,e.MDM_MB_SERVER_LIST=101,e.SUB_MB_GET_LIST=1,e.SUB_MB_GET_SERVER=2,e.SUB_MB_GET_OPTION=3,e.SUB_MB_GET_OPTION_LUA=4,e.SUB_MB_GET_SERVER_AGENT=5,e.SUB_MB_LIST_KIND=100,e.SUB_MB_LIST_SERVER=101,e.SUB_MB_LIST_MATCH=102,e.SUB_MB_GAME_OPTION=104,e.SUB_MB_CREATE_OPTION=103,e.SUB_MB_LIST_LOGON=105,e.SUB_MB_LIST_AGENT=106,e.SUB_MB_SERVER_AGENT=107,e.SUB_MB_LIST_ACCESS=108,e.SUB_MB_LIST_FINISH=200,e.SUB_MB_SERVER_FINISH=201,e.CMD_MB_LogonAccounts_WEB=t,e.CMD_MB_RegisterAccounts_WEB=n,e.CMD_MB_LogonSuccess=i,e.CMD_MB_LogonFailure=r,e.MDM_GP_USER_SERVICE=3,e.SUB_GP_MODIFY_ACCOUNTS=1,e.SUB_GP_MODIFY_LOGON_PASS=2,e.SUB_GP_MODIFY_INSURE_PASS=3,e.SUB_GP_MODIFY_INDIVIDUAL=4,e.SUB_MB_MODIFY_INDIVIDUAL=5,e.SUB_GP_BIND_MACHINE=6,e.SUB_GP_UN_BIND_MACHINE=7,e.SUB_GP_ACCOUNT_SECURITY=8,e.SUB_GP_MODIFY_NICKNAME=9,e.SUB_GP_QUERY_INDIVIDUAL=10,e.SUB_GP_TEST_ACCOUNTS=11,e.SUB_GP_TEST_NICKNAME=12,e.SUB_GP_QUERY_WEALTH=13,e.SUB_GP_QUERY_WEALTH_LUA=14,e.SUB_GP_BASEENSURE_QUERY=20,e.SUB_GP_BASEENSURE_TAKE=21,e.SUB_GP_GET_VALIDATECDOE=22,e.SUB_GP_OPERATE_SUCCESS=100,e.SUB_GP_OPERATE_FAILURE=101,e.SUB_GP_USER_INDIVIDUAL=200,e.SUB_GP_USER_WEALTH=201,e.SUB_GP_USER_FACE_INFO=210,e.SUB_GP_SYSTEM_FACE_INFO=211,e.SUB_GP_CUSTOM_FACE_INFO=212,e.SUB_GP_BASEENSURE_INFO=300,e.SUB_GP_BASEENSURE_RESULT=301,e.SUB_GP_BASEENSURE_FAILED=302,e.SUB_GP_VALIDATECDOE_INFO=303,e.MDM_GP_BANK_OPERATE=4,e.SUB_GP_STORAGE=1,e.SUB_GP_DRAWOUT=2,e.SUB_GP_TRANSFER=3,e.SUB_GP_QUERY=4,e.SUB_GP_UPDATE=5,e.CMD_GP_BANKOPERATE=o}(df||(df={}));var exp;!function(e){var t=function(e){function t(){var t=e.call(this)||this;return t.iframe=document.createElement("iframe"),t.bind(t.iframe),t}return __extends(t,e),Object.defineProperty(t.prototype,"src",{get:function(){return this._src},set:function(e){this._src=e,this.iframe.src=e},enumerable:!0,configurable:!0}),t}(e.WebNode);e.WebView=t,__reflect(t.prototype,"exp.WebView")}(exp||(exp={}));